"use strict";var hf=Object.create;var en=Object.defineProperty;var gf=Object.getOwnPropertyDescriptor;var yf=Object.getOwnPropertyNames;var bf=Object.getPrototypeOf,wf=Object.prototype.hasOwnProperty;var vf=(r,e,t)=>e in r?en(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var no=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),_f=(r,e)=>{for(var t in e)en(r,t,{get:e[t],enumerable:!0})},Aa=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of yf(e))!wf.call(r,s)&&s!==t&&en(r,s,{get:()=>e[s],enumerable:!(n=gf(e,s))||n.enumerable});return r};var Je=(r,e,t)=>(t=r!=null?hf(bf(r)):{},Aa(e||!r||!r.__esModule?en(t,"default",{value:r,enumerable:!0}):t,r)),Sf=r=>Aa(en({},"__esModule",{value:!0}),r);var c=(r,e,t)=>(vf(r,typeof e!="symbol"?e+"":e,t),t);var ca=no(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});function vl(r){return"source"in r&&"destination"in r?[r.source,r.destination]:[r,r]}var _l=Symbol.for("__strategy__"),Sl=Symbol.for("__mappings__"),Tl=Symbol.for("__metadata_map__"),xl=Symbol.for("__metadata_object_map__"),Nl=Symbol.for("__error_handler__"),Cl=Symbol.for("__naming_conventions__"),Al=Symbol.for("__recursive_depth__"),Pl=Symbol.for("__recursive_count__"),El=Symbol.for("__profile_configuration_context__"),Eh=Symbol.for("nodejs.util.inspect.custom");function na(r){return r[Nl]}function Ol(r){return r[Sl]}function Ki(r){return r[Tl]}function kl(r){return r[xl]}function Oh(r){let e=r[Cl];if(!!e)return vl(e)}function $l(r){return r[Al]}function kh(r){return r[Pl]}function sa(r){return r[_l]}function Ho(r){return r[El]}function $h(r,e,t,n,s,i){let o=Object.keys(e).reduce((f,u)=>{let y=u in r,h=t.some(T=>T===u),v=Object.getOwnPropertyDescriptor(e,u)?.writable===!0;return!h&&!y&&v&&r[u]===void 0&&f.push(u),f},[]),a=yl(n),l=yl(s);if(o.length){let f=`${a} -> ${l}`;i.handle(`
Unmapped properties for ${f}:
-------------------
${o.join(`,
`)}
`)}}function yl(r){let e=r.toString();return r.name&&(e=r.name),e}function Qr(r,e=[]){if(!e.length)return;let t,n=e.length;for(t=0;t<n&&r!=null;t++)r=r[e[t]];return t&&t==n?r:void 0}function Lt(r,e,t,n=!1){let s=typeof e=="string"?Symbol.for(e):e,i=typeof t=="string"?Symbol.for(t):t,o=Ol(r).get(s)?.get(i);if(o==null&&!n){let a=typeof e=="function"&&e.name||String(e),l=typeof t=="function"&&t.name||String(t),f=na(r),u=`Mapping is not found for ${a} and ${l}`;throw f.handle(u),new Error(u)}return o}function Fr(r){return Object.getPrototypeOf(r)===Date||r===Date}function ia(r){return Array.isArray(r)?!r.length:typeof r!="object"&&typeof r!="function"?!r:!Object.keys(r).length}function Zi(r,e){return r.length!==e.length?!1:r.every((t,n)=>e[n]===t)}function Wt(r){if(r==null)return!0;let e=Object.getPrototypeOf(r);return e===String||e===Number||e===Boolean||r===String||r===Number||r===Boolean}function oa(r,e,t){let{decomposedPath:n,base:s}=Il(e);return s===void 0?r:(Ml(r,s),t=n.length<=1?t:oa(r[s],n.slice(1),t),Object.assign(r,{[s]:t}))}function Tt(r,e,t){let{decomposedPath:n,base:s}=Il(e);s!==void 0&&(Ml(r,s),n.length<=1?r[s]=t:Tt(r[s],n.slice(1),t))}function Il(r){if(r.length<1)return{base:"",decomposedPath:[]};let e=r;return{base:r[0],decomposedPath:e}}function Ml(r,e){r.hasOwnProperty(e)||(r[e]={})}function Ll(r,e,t,n,s,i,o,a){let l,f=r[0],u=r[1],y=!(Wt(o)||Wt(a)||Fr(o)||Fr(a));switch(f){case 1:l=u(e);break;case 3:l=u();break;case 4:l=u(e,i,s?{extraArgs:()=>s}:void 0);break;case 5:l=u(e);break;case 2:case 7:case 8:l=u(e,n),y&&l!=null&&(l=Array.isArray(l)?i.mapArray(l,o,a):i.map(l,o,a));break;case 9:l=u(e,s||{});break;case 10:l=Ll(u(e),e,t,n,s,i,o,a);break}return l}function jl(r,e){return t=>{e&&(e=oa(e,r,t))}}function Yo(r,e,t,n=!1){return Ui({mapping:r,sourceObject:e,options:t,setMemberFn:jl,isMapArray:n})}function Dl(r){return e=>t=>{t!==void 0&&Tt(r,e,t)}}function Rl(r){return e=>Qr(r,e)}function bl(r,e,t,n,s=!1){Ui({sourceObject:e,mapping:r,setMemberFn:Dl(t),getMemberFn:Rl(t),options:n,isMapArray:s})}function Ui({mapping:r,sourceObject:e,options:t,setMemberFn:n,getMemberFn:s,isMapArray:i=!1}){let[[o,a],[,l],f,,u,y,,[h,v]=[]]=r,{beforeMap:T,afterMap:w,destinationConstructor:j=y,extraArgs:N}=t??{},q=na(u),z=Ki(u),I=j(e,a),D=N?.(r,I),Y=[];if(!i){let k=T??h;k&&k(e,I,D)}for(let k=0,F=f.length;k<F;k++){let[Z,[,[S,[G,U=void 0]=[]]],[W,ie]=[]]=f[k],pe=!Wt(W)&&!Fr(W)&&!Wt(ie)&&!Fr(ie)&&ie===W;pe&&(pe=!Lt(u,ie,W,!0));let he=ze=>{try{return n(Z,I)(ze())}catch(_){let $=`
Error at "${Z}" on ${a.prototype?.constructor?.name||a.toString()} (${JSON.stringify(I)})
---------------------------------------------------------------------
Original error: ${_}`;throw q.handle($),new Error($)}};if(Y.push(Z[0]),G&&!G(e)){he(()=>U);continue}if(S[0]===6){let ze=z.get(a),_=ze&&ze.find(re=>Zi(re[0],Z))===null,$=S[1](e),se=S[2];if($==null||$ instanceof Date||Object.prototype.toString.call($).slice(8,-1)==="File"||_||pe||se){he(()=>$);continue}if(Array.isArray($)){let[re]=$;if(typeof re!="object"||re instanceof Date||Object.prototype.toString.call(re).slice(8,-1)==="File"){he(()=>$.slice());continue}if(ia(re)){he(()=>[]);continue}if(Wt(W))continue;he(()=>$.map(ge=>Yo(Lt(u,ie,W),ge,{extraArgs:N})));continue}if(typeof $=="object"){let re=Lt(u,ie,W);if(s){let ge=s(Z);ge!==void 0&&Ui({sourceObject:$,mapping:re,options:{extraArgs:N},setMemberFn:Dl(ge),getMemberFn:Rl(ge)});continue}he(()=>Ui({mapping:re,sourceObject:$,options:{extraArgs:N},setMemberFn:jl}));continue}he(()=>$);continue}he(()=>Ll(S,e,I,Z,D,u,ie,W))}if(!i){let k=w??v;k&&k(e,I,D)}return $h(I,l,Y,o,a,q),I}var jt=class{static configure(e={}){this.configured||(this.configured=!0,Object.entries(e).forEach(([t,n])=>{n!==void 0&&(this[t]=n)}))}static log(e){console.log.bind(console,this.AUTOMAPPER_PREFIX,e)}static warn(e){console.warn.bind(console,this.AUTOMAPPER_PREFIX,e)}static error(e){console.error.bind(console,this.AUTOMAPPER_PREFIX,e)}static info(e){console.info.bind(console,this.AUTOMAPPER_PREFIX,e)}};jt.AUTOMAPPER_PREFIX="[AutoMapper]: ";jt.configured=!1;function Ih({strategyInitializer:r,errorHandler:e,namingConventions:t}){let n,s,i,o,a,l,f;function u(y,h,v){if(h&&v)return{destinationIdentifier:h,mapOptions:v};let T=y;if(h&&!v){let w=typeof h;w==="string"||w==="function"?T=h:v=h}return{destinationIdentifier:T,mapOptions:v}}return new Proxy({[Eh](){return`
Mapper {} is an empty Object as a Proxy. The following methods are available to use with a Mapper:
- Mapper#map(Array)(Async), Mapper#mutate(Array)(Async)
- createMap()
- addProfile()
- getMapping()
- getMappings()
        `}},{get(y,h,v){return h===_l?(n||(n=r(v)),n):h===El?(f||(f=new Set),f):h===Sl?(s||(s=new Map),s):h===Tl?(i||(i=new Map),i):h===xl?(o||(o=new Map),o):h===Nl?(e||(e={handle:jt.error?jt.error.bind(jt):()=>{}}),e):h===Cl?t:h===Al?(a||(a=new Map),a):h===Pl?(l||(l=new Map),l):h==="dispose"?()=>{s?.clear(),o?.clear(),a?.clear(),l?.clear(),f?.clear()}:h==="map"?(T,w,j,N)=>{if(T==null)return T;let{destinationIdentifier:q,mapOptions:z}=u(w,j,N),I=Lt(v,w,q);T=n.preMap(T,I);let D=Yo(I,T,z||{});return n.postMap(T,D,I)}:h==="mapAsync"?(T,w,j,N)=>{let q=v.map(T,w,j,N);return new Promise(z=>{setTimeout(z,0,q)})}:h==="mapArray"?(T,w,j,N)=>{if(!T.length)return[];let{destinationIdentifier:q,mapOptions:z}=u(w,j,N),I=Lt(v,w,q),{beforeMap:D,afterMap:Y,extraArgs:k}=z||{};D&&D(T,[]);let F=[];for(let Z=0,S=T.length;Z<S;Z++){let G=T[Z];G=n.preMap(G,I);let U=Yo(I,G,{extraArgs:k},!0);F.push(n.postMap(G,U,I))}return Y&&Y(T,F),F}:h==="mapArrayAsync"?(T,w,j,N)=>{let q=v.mapArray(T,w,j,N);return new Promise(z=>{setTimeout(z,0,q)})}:h==="mutate"?(T,w,j,N,q)=>{if(T==null)return;let{destinationIdentifier:z,mapOptions:I}=u(j,N,q),D=Lt(v,j,z);T=n.preMap(T,D),bl(D,T,w,I||{}),n.postMap(T,w,D)}:h==="mutateAsync"?(T,w,j,N,q)=>new Promise(z=>{v.mutate(T,w,j,N,q),setTimeout(z,0)}):h==="mutateArray"?(T,w,j,N,q)=>{if(!T.length)return;let{destinationIdentifier:z,mapOptions:I}=u(j,N,q),D=Lt(v,j,z),{beforeMap:Y,afterMap:k,extraArgs:F}=I||{};Y&&Y(T,w);for(let Z=0,S=T.length;Z<S;Z++){let G=T[Z];G=n.preMap(G,D),bl(D,G,w[Z]||{},{extraArgs:F},!0),n.postMap(G,w[Z],D)}k&&k(T,w)}:h==="mutateArrayAsync"?(T,w,j,N,q)=>new Promise(z=>{v.mutateArray(T,w,j,N,q),setTimeout(z,0)}):Reflect.get(y,h,v)}})}var aa=Symbol("__recursive_data__");function Xo(r,e,t){let n=r.get(e);return n?Lh(n,t):void 0}function Vi(r,e,t,n){if(!r.has(e)){r.set(e,wl(new Map,t,n));return}let s=r.get(e);Mh(s,t)||wl(s,t,n)}function wl(r,e,t){let n=r;for(let s of e){let i=n.get(s);i||(i=new Map,n.set(s,i)),n=i}return n.set(aa,t),r}function Mh(r,e){let t=r;for(let n of e){let s=t.get(n);if(s)t=s;else return!1}return t.has(aa)}function Lh(r,e){let t=r;for(let n of e)if(t=t.get(n),!t)return;return t.get(aa)}function jh(r){let e=r.mapper,t=Ki(e),n=kl(e),s=kh(e),i=$l(e);function o(a,l,f=!0,u=!1){let y=t.get(a),h={};if(ia(y)||!y)return h;for(let v=0,T=y.length;v<T;v++){let w=y[v][0],j=y[v][1],N=y[v][2];if(y[v][3]&&l===1)continue;let z=j();if(N){Tt(h,w,[]);continue}if(Wt(z)||z===null){Tt(h,w,void 0);continue}if(Fr(z)){Tt(h,w,new Date);continue}let I=Xo(i,a,w),D=Xo(s,a,w)||0;if(I===0){Tt(h,w,{});continue}if(I===D){(f||!u)&&Vi(s,a,w,0),Tt(h,w,{});continue}Vi(s,a,w,D+1);let k=n.get(z)?.[l]||o(z,l,!1,z===a);Tt(h,w,k)}return(f||!u)&&s.get(a)?.clear(),h}return o}var Dh={applyMetadata:jh,preMap(r){return r},postMap(r,e){return e}};function Rh(r,e=!1){return e?r!==void 0:r!=null}function zl(r,e,t){if(!Rh(t))return;let n=Ki(r);if(!n.has(e))for(let[s,{isGetterOnly:i,type:o,depth:a,isArray:l}]of t)n.set(e,[...n.get(e)||[],[[s],o,l,i]]),a!=null&&Vi($l(r),e,[s],a)}function zh(r){return[6,e=>Qr(e,r)]}function Fl(r,[e,t]){let n=r.map(s=>s.split(t.splittingExpression).filter(Boolean)).filter(s=>s.length>0);return n.length?n.map(s=>e.transformPropertyName(s)):r}function Ql(r,e,t){let[n]=t,s=[].concat(...e.map(h=>h.split(n.splittingExpression).filter(Boolean))),[i,...o]=s.slice(0,s.length-1),a=i,l=0,f=Bi(r,a);if(!f){for(let h=0,v=o.length;h<v;h++)if(a=n.transformPropertyName([a,o[h]]),Bi(r,a)){l=h+1,f=!0;break}}if(!f)return e;let u=s.slice(l+1,s.length+1),y=n.transformPropertyName(u);return u.length>1&&!Bi(r[a],y)&&Bi(r[a],n.transformPropertyName([u[0]]))?[a,...Ql(r[a],Fl([y],t),t)]:[a,n.transformPropertyName(s.slice(l+1,s.length+1))]}function Bi(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function ql(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function Fh(r){let e=[];for(let t=0,n=r.length;t<n;t++){let s=r[t];e.some(i=>ql(i,s))||e.push(s)}return e}var Qh=["constructor","__defineGetter__","__defineSetter__","hasOwnProperty","__lookupGetter__","__lookupSetter__","isPrototypeOf","propertyIsEnumerable","toString","valueOf","__proto__","toLocaleString"];function Bl(r,e=[],t=[]){let n=t,s=!1,i=Array.from(new Set([...Object.getOwnPropertyNames(r)].filter(o=>!Qh.includes(o))));for(let o=0,a=i.length;o<a;o++){let l=i[o],f=[...e,l],u=r[l];if(typeof u!="function"&&(n.push(f),typeof u=="object")){let y=Array.isArray(u)?u:[u];for(let h of y){let v=Bl(h,f);v&&(s=!0,n.push(...v))}}}return s?Fh(n):n}function Ul(r,e,t,n=[]){let s=sa(r),i=s.applyMetadata.bind(s),o=s.destinationConstructor.bind(s),a=kl(r),l=a.get(e),f=a.get(t),u=f?.[1]||i(t,1);f?f[1]=u:a.set(t,[void 0,u]);let y=l?.[0]||i(e,0);l?l[0]=y:a.set(e,[y]);let h=[[e,t],[y,u],[],[],r,o];h[8]=Oh(r);for(let D=0,Y=n.length;D<Y;D++)n[D](h);let v=Bl(u),T=h[2],w=h[3],j=w.length>0,N=h[8],{processSourcePath:q,getMetadataAtMember:z,getNestedMappingPair:I}=Vl(r,e,t);for(let D=0,Y=v.length;D<Y;D++){let k=v[D];if(j&&w.some(W=>Zi(W[0],k)))continue;let F=q(y,N,k);if(!(F[0]in y))continue;let Z=z(k,"destination"),S=z(F,"source");if(!S&&!Z)continue;let G=I(S,Z),U=[zh(F)];if(G){let W,ie=S[2],pe=Z[2],he=h[6];if(he){let[ze,_]=he.get(G[1])||[],[$,se]=(ie?_?.get(G[0]):ze?.get(G[0]))||[];W=pe?se:$}if(W){let ze=U[0][1];U[0][1]=_=>W(ze(_)),U[0][2]=!0}}T.push([k,[k,U],G])}for(let D of w)T.push(D);return h}function Vl(r,e,t){let n=Ki(r),s=n.get(t)||[],i=n.get(e)||[];return{getMetadataAtMember:(o,a)=>(a==="source"?i:s).find(l=>Zi(l[0],o)),processSourcePath:(o,a,l)=>{let f=l;return a&&(f=Ql(o,Fl(l,a),a)),f},getNestedMappingPair:(o,a)=>{if(o&&a)return[a[1](),o[1]()]}}}function qh(r,e,...t){let n=typeof e=="string"?Symbol.for(e):e,s=n,[i,...o]=t||[];i&&(typeof i=="string"?s=Symbol.for(i):typeof i=="function"&&i.prototype!==void 0?s=i:(o||[]).push(i));let a=Ol(r),l=a.get(n)?.get(s);return l?(na(r).handle(`Mapping for source ${String(e)} and destination ${String(i)} already exists`),l):(sa(r).retrieveMetadata(n,s).forEach((y,h)=>{zl(r,h,y)}),l=Ul(r,n,s,(o||[]).concat(...Ho(r).values()).filter(y=>y!=null)),a.has(n)?a.get(n).set(s,l):a.set(n,new Map([[s,l]])),l)}function Bh(r,e,...t){t.forEach(n=>{Ho(r).add(n)}),e.apply({profileName:e.name},[r]),Ho(r).clear()}var Kl=()=>{},Uh=Zl(Kl);function Vh(r){let e=r(Uh);if(typeof e!="function")return null;let t=e();return t.length===0||t.some(n=>typeof n!="string")?null:t}function Kh(r){let e=Vh(r);return e||[]}function Zl(r,e=[]){let t={get(n,s){let i=e.slice();return i.push(s),Zl(Kl,i)},apply(){return e}};return new Proxy(r,t)}function Gl(r,...e){let[t,n]=e,s=Kh(r);n==null&&(n=t,t=void 0);let i=[s,[n,t]];return o=>{let[a,l]=o[0],f=o[4],u=o[8],[y]=o[1],{getNestedMappingPair:h,getMetadataAtMember:v,processSourcePath:T}=Vl(f,a,l),w=T(y,u,s);if(!(w[0]in y)){o[3].push([s,i,void 0]);return}let j=v(s,"destination"),N=v(w,"source"),q=h(N,j);o[3].push([s,i,q])}}function Zh(r,e){let t=Array.isArray(r)?r:void 0;return n=>{if(t==null){let[,i]=n[0],o=n[4],a=sa(o),l=typeof r=="string"?Symbol.for(r):r;a.retrieveMetadata(l).forEach((u,y)=>{zl(o,y,u)}),t=Ul(o,l,i)}let s=t[2];for(let i=0,o=s.length;i<o;i++){let a=s[i];if(n[2].some(f=>Zi(f[0],a[0])))continue;let l=a[1][1];l[0][1]=f=>Qr(e(f),a[0]),n[2].push([a[0],[a[0],l],a[2]])}}}function Gh(r){return"convert"in r?r.convert.bind(r):r}function Wh(r,e,t){return n=>{let s=Array.isArray(r),i=Array.isArray(e),o=s?r[0]:r,a=i?e[0]:e,l=Gh(t),f=n[6]||(n[6]=new Map),u,[y,h]=f.get(o)||[];if(y||h){u=s?h:y;let[v,T]=u.get(a)||[];u.set(a,i?[v,l]:[l,T]);return}u=new Map([[a,i?[void 0,l]:[l,void 0]]]),f.set(o,s?[new Map,u]:[u,new Map])}}var Jh=r=>e=>{e[5]=r};function Hh(r){return e=>{e[7]==null&&(e[7]=[]),e[7][0]=r}}function Yh(r){return e=>{e[7]==null&&(e[7]=[]),e[7][1]=r}}function Xh(r,e){return t=>{let n;if(Array.isArray(r))n=r;else{let i=t[4];n=Lt(i,r,e)}let s=n[2];for(let i=0,o=s.length;i<o;i++){let[a,l,f]=s[i];t[3].find(([y])=>ql(y,a))||t[3].push([a,l,f])}}}var eg=r=>e=>{e[8]=vl(r)};function Wl(r){return"resolve"in r}function Jl(r){return Wl(r)?[1,r.resolve.bind(r)]:[1,r]}function tg(r){return Gl(e=>e[r],Jl(e=>e[r]))}function rg(r,e,t){return[4,(n,s,i)=>{let o=t(n);return Array.isArray(o)?s.mapArray(o,e,r,i):s.map(o,e,r,i)}]}function ng(r,e){return[5,t=>r.convert(e(t))]}function sg(){return[0]}function ig(r){return[7,(e,t)=>{let n=Qr(e,t);return n===null?r:n}]}function og(r,e){return[r,e]}function ag(r,e){return[2,(t,n)=>r(t)?Qr(t,n):e]}function cg(r){return[3,()=>r]}function lg(r){return Wl(r)?[9,r.resolve.bind(r)]:[9,r]}function ug(r){return[10,r]}function fg(r){return[8,(e,t)=>{let n=Qr(e,t);return n===void 0?r:n}]}var ea=class{constructor(){this.separatorCharacter="",this.splittingExpression=/(^[a-z]+(?=$|[A-Z][a-z0-9]+)|[A-Z]?[a-z0-9]+)/}transformPropertyName(e){let t="";for(let n=0,s=e.length;n<s;n++)n===0?t+=e[n].charAt(0).toLowerCase():t+=e[n].charAt(0).toUpperCase(),t+=e[n].substring(1);return t}},ta=class{constructor(){this.separatorCharacter="",this.splittingExpression=/(^[A-Z]+(?=$|[A-Z][a-z0-9]+)|[A-Z]?[a-z0-9]+)/}transformPropertyName(e){let t="";for(let n=0,s=e.length;n<s;n++)t+=e[n].charAt(0).toUpperCase()+e[n].substring(1);return t}},ra=class{constructor(){this.separatorCharacter="_",this.splittingExpression=/_/}transformPropertyName(e){return e.length<=1?e[0].toLowerCase()||"":e.map(n=>n.toLowerCase()).join(this.separatorCharacter)}};ee.AutoMapperLogger=jt;ee.CamelCaseNamingConvention=ea;ee.PascalCaseNamingConvention=ta;ee.SnakeCaseNamingConvention=ra;ee.addProfile=Bh;ee.afterMap=Yh;ee.autoMap=tg;ee.beforeMap=Hh;ee.condition=ag;ee.constructUsing=Jh;ee.convertUsing=ng;ee.createMap=qh;ee.createMapper=Ih;ee.defaultStrategyInitializerOptions=Dh;ee.extend=Xh;ee.forMember=Gl;ee.forSelf=Zh;ee.fromValue=cg;ee.getRecursiveValue=Xo;ee.ignore=sg;ee.isDateConstructor=Fr;ee.isEmpty=ia;ee.isPrimitiveConstructor=Wt;ee.mapDefer=ug;ee.mapFrom=Jl;ee.mapWith=rg;ee.mapWithArguments=lg;ee.namingConventions=eg;ee.nullSubstitution=ig;ee.preCondition=og;ee.set=oa;ee.setMutate=Tt;ee.setRecursiveValue=Vi;ee.typeConverter=Wh;ee.undefinedSubstitution=fg});var Hl=no(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});var dg=ca(),Ln=class{static reset(){this.metadataStorage=new Map}static create(e,t={}){let n=typeof e=="string"?Symbol.for(e):e,s=Object.entries(t);if(!!s.length)for(let i=0,o=s.length;i<o;i++){let[a,l]=s[i],f=this.normalizePojoMetadata(l);this.metadataStorage.has(n)||this.metadataStorage.set(n,[]),this.metadataStorage.get(n)?.push([a,f])}}static retrieve(e){let t=this.metadataStorage.get(e);return t?t.map(([n,{type:s,depth:i}])=>{let o=s(),a=Array.isArray(o);return[n,{type:a?()=>o[0]:()=>o,isArray:a,depth:i}]}):[]}static normalizePojoMetadata(e){if(typeof e=="string"||typeof e=="symbol"||typeof e=="function"||Array.isArray(e))return{type:()=>this.toSymbol(e),depth:1};let t=e;return t.type=this.toSymbol(t.type),{type:()=>t.type,depth:t.depth}}static toSymbol(e){return typeof e=="string"?Symbol.for(e):Array.isArray(e)&&typeof e[0]=="string"?Symbol.for(e[0]):e}};Ln.metadataStorage=new Map;function mg(r={}){let{destinationConstructor:e=()=>({}),applyMetadata:t,postMap:n,preMap:s}={...dg.defaultStrategyInitializerOptions,...r};return i=>({destinationConstructor:e,mapper:i,get applyMetadata(){return t(this)},retrieveMetadata(...o){let a=new Map;for(let l=0,f=o.length;l<f;l++){let u=o[l];a.set(u,Ln.retrieve(u))}return a},preMap:s,postMap:n})}Gi.PojosMetadataMap=Ln;Gi.pojos=mg});var Xi=no((Dx,pu)=>{"use strict";var ha=Object.defineProperty,xy=Object.getOwnPropertyDescriptor,Ny=Object.getOwnPropertyNames,Cy=Object.prototype.hasOwnProperty,Ay=(r,e)=>{for(var t in e)ha(r,t,{get:e[t],enumerable:!0})},Py=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Ny(e))!Cy.call(r,s)&&s!==t&&ha(r,s,{get:()=>e[s],enumerable:!(n=xy(e,s))||n.enumerable});return r},Ey=r=>Py(ha({},"__esModule",{value:!0}),r),mu={};Ay(mu,{BadRequestError:()=>ky});pu.exports=Ey(mu);var Oy=class extends Error{constructor(r){super(r),Object.setPrototypeOf(this,new.target.prototype)}},ky=class extends Oy{constructor(e,t={}){super(e);c(this,"statusCode",400);c(this,"logging",!1);c(this,"errors");this.errors=[{message:e,context:t}]}}});var Ly={};_f(Ly,{lambdaHandler:()=>My});module.exports=Sf(Ly);var Ka=Je(require("os"),1),Za=Je(require("fs"),1);var qn=new Map,so=new Map,io=Symbol("OriginError"),mr={},Ve=class extends Promise{constructor(e,t,n,s,i={}){let o,a;super((l,f)=>{o=l,a=f}),this.tagged=Array.isArray(e.raw),this.strings=e,this.args=t,this.handler=n,this.canceller=s,this.options=i,this.state=null,this.statement=null,this.resolve=l=>(this.active=!1,o(l)),this.reject=l=>(this.active=!1,a(l)),this.active=!1,this.cancelled=null,this.executed=!1,this.signature="",this[io]=this.handler.debug?new Error:this.tagged&&Tf(this.strings)}get origin(){return(this.handler.debug?this[io].stack:this.tagged&&so.has(this.strings)?so.get(this.strings):so.set(this.strings,this[io].stack).get(this.strings))||""}static get[Symbol.species](){return Promise}cancel(){return this.canceller&&(this.canceller(this),this.canceller=null)}simple(){return this.options.simple=!0,this.options.prepare=!1,this}async readable(){return this.simple(),this.streaming=!0,this}async writable(){return this.simple(),this.streaming=!0,this}cursor(e=1,t){if(this.options.simple=!1,typeof e=="function"&&(t=e,e=1),this.cursorRows=e,typeof t=="function")return this.cursorFn=t,this;let n;return{[Symbol.asyncIterator]:()=>({next:()=>{if(this.executed&&!this.active)return{done:!0};n&&n();let s=new Promise((i,o)=>{this.cursorFn=a=>(i({value:a,done:!1}),new Promise(l=>n=l)),this.resolve=()=>(this.active=!1,i({done:!0})),this.reject=a=>(this.active=!1,o(a))});return this.execute(),s},return(){return n&&n(mr),{done:!0}}})}}describe(){return this.options.simple=!1,this.onlyDescribe=this.options.prepare=!0,this}stream(){throw new Error(".stream has been renamed to .forEach")}forEach(e){return this.forEachFn=e,this.handle(),this}raw(){return this.isRaw=!0,this}values(){return this.isRaw="values",this}async handle(){!this.executed&&(this.executed=!0)&&await 1&&this.handler(this)}execute(){return this.handle(),this}then(){return this.handle(),super.then.apply(this,arguments)}catch(){return this.handle(),super.catch.apply(this,arguments)}finally(){return this.handle(),super.finally.apply(this,arguments)}};function Tf(r){if(qn.has(r))return qn.get(r);let e=Error.stackTraceLimit;return Error.stackTraceLimit=4,qn.set(r,new Error),Error.stackTraceLimit=e,qn.get(r)}var Ft=class extends Error{constructor(e){super(e.message),this.name=this.constructor.name,Object.assign(this,e)}},Ce={connection:Pa,postgres:Ea,generic:Oa,notSupported:ka};function Pa(r,e,t){let{host:n,port:s}=t||e,i=Object.assign(new Error("write "+r+" "+(e.path||n+":"+s)),{code:r,errno:r,address:e.path||n},e.path?{}:{port:s});return Error.captureStackTrace(i,Pa),i}function Ea(r){let e=new Ft(r);return Error.captureStackTrace(e,Ea),e}function Oa(r,e){let t=Object.assign(new Error(r+": "+e),{code:r});return Error.captureStackTrace(t,Oa),t}function ka(r){let e=Object.assign(new Error(r+" (B) is not supported"),{code:"MESSAGE_NOT_SUPPORTED",name:r});return Error.captureStackTrace(e,ka),e}var xf={string:{to:25,from:null,serialize:r=>""+r},number:{to:0,from:[21,23,26,700,701],serialize:r=>""+r,parse:r=>+r},json:{to:114,from:[114,3802],serialize:r=>JSON.stringify(r),parse:r=>JSON.parse(r)},boolean:{to:16,from:16,serialize:r=>r===!0?"t":"f",parse:r=>r==="t"},date:{to:1184,from:[1082,1114,1184],serialize:r=>(r instanceof Date?r:new Date(r)).toISOString(),parse:r=>new Date(r)},bytea:{to:17,from:17,serialize:r=>"\\x"+Buffer.from(r).toString("hex"),parse:r=>Buffer.from(r.slice(2),"hex")}},tn=class{then(){oo()}catch(){oo()}finally(){oo()}},pr=class extends tn{constructor(e){super(),this.value=Kn(e)}},st=class extends tn{constructor(e,t,n){super(),this.value=e,this.type=t,this.array=n}},rn=class extends tn{constructor(e,t){super(),this.first=e,this.rest=t}build(e,t,n,s){let i=Nf.map(([o,a])=>({fn:a,i:e.search(o)})).sort((o,a)=>o.i-a.i).pop();return i.i===-1?fo(this.first,s):i.fn(this.first,this.rest,t,n,s)}};function Vn(r,e,t,n){let s=r instanceof st?r.value:r;if(s===void 0&&(r instanceof st?r.value=n.transform.undefined:s=r=n.transform.undefined,s===void 0))throw Ce.generic("UNDEFINED_VALUE","Undefined values are not allowed");return"$"+t.push(r instanceof st?(e.push(r.value),r.array?r.array[r.type||Un(r.value)]||r.type||La(r.value):r.type):(e.push(r),Un(r)))}var Ia=Da(xf);function lo(r,e,t,n,s,i){for(let o=1;o<r.strings.length;o++)e+=uo(e,t,n,s,i)+r.strings[o],t=r.args[o];return e}function uo(r,e,t,n,s){return e instanceof rn?e.build(r,t,n,s):e instanceof Ve?co(e,t,n,s):e instanceof pr?e.value:e&&e[0]instanceof Ve?e.reduce((i,o)=>i+" "+co(o,t,n,s),""):Vn(e,t,n,s)}function co(r,e,t,n){return r.fragment=!0,lo(r,r.strings[0],r.args[0],e,t,n)}function Ma(r,e,t,n,s){return r.map(i=>"("+n.map(o=>uo("values",i[o],e,t,s)).join(",")+")").join(",")}function $a(r,e,t,n,s){let i=Array.isArray(r[0]),o=e.length?e.flat():Object.keys(i?r[0]:r);return Ma(i?r:[r],t,n,o,s)}function Bn(r,e,t,n,s){if(typeof r=="string"&&(r=[r].concat(e)),Array.isArray(r))return fo(r,s);let i;return(e.length?e.flat():Object.keys(r)).map(a=>(i=r[a],(i instanceof Ve?co(i,t,n,s):i instanceof pr?i.value:Vn(i,t,n,s))+" as "+Kn(s.transform.column.to?s.transform.column.to(a):a))).join(",")}var Nf=Object.entries({values:$a,in:(...r)=>{let e=$a(...r);return e==="()"?"(null)":e},select:Bn,as:Bn,returning:Bn,"\\(":Bn,update(r,e,t,n,s){return(e.length?e.flat():Object.keys(r)).map(i=>Kn(s.transform.column.to?s.transform.column.to(i):i)+"="+uo("values",r[i],t,n,s))},insert(r,e,t,n,s){let i=e.length?e.flat():Object.keys(Array.isArray(r)?r[0]:r);return"("+fo(i,s)+")values"+Ma(Array.isArray(r)?r:[r],t,n,i,s)}}).map(([r,e])=>[new RegExp("((?:^|[\\s(])"+r+"(?:$|[\\s(]))(?![\\s\\S]*\\1)","i"),e]);function oo(){throw Ce.generic("NOT_TAGGED_CALL","Query not called as a tagged template literal")}var Cf=Ia.serializers,Af=Ia.parsers;function La(r){return Array.isArray(r)?La(r[0]):typeof r=="string"?1009:0}var ja=function(r){let e=Da(r||{});return{serializers:Object.assign({},Cf,e.serializers),parsers:Object.assign({},Af,e.parsers)}};function Da(r){return Object.keys(r).reduce((e,t)=>(r[t].from&&[].concat(r[t].from).forEach(n=>e.parsers[n]=r[t].parse),r[t].serialize&&(e.serializers[r[t].to]=r[t].serialize,r[t].from&&[].concat(r[t].from).forEach(n=>e.serializers[n]=r[t].serialize)),e),{parsers:{},serializers:{}})}function fo(r,{transform:{column:e}}){return r.map(t=>Kn(e.to?e.to(t):t)).join(",")}var Kn=function(e){return'"'+e.replace(/"/g,'""').replace(/\./g,'"."')+'"'},Un=function r(e){return e instanceof st?e.type:e instanceof Date?1184:e instanceof Uint8Array?17:e===!0||e===!1?16:typeof e=="bigint"?20:Array.isArray(e)?r(e[0]):0},Pf=/\\/g,Ef=/"/g;function Of(r){return r.replace(Pf,"\\\\").replace(Ef,'\\"')}var Ra=function r(e,t,n,s){if(Array.isArray(e)===!1)return e;if(!e.length)return"{}";let i=e[0],o=s===1020?";":",";return Array.isArray(i)&&!i.type?"{"+e.map(a=>r(a,t,n,s)).join(o)+"}":"{"+e.map(a=>{if(a===void 0&&(a=n.transform.undefined,a===void 0))throw Ce.generic("UNDEFINED_VALUE","Undefined values are not allowed");return a===null?"null":'"'+Of(t?t(a.type?a.value:a):""+a)+'"'}).join(o)+"}"},ao={i:0,char:null,str:"",quoted:!1,last:0},za=function(e,t,n){return ao.i=ao.last=0,Fa(ao,e,t,n)};function Fa(r,e,t,n){let s=[],i=n===1020?";":",";for(;r.i<e.length;r.i++){if(r.char=e[r.i],r.quoted)r.char==="\\"?r.str+=e[++r.i]:r.char==='"'?(s.push(t?t(r.str):r.str),r.str="",r.quoted=e[r.i+1]==='"',r.last=r.i+2):r.str+=r.char;else if(r.char==='"')r.quoted=!0;else if(r.char==="{")r.last=++r.i,s.push(Fa(r,e,t,n));else if(r.char==="}"){r.quoted=!1,r.last<r.i&&s.push(t?t(e.slice(r.last,r.i)):e.slice(r.last,r.i)),r.last=r.i+1;break}else r.char===i&&r.p!=="}"&&r.p!=='"'&&(s.push(t?t(e.slice(r.last,r.i)):e.slice(r.last,r.i)),r.last=r.i+1);r.p=r.char}return r.last<r.i&&s.push(t?t(e.slice(r.last,r.i+1)):e.slice(r.last,r.i+1)),s}var Qt=r=>{let e=r[0];for(let t=1;t<r.length;t++)e+=r[t]==="_"?r[++t].toUpperCase():r[t];return e},qt=r=>{let e=r[0].toUpperCase();for(let t=1;t<r.length;t++)e+=r[t]==="_"?r[++t].toUpperCase():r[t];return e},Bt=r=>r.replace(/_/g,"-"),nn=r=>r.replace(/([A-Z])/g,"_$1").toLowerCase(),sn=r=>(r.slice(0,1)+r.slice(1).replace(/([A-Z])/g,"_$1")).toLowerCase(),on=r=>r.replace(/-/g,"_");function mo(r){return function e(t,n){return typeof t=="object"&&t!==null&&(n.type===114||n.type===3802)?Array.isArray(t)?t.map(s=>e(s,n)):Object.entries(t).reduce((s,[i,o])=>Object.assign(s,{[r(i)]:e(o,n)}),{}):t}}Qt.column={from:Qt};Qt.value={from:mo(Qt)};nn.column={to:nn};var po={...Qt};po.column.to=nn;qt.column={from:qt};qt.value={from:mo(qt)};sn.column={to:sn};var ho={...qt};ho.column.to=sn;Bt.column={from:Bt};Bt.value={from:mo(Bt)};on.column={to:on};var go={...Bt};go.column.to=on;var wo=Je(require("net"),1),Ba=Je(require("tls"),1),gr=Je(require("crypto"),1),Wn=Je(require("stream"),1),vo=require("perf_hooks");var $t=class extends Array{constructor(){super(),Object.defineProperties(this,{count:{value:null,writable:!0},state:{value:null,writable:!0},command:{value:null,writable:!0},columns:{value:null,writable:!0},statement:{value:null,writable:!0}})}static get[Symbol.species](){return Array}};var Ke=kf;function kf(r=[]){let e=r.slice(),t=0;return{get length(){return e.length-t},remove:n=>{let s=e.indexOf(n);return s===-1?null:(e.splice(s,1),n)},push:n=>(e.push(n),n),shift:()=>{let n=e[t++];return t===e.length?(t=0,e=[]):e[t-1]=void 0,n}}}var De=Buffer.allocUnsafe(256),$f="BCcDdEFfHPpQSX".split("").reduce((r,e)=>{let t=e.charCodeAt(0);return r[e]=()=>(De[0]=t,le.i=5,le),r},{}),le=Object.assign(If,$f,{N:String.fromCharCode(0),i:0,inc(r){return le.i+=r,le},str(r){let e=Buffer.byteLength(r);return Zn(e),le.i+=De.write(r,le.i,e,"utf8"),le},i16(r){return Zn(2),De.writeUInt16BE(r,le.i),le.i+=2,le},i32(r,e){return e||e===0?(De.writeUInt32BE(r,e),le):(Zn(4),De.writeUInt32BE(r,le.i),le.i+=4,le)},z(r){return Zn(r),De.fill(0,le.i,le.i+r),le.i+=r,le},raw(r){return De=Buffer.concat([De.subarray(0,le.i),r]),le.i=De.length,le},end(r=1){De.writeUInt32BE(le.i-r,r);let e=De.subarray(0,le.i);return le.i=0,De=Buffer.allocUnsafe(256),e}}),Q=le;function Zn(r){if(De.length-le.i<r){let e=De,t=e.length;De=Buffer.allocUnsafe(t+(t>>1)+r),e.copy(De)}}function If(){return le.i=0,le}var _o=Ua,Mf=1,It=Q().S().end(),Qa=Q().H().end(),Lf=Q().i32(8).i32(80877103).end(8),jf=Buffer.concat([Q().E().str(Q.N).i32(0).end(),It]),Df=Q().D().str("S").str(Q.N).end(),hr=()=>{},Rf=new Set(["FetchPreparedStatement","RevalidateCachedQuery","transformAssignedExpr"]),zf={83:"severity_local",86:"severity",67:"code",77:"message",68:"detail",72:"hint",80:"position",112:"internal_position",113:"internal_query",87:"where",115:"schema_name",116:"table_name",99:"column_name",100:"data type_name",110:"constraint_name",70:"file",76:"line",82:"routine"};function Ua(r,e={},{onopen:t=hr,onend:n=hr,onclose:s=hr}={}){let{ssl:i,max:o,user:a,host:l,port:f,database:u,parsers:y,transform:h,onnotice:v,onnotify:T,onparameter:w,max_pipeline:j,keep_alive:N,backoff:q,target_session_attrs:z}=r,I=Ke(),D=Mf++,Y={pid:null,secret:null},k=bo(to,r.idle_timeout),F=bo(to,r.max_lifetime),Z=bo(Au,r.connect_timeout),S=null,G,U=new $t,W=Buffer.alloc(0),ie=r.fetch_types,pe={},he={},ze=Math.random().toString(36).slice(2),_=1,$=0,se=0,re=0,ge=0,X=0,fe=0,Ne=0,ve=null,ye=null,Ie=!1,de=null,rt=null,Me=null,Ot=null,Pe=null,be=null,nt=null,lt=null,A=null,Hr=null,Le={queue:e.closed,idleTimer:k,connect(m){Me=m||!0,Sa()},terminate:Xr,execute:Yr,cancel:Tu,end:to,count:0,id:D};return e.closed&&e.closed.push(Le),Le;async function Su(){let m;try{m=r.socket?await Promise.resolve(r.socket(r)):new wo.default.Socket}catch(g){dr(g);return}return m.on("error",dr),m.on("close",Ta),m.on("drain",va),m}async function Tu({pid:m,secret:g},B,oe){try{G=Q().i32(16).i32(80877102).i32(m).i32(g).end(16),await _a(),S.once("error",oe),S.once("close",B)}catch(_e){oe(_e)}}function Yr(m){if(Ie)return Qn(m,Ce.connection("CONNECTION_DESTROYED",r));if(!m.cancelled)try{return m.state=Y,A?I.push(m):(A=m,A.active=!0),Cu(m),Oe(xu(m))&&!m.describeFirst&&!m.cursorFn&&I.length<j&&(!m.options.onexecute||m.options.onexecute(Le))}catch(g){return I.length===0&&Oe(It),ut(g),!0}}function xu(m){if(m.parameters.length>=65534)throw Ce.generic("MAX_PARAMETERS_EXCEEDED","Max number of parameters (65534) exceeded");return m.options.simple?Q().Q().str(m.statement.string+Q.N).end():m.describeFirst?Buffer.concat([ya(m),Qa]):m.prepare?m.prepared?Fn(m):Buffer.concat([ya(m),Fn(m)]):Nu(m)}function ya(m){return Buffer.concat([Na(m.statement.string,m.parameters,m.statement.types,m.statement.name),df("S",m.statement.name)])}function Fn(m){return Buffer.concat([ff(m.parameters,m.statement.types,m.statement.name,m.cursorName),m.cursorFn?Ca("",m.cursorRows):jf])}function Nu(m){return Buffer.concat([Na(m.statement.string,m.parameters,m.statement.types),Df,Fn(m)])}function Cu(m){let g=[],B=[],oe=lo(m,m.strings[0],m.args[0],g,B,r);!m.tagged&&m.args.forEach(_e=>Vn(_e,g,B,r)),m.prepare=r.prepare&&("prepare"in m.options?m.options.prepare:!0),m.string=oe,m.signature=m.prepare&&B+oe,m.onlyDescribe&&delete he[m.signature],m.parameters=m.parameters||g,m.prepared=m.prepare&&m.signature in he,m.describeFirst=m.onlyDescribe||g.length&&!m.prepared,m.statement=m.prepared?he[m.signature]:{string:oe,types:B,name:m.prepare?ze+_++:""},typeof r.debug=="function"&&r.debug(D,oe,g,B)}function Oe(m,g){return be=be?Buffer.concat([be,m]):Buffer.from(m),g||be.length>=1024?ba(g):(ye===null&&(ye=setImmediate(ba)),!0)}function ba(m){let g=S.write(be,m);return ye!==null&&clearImmediate(ye),be=ye=null,g}function Au(){ut(Ce.connection("CONNECT_TIMEOUT",r,S)),S.destroy()}async function wa(){if(Oe(Lf),!await new Promise(g=>S.once("data",B=>g(B[0]===83)))&&i==="prefer")return fr();S.removeAllListeners(),S=Ba.default.connect({socket:S,servername:wo.default.isIP(S.host)?void 0:S.host,...i==="require"||i==="allow"||i==="prefer"?{rejectUnauthorized:!1}:i==="verify-full"?{}:typeof i=="object"?i:{}}),S.on("secureConnect",fr),S.on("error",dr),S.on("close",Ta),S.on("drain",va)}function va(){!A&&t(Le)}function eo(m){if(!(de&&(de.push(m),se-=m.length,se>=0)))for(W=de?Buffer.concat(de,X-se):W.length===0?m:Buffer.concat([W,m],W.length+m.length);W.length>4;){if(X=W.readUInt32BE(1),X>=W.length){se=X-W.length,de=[W];break}try{Pu(W.subarray(0,X+1))}catch(g){A&&(A.cursorFn||A.describeFirst)&&Oe(It),ut(g)}W=W.subarray(X+1),se=0,de=null}}async function _a(){if(Ie=!1,pe={},S||(S=await Su()),!!S){if(Z.start(),r.socket)return i?wa():fr();if(S.on("connect",i?wa:fr),r.path)return S.connect(r.path);S.ssl=i,S.connect(f[re],l[re]),S.host=l[re],S.port=f[re],re=(re+1)%f.length}}function Sa(){setTimeout(_a,$?$+fe-vo.performance.now():0)}function fr(){try{he={},ie=r.fetch_types,ze=Math.random().toString(36).slice(2),_=1,F.start(),S.on("data",eo),N&&S.setKeepAlive&&S.setKeepAlive(!0,1e3*N);let m=pf();Oe(m)}catch(m){dr(m)}}function dr(m){if(!(Le.queue===e.connecting&&r.host[ge+1]))for(ut(m);I.length;)Qn(I.shift(),m)}function ut(m){Pe&&(Pe.destroy(m),Pe=null),A&&Qn(A,m),Me&&(Qn(Me,m),Me=null)}function Qn(m,g){"query"in g||"parameters"in g||Object.defineProperties(g,{stack:{value:g.stack+m.origin.replace(/.*\n/,`
`),enumerable:r.debug},query:{value:m.string,enumerable:r.debug},parameters:{value:m.parameters,enumerable:r.debug},args:{value:m.args,enumerable:r.debug},types:{value:m.statement&&m.statement.types,enumerable:r.debug}}),m.reject(g)}function to(){return Ot||(!Le.reserved&&n(Le),!Le.reserved&&!Me&&!A&&I.length===0?(Xr(),new Promise(m=>S&&S.readyState!=="closed"?S.once("close",m):m())):Ot=new Promise(m=>nt=m))}function Xr(){Ie=!0,(Pe||A||Me||I.length)&&dr(Ce.connection("CONNECTION_DESTROYED",r)),clearImmediate(ye),S&&(S.removeListener("data",eo),S.removeListener("connect",fr),S.readyState==="open"&&S.end(Q().X().end())),nt&&(nt(),Ot=nt=null)}async function Ta(m){if(W=Buffer.alloc(0),se=0,de=null,clearImmediate(ye),S.removeListener("data",eo),S.removeListener("connect",fr),k.cancel(),F.cancel(),Z.cancel(),S.removeAllListeners(),S=null,Me)return Sa();!m&&(A||I.length)&&dr(Ce.connection("CONNECTION_CLOSED",r,S)),$=vo.performance.now(),m&&r.shared.retries++,fe=(typeof q=="function"?q(r.shared.retries):q)*1e3,s(Le,Ce.connection("CONNECTION_CLOSED",r,S))}function Pu(m,g=m[0]){(g===68?Eu:g===100?rf:g===65?Ju:g===83?Ou:g===90?ku:g===67?$u:g===50?xa:g===49?Iu:g===116?Mu:g===84?Lu:g===82?ju:g===110?qu:g===75?Bu:g===69?Gu:g===115?Hu:g===51?Yu:g===71?Xu:g===78?sf:g===72?ef:g===99?nf:g===73?of:g===86?af:g===118?cf:g===87?tf:lf)(m)}function Eu(m){let g=7,B,oe,_e,je=A.isRaw?new Array(A.statement.columns.length):{};for(let Fe=0;Fe<A.statement.columns.length;Fe++)oe=A.statement.columns[Fe],B=m.readInt32BE(g),g+=4,_e=B===-1?null:A.isRaw===!0?m.subarray(g,g+=B):oe.parser===void 0?m.toString("utf8",g,g+=B):oe.parser.array===!0?oe.parser(m.toString("utf8",g+1,g+=B)):oe.parser(m.toString("utf8",g,g+=B)),A.isRaw?je[Fe]=A.isRaw===!0?_e:h.value.from?h.value.from(_e,oe):_e:je[oe.name]=h.value.from?h.value.from(_e,oe):_e;A.forEachFn?A.forEachFn(h.row.from?h.row.from(je):je,U):U[Ne++]=h.row.from?h.row.from(je):je}function Ou(m){let[g,B]=m.toString("utf8",5,m.length-1).split(Q.N);pe[g]=B,r.parameters[g]!==B&&(r.parameters[g]=B,w&&w(g,B))}function ku(m){if(A&&A.options.simple&&A.resolve(rt||U),A=rt=null,U=new $t,Z.cancel(),Me){if(z){if(!pe.in_hot_standby||!pe.default_transaction_read_only)return Zu();if(Ku(z,pe))return Xr()}if(ie)return Me===!0&&(Me=null),Uu();Me!==!0&&Yr(Me),r.shared.retries=ge=0,Me=null;return}for(;I.length&&(A=I.shift())&&(A.active=!0,A.cancelled);)Ua(r).cancel(A.state,A.cancelled.resolve,A.cancelled.reject);A||(Le.reserved?!Le.reserved.release&&m[5]===73?Ot?Xr():(Le.reserved=null,t(Le)):Le.reserved():Ot?Xr():t(Le))}function $u(m){Ne=0;for(let g=m.length-1;g>0;g--)if(m[g]===32&&m[g+1]<58&&U.count===null&&(U.count=+m.toString("utf8",g+1,m.length-1)),m[g-1]>=65){U.command=m.toString("utf8",5,g),U.state=Y;break}if(Hr&&(Hr(),Hr=null),U.command==="BEGIN"&&o!==1&&!Le.reserved)return ut(Ce.generic("UNSAFE_TRANSACTION","Only use sql.begin, sql.reserved or max: 1"));if(A.options.simple)return xa();A.cursorFn&&(U.count&&A.cursorFn(U),Oe(It)),A.resolve(U)}function Iu(){A.parsing=!1}function xa(){!U.statement&&(U.statement=A.statement),U.columns=A.statement.columns}function Mu(m){let g=m.readUInt16BE(5);for(let B=0;B<g;++B)!A.statement.types[B]&&(A.statement.types[B]=m.readUInt32BE(7+B*4));A.prepare&&(he[A.signature]=A.statement),A.describeFirst&&!A.onlyDescribe&&(Oe(Fn(A)),A.describeFirst=!1)}function Lu(m){U.command&&(rt=rt||[U],rt.push(U=new $t),U.count=null,A.statement.columns=null);let g=m.readUInt16BE(5),B=7,oe;A.statement.columns=Array(g);for(let _e=0;_e<g;++_e){for(oe=B;m[B++]!==0;);let je=m.readUInt32BE(B),Fe=m.readUInt16BE(B+4),kt=m.readUInt32BE(B+6);A.statement.columns[_e]={name:h.column.from?h.column.from(m.toString("utf8",oe,B-1)):m.toString("utf8",oe,B-1),parser:y[kt],table:je,number:Fe,type:kt},B+=18}if(U.statement=A.statement,A.onlyDescribe)return A.resolve(A.statement),Oe(It)}async function ju(m,g=m.readUInt32BE(5)){(g===3?Du:g===5?Ru:g===10?zu:g===11?Fu:g===12?Qu:g!==0?uf:hr)(m,g)}async function Du(){let m=await ro();Oe(Q().p().str(m).z(1).end())}async function Ru(m){let g="md5"+await qa(Buffer.concat([Buffer.from(await qa(await ro()+a)),m.subarray(9)]));Oe(Q().p().str(g).z(1).end())}async function zu(){lt=(await gr.default.randomBytes(18)).toString("base64"),Q().p().str("SCRAM-SHA-256"+Q.N);let m=Q.i;Oe(Q.inc(4).str("n,,n=*,r="+lt).i32(Q.i-m-4,m).end())}async function Fu(m){let g=m.toString("utf8",9).split(",").reduce((Fe,kt)=>(Fe[kt[0]]=kt.slice(2),Fe),{}),B=await gr.default.pbkdf2Sync(await ro(),Buffer.from(g.s,"base64"),parseInt(g.i),32,"sha256"),oe=await Gn(B,"Client Key"),_e="n=*,r="+lt+",r="+g.r+",s="+g.s+",i="+g.i+",c=biws,r="+g.r;ve=(await Gn(await Gn(B,"Server Key"),_e)).toString("base64");let je="c=biws,r="+g.r+",p="+Qf(oe,Buffer.from(await Gn(await Ff(oe),_e))).toString("base64");Oe(Q().p().str(je).end())}function Qu(m){m.toString("utf8",9).split(Q.N,1)[0].slice(2)!==ve&&(ut(Ce.generic("SASL_SIGNATURE_MISMATCH","The server did not return the correct signature")),S.destroy())}function ro(){return Promise.resolve(typeof r.pass=="function"?r.pass():r.pass)}function qu(){if(U.statement=A.statement,U.statement.columns=[],A.onlyDescribe)return A.resolve(A.statement),Oe(It)}function Bu(m){Y.pid=m.readUInt32BE(5),Y.secret=m.readUInt32BE(9)}async function Uu(){ie=!1,(await new Ve([`
      select b.oid, b.typarray
      from pg_catalog.pg_type a
      left join pg_catalog.pg_type b on b.oid = a.typelem
      where a.typcategory = 'A'
      group by b.oid, b.typarray
      order by b.oid
    `],[],Yr)).forEach(({oid:g,typarray:B})=>Vu(g,B))}function Vu(m,g){if(!!r.parsers[g]&&!!r.serializers[g])return;let B=r.parsers[m];r.shared.typeArrayMap[m]=g,r.parsers[g]=oe=>za(oe,B,g),r.parsers[g].array=!0,r.serializers[g]=oe=>Ra(oe,r.serializers[m],r,g)}function Ku(m,g){return m==="read-write"&&g.default_transaction_read_only==="on"||m==="read-only"&&g.default_transaction_read_only==="off"||m==="primary"&&g.in_hot_standby==="on"||m==="standby"&&g.in_hot_standby==="off"||m==="prefer-standby"&&g.in_hot_standby==="off"&&r.host[ge]}function Zu(){let m=new Ve([`
      show transaction_read_only;
      select pg_catalog.pg_is_in_recovery()
    `],[],Yr,null,{simple:!0});m.resolve=([[g],[B]])=>{pe.default_transaction_read_only=g.transaction_read_only,pe.in_hot_standby=B.pg_is_in_recovery?"on":"off"},m.execute()}function Gu(m){A&&(A.cursorFn||A.describeFirst)&&Oe(It);let g=Ce.postgres(yo(m));A&&A.retried?ut(A.retried):A&&A.prepared&&Rf.has(g.routine)?Wu(A,g):ut(g)}function Wu(m,g){delete he[m.signature],m.retried=g,Yr(m)}function Ju(m){if(!T)return;let g=9;for(;m[g++]!==0;);T(m.toString("utf8",9,g-1),m.toString("utf8",g,m.length-1))}async function Hu(){try{let m=await Promise.resolve(A.cursorFn(U));Ne=0,m===mr?Oe(mf(A.portal)):(U=new $t,Oe(Ca("",A.cursorRows)))}catch(m){Oe(It),A.reject(m)}}function Yu(){U.count&&A.cursorFn(U),A.resolve(U)}function Xu(){Pe=new Wn.default.Writable({autoDestroy:!0,write(m,g,B){S.write(Q().d().raw(m).end(),B)},destroy(m,g){g(m),S.write(Q().f().str(m+Q.N).end()),Pe=null},final(m){S.write(Q().c().end()),Hr=m}}),A.resolve(Pe)}function ef(){Pe=new Wn.default.Readable({read(){S.resume()}}),A.resolve(Pe)}function tf(){Pe=new Wn.default.Duplex({autoDestroy:!0,read(){S.resume()},write(m,g,B){S.write(Q().d().raw(m).end(),B)},destroy(m,g){g(m),S.write(Q().f().str(m+Q.N).end()),Pe=null},final(m){S.write(Q().c().end()),Hr=m}}),A.resolve(Pe)}function rf(m){Pe&&(Pe.push(m.subarray(5))||S.pause())}function nf(){Pe&&Pe.push(null),Pe=null}function sf(m){v?v(yo(m)):console.log(yo(m))}function of(){}function af(){ut(Ce.notSupported("FunctionCallResponse"))}function cf(){ut(Ce.notSupported("NegotiateProtocolVersion"))}function lf(m){console.error("Postgres.js : Unknown Message:",m[0])}function uf(m,g){console.error("Postgres.js : Unknown Auth:",g)}function ff(m,g,B="",oe=""){let _e,je;return Q().B().str(oe+Q.N).str(B+Q.N).i16(0).i16(m.length),m.forEach((Fe,kt)=>{if(Fe===null)return Q.i32(4294967295);je=g[kt],m[kt]=Fe=je in r.serializers?r.serializers[je](Fe):""+Fe,_e=Q.i,Q.inc(4).str(Fe).i32(Q.i-_e-4,_e)}),Q.i16(0),Q.end()}function Na(m,g,B,oe=""){return Q().P().str(oe+Q.N).str(m+Q.N).i16(g.length),g.forEach((_e,je)=>Q.i32(B[je]||0)),Q.end()}function df(m,g=""){return Q().D().str(m).str(g+Q.N).end()}function Ca(m="",g=0){return Buffer.concat([Q().E().str(m+Q.N).i32(g).end(),Qa])}function mf(m=""){return Buffer.concat([Q().C().str("P").str(m+Q.N).end(),Q().S().end()])}function pf(){return G||Q().inc(4).i16(3).z(2).str(Object.entries(Object.assign({user:a,database:u,client_encoding:"UTF8"},r.connection)).filter(([,m])=>m).map(([m,g])=>m+Q.N+g).join(Q.N)).z(2).end(0)}}function yo(r){let e={},t=5;for(let n=5;n<r.length-1;n++)r[n]===0&&(e[zf[r[t]]]=r.toString("utf8",t+1,n),t=n+1);return e}function qa(r){return gr.default.createHash("md5").update(r).digest("hex")}function Gn(r,e){return gr.default.createHmac("sha256",r).update(e).digest()}function Ff(r){return gr.default.createHash("sha256").update(r).digest()}function Qf(r,e){let t=Math.max(r.length,e.length),n=Buffer.allocUnsafe(t);for(let s=0;s<t;s++)n[s]=r[s]^e[s];return n}function bo(r,e){if(e=typeof e=="function"?e():e,!e)return{cancel:hr,start:hr};let t;return{cancel(){t&&(clearTimeout(t),t=null)},start(){t&&clearTimeout(t),t=setTimeout(n,e*1e3,arguments)}};function n(s){r.apply(null,s),t=null}}var Va=()=>{};function So(r,e){let t=new Map,n="postgresjs_"+Math.random().toString(36).slice(2),s={},i,o,a=!1,l=y.sql=r({...e,transform:{column:{},value:{},row:{}},max:1,fetch_types:!1,idle_timeout:null,max_lifetime:null,connection:{...e.connection,replication:"database"},onclose:async function(){a||(o=null,s.pid=s.secret=void 0,h(await v(l,n,e.publications)),t.forEach(w=>w.forEach(({onsubscribe:j})=>j())))},no_subscribe:!0}),f=l.end,u=l.close;return l.end=async()=>(a=!0,o&&await new Promise(w=>(o.once("close",w),o.end())),f()),l.close=async()=>(o&&await new Promise(w=>(o.once("close",w),o.end())),u()),y;async function y(w,j,N=Va,q=Va){w=Uf(w),i||(i=v(l,n,e.publications));let z={fn:j,onsubscribe:N},I=t.has(w)?t.get(w).add(z):t.set(w,new Set([z])).get(w),D=()=>{I.delete(z),I.size===0&&t.delete(w)};return i.then(Y=>(h(Y),N(),o&&o.on("error",q),{unsubscribe:D,state:s,sql:l}))}function h(w){o=w.stream,s.pid=w.state.pid,s.secret=w.state.secret}async function v(w,j,N){if(!N)throw new Error("Missing publication names");let q=await w.unsafe(`CREATE_REPLICATION_SLOT ${j} TEMPORARY LOGICAL pgoutput NOEXPORT_SNAPSHOT`),[z]=q,I=await w.unsafe(`START_REPLICATION SLOT ${j} LOGICAL ${z.consistent_point} (proto_version '1', publication_names '${N}')`).writable(),D={lsn:Buffer.concat(z.consistent_point.split("/").map(S=>Buffer.from(("00000000"+S).slice(-8),"hex")))};return I.on("data",k),I.on("error",Y),I.on("close",w.close),{stream:I,state:q.state};function Y(S){console.error("Unexpected error during logical streaming - reconnecting",S)}function k(S){S[0]===119?Bf(S.subarray(25),D,w.options.parsers,F,e.transform):S[0]===107&&S[17]&&(D.lsn=S.subarray(1,9),Z())}function F(S,G){let U=G.relation.schema+"."+G.relation.table;T("*",S,G),T("*:"+U,S,G),G.relation.keys.length&&T("*:"+U+"="+G.relation.keys.map(W=>S[W.name]),S,G),T(G.command,S,G),T(G.command+":"+U,S,G),G.relation.keys.length&&T(G.command+":"+U+"="+G.relation.keys.map(W=>S[W.name]),S,G)}function Z(){let S=Buffer.alloc(34);S[0]="r".charCodeAt(0),S.fill(D.lsn,1),S.writeBigInt64BE(BigInt(Date.now()-Date.UTC(2e3,0,1))*BigInt(1e3),25),I.write(S)}}function T(w,j,N){t.has(w)&&t.get(w).forEach(({fn:q})=>q(j,N,w))}}function qf(r){return new Date(Date.UTC(2e3,0,1)+Number(r/BigInt(1e3)))}function Bf(r,e,t,n,s){let i=(o,[a,l])=>(o[a.charCodeAt(0)]=l,o);Object.entries({R:o=>{let a=1,l=e[o.readUInt32BE(a)]={schema:o.toString("utf8",a+=4,a=o.indexOf(0,a))||"pg_catalog",table:o.toString("utf8",a+1,a=o.indexOf(0,a+1)),columns:Array(o.readUInt16BE(a+=2)),keys:[]};a+=2;let f=0,u;for(;a<o.length;)u=l.columns[f++]={key:o[a++],name:s.column.from?s.column.from(o.toString("utf8",a,a=o.indexOf(0,a))):o.toString("utf8",a,a=o.indexOf(0,a)),type:o.readUInt32BE(a+=1),parser:t[o.readUInt32BE(a)],atttypmod:o.readUInt32BE(a+=4)},u.key&&l.keys.push(u),a+=4},Y:()=>{},O:()=>{},B:o=>{e.date=qf(o.readBigInt64BE(9)),e.lsn=o.subarray(1,9)},I:o=>{let a=1,l=e[o.readUInt32BE(a)],{row:f}=Jn(o,l.columns,a+=7,s);n(f,{command:"insert",relation:l})},D:o=>{let a=1,l=e[o.readUInt32BE(a)];a+=4;let f=o[a]===75;n(f||o[a]===79?Jn(o,l.columns,a+=3,s).row:null,{command:"delete",relation:l,key:f})},U:o=>{let a=1,l=e[o.readUInt32BE(a)];a+=4;let f=o[a]===75,u=f||o[a]===79?Jn(o,l.columns,a+=3,s):null;u&&(a=u.i);let{row:y}=Jn(o,l.columns,a+3,s);n(y,{command:"update",relation:l,key:f,old:u&&u.row})},T:()=>{},C:()=>{}}).reduce(i,{})[r[0]](r)}function Jn(r,e,t,n){let s,i,o,a=n.raw?new Array(e.length):{};for(let l=0;l<e.length;l++)s=r[t++],i=e[l],o=s===110?null:s===117?void 0:i.parser===void 0?r.toString("utf8",t+4,t+=4+r.readUInt32BE(t)):i.parser.array===!0?i.parser(r.toString("utf8",t+5,t+=4+r.readUInt32BE(t))):i.parser(r.toString("utf8",t+4,t+=4+r.readUInt32BE(t))),n.raw?a[l]=n.raw===!0?o:n.value.from?n.value.from(o,i):o:a[i.name]=n.value.from?n.value.from(o,i):o;return{i:t,row:n.row.from?n.row.from(a):a}}function Uf(r){let e=r.match(/^(\*|insert|update|delete)?:?([^.]+?\.?[^=]+)?=?(.+)?/i)||[];if(!e)throw new Error("Malformed subscribe pattern: "+r);let[,t,n,s]=e;return(t||"*")+(n?":"+(n.indexOf(".")===-1?"public."+n:n):"")+(s?"="+s:"")}var To=Je(require("stream"),1);function xo(r,e,t=393216){return new Promise(async(n,s)=>{await r.begin(async i=>{let o;!e&&([{oid:e}]=await i`select lo_creat(-1) as oid`);let[{fd:a}]=await i`select lo_open(${e}, ${t}) as fd`,l={writable:u,readable:f,close:()=>i`select lo_close(${a})`.then(o),tell:()=>i`select lo_tell64(${a})`,read:y=>i`select loread(${a}, ${y}) as data`,write:y=>i`select lowrite(${a}, ${y})`,truncate:y=>i`select lo_truncate64(${a}, ${y})`,seek:(y,h=0)=>i`select lo_lseek64(${a}, ${y}, ${h})`,size:()=>i`
          select
            lo_lseek64(${a}, location, 0) as position,
            seek.size
          from (
            select
              lo_lseek64($1, 0, 2) as size,
              tell.location
            from (select lo_tell64($1) as location) tell
          ) seek
        `};return n(l),new Promise(async y=>o=y);async function f({highWaterMark:y=2048*8,start:h=0,end:v=1/0}={}){let T=v-h;return h&&await l.seek(h),new To.default.Readable({highWaterMark:y,async read(w){let j=w>T?w-T:w;T-=w;let[{data:N}]=await l.read(j);this.push(N),N.length<w&&this.push(null)}})}async function u({highWaterMark:y=2048*8,start:h=0}={}){return h&&await l.seek(h),new To.default.Writable({highWaterMark:y,write(v,T,w){l.write(v).then(()=>w(),w)}})}}).catch(s)})}Object.assign(Hn,{PostgresError:Ft,toPascal:qt,pascal:ho,toCamel:Qt,camel:po,toKebab:Bt,kebab:go,fromPascal:sn,fromCamel:nn,fromKebab:on,BigInt:{to:20,from:[20],parse:r=>BigInt(r),serialize:r=>r.toString()}});var yr=Hn;function Hn(r,e){let t=Vf(r,e),n=t.no_subscribe||So(Hn,{...t}),s=!1,i=Ke(),o=Ke(),a=Ke(),l=Ke(),f=Ke(),u=Ke(),y=Ke(),h=Ke(),v={connecting:o,reserved:a,closed:l,ended:f,open:u,busy:y,full:h},T=[...Array(t.max)].map(()=>_o(t,v,{onopen:he,onend:pe,onclose:ze})),w=j(F);return Object.assign(w,{get parameters(){return t.parameters},largeObject:xo.bind(null,w),subscribe:n,CLOSE:mr,END:mr,PostgresError:Ft,options:t,reserve:z,listen:N,begin:I,close:U,end:G}),w;function j(_){return _.debug=t.debug,Object.entries(t.types).reduce((X,[fe,Ne])=>(X[fe]=ve=>new st(ve,Ne.to),X),$),Object.assign(se,{types:$,typed:$,unsafe:re,notify:q,array:k,json:Y,file:ge}),se;function $(X,fe){return new st(X,fe)}function se(X,...fe){return X&&Array.isArray(X.raw)?new Ve(X,fe,_,S):typeof X=="string"&&!fe.length?new pr(t.transform.column.to?t.transform.column.to(X):X):new rn(X,fe)}function re(X,fe=[],Ne={}){return arguments.length===2&&!Array.isArray(fe)&&(Ne=fe,fe=[]),new Ve([X],fe,_,S,{prepare:!1,...Ne,simple:"simple"in Ne?Ne.simple:fe.length===0})}function ge(X,fe=[],Ne={}){return arguments.length===2&&!Array.isArray(fe)&&(Ne=fe,fe=[]),new Ve([],fe,ye=>{Za.default.readFile(X,"utf8",(Ie,de)=>{if(Ie)return ye.reject(Ie);ye.strings=[de],_(ye)})},S,{...Ne,simple:"simple"in Ne?Ne.simple:fe.length===0})}}async function N(_,$,se){let re={fn:$,onlisten:se},ge=N.sql||(N.sql=Hn({...t,max:1,idle_timeout:null,max_lifetime:null,fetch_types:!1,onclose(){Object.entries(N.channels).forEach(([ye,{listeners:Ie}])=>{delete N.channels[ye],Promise.all(Ie.map(de=>N(ye,de.fn,de.onlisten).catch(()=>{})))})},onnotify(ye,Ie){ye in N.channels&&N.channels[ye].listeners.forEach(de=>de.fn(Ie))}})),X=N.channels||(N.channels={});if(_ in X){X[_].listeners.push(re);let ye=await X[_].result;return re.onlisten&&re.onlisten(),{state:ye.state,unlisten:ve}}X[_]={result:ge`listen ${ge.unsafe('"'+_.replace(/"/g,'""')+'"')}`,listeners:[re]};let Ne=await X[_].result;return re.onlisten&&re.onlisten(),{state:Ne.state,unlisten:ve};async function ve(){if(_ in X&&(X[_].listeners=X[_].listeners.filter(ye=>ye!==re),!X[_].listeners.length))return delete X[_],ge`unlisten ${ge.unsafe('"'+_.replace(/"/g,'""')+'"')}`}}async function q(_,$){return await w`select pg_notify(${_}, ${""+$})`}async function z(){let _=Ke(),$=u.length?u.shift():await new Promise(ge=>{i.push({reserve:ge}),l.length&&ie(l.shift())});D($,a),$.reserved=()=>_.length?$.execute(_.shift()):D($,a),$.reserved.release=!0;let se=j(re);return se.release=()=>{$.reserved=null,he($)},se;function re(ge){$.queue===h?_.push(ge):$.execute(ge)||D($,h)}}async function I(_,$){!$&&($=_,_="");let se=Ke(),re=0,ge,X=null;try{return await w.unsafe("begin "+_.replace(/[^a-z ]/ig,""),[],{onexecute:Ne}).execute(),await Promise.race([fe(ge,$),new Promise((ve,ye)=>ge.onclose=ye)])}catch(ve){throw ve}async function fe(ve,ye,Ie){let de=j(Pe);de.savepoint=Ot,de.prepare=be=>X=be.replace(/[^a-z0-9$-_. ]/gi);let rt,Me;Ie&&await de`savepoint ${de(Ie)}`;try{if(Me=await new Promise((be,nt)=>{let lt=ye(de);Promise.resolve(Array.isArray(lt)?Promise.all(lt):lt).then(be,nt)}),rt)throw rt}catch(be){throw await(Ie?de`rollback to ${de(Ie)}`:de`rollback`),be instanceof Ft&&be.code==="25P02"&&rt||be}return Ie||(X?await de`prepare transaction '${de.unsafe(X)}'`:await de`commit`),Me;function Ot(be,nt){return be&&Array.isArray(be.raw)?Ot(lt=>lt.apply(lt,arguments)):(arguments.length===1&&(nt=be,be=null),fe(ve,nt,"s"+re+++(be?"_"+be:"")))}function Pe(be){be.catch(nt=>rt||(rt=nt)),ve.queue===h?se.push(be):ve.execute(be)||D(ve,h)}}function Ne(ve){ge=ve,D(ve,a),ve.reserved=()=>se.length?ve.execute(se.shift()):D(ve,a)}}function D(_,$){return _.queue.remove(_),$.push(_),_.queue=$,$===u?_.idleTimer.start():_.idleTimer.cancel(),_}function Y(_){return new st(_,3802)}function k(_,$){return Array.isArray(_)?new st(_,$||(_.length?Un(_)||25:0),t.shared.typeArrayMap):k(Array.from(arguments))}function F(_){if(s)return _.reject(Ce.connection("CONNECTION_ENDED",t,t));if(u.length)return Z(u.shift(),_);if(l.length)return ie(l.shift(),_);y.length?Z(y.shift(),_):i.push(_)}function Z(_,$){return _.execute($)?D(_,y):D(_,h)}function S(_){return new Promise(($,se)=>{_.state?_.active?_o(t).cancel(_.state,$,se):_.cancelled={resolve:$,reject:se}:(i.remove(_),_.cancelled=!0,_.reject(Ce.generic("57014","canceling statement due to user request")),$())})}async function G({timeout:_=null}={}){if(s)return s;await 1;let $;return s=Promise.race([new Promise(se=>_!==null&&($=setTimeout(W,_*1e3,se))),Promise.all(T.map(se=>se.end()).concat(N.sql?N.sql.end({timeout:0}):[],n.sql?n.sql.end({timeout:0}):[]))]).then(()=>clearTimeout($))}async function U(){await Promise.all(T.map(_=>_.end()))}async function W(_){for(await Promise.all(T.map($=>$.terminate()));i.length;)i.shift().reject(Ce.connection("CONNECTION_DESTROYED",t));_()}function ie(_,$){return D(_,o),_.connect($),_}function pe(_){D(_,f)}function he(_){if(i.length===0)return D(_,u);let $=Math.ceil(i.length/(o.length+1)),se=!0;for(;se&&i.length&&$-- >0;){let re=i.shift();if(re.reserve)return re.reserve(_);se=_.execute(re)}se?D(_,y):D(_,h)}function ze(_,$){D(_,l),_.reserved=null,_.onclose&&(_.onclose($),_.onclose=null),t.onclose&&t.onclose(_.id),i.length&&ie(_,i.shift())}}function Vf(r,e){if(r&&r.shared)return r;let t=process.env,n=(!r||typeof r=="string"?e:r)||{},{url:s,multihost:i}=Jf(r),o=[...s.searchParams].reduce((h,[v,T])=>(h[v]=T,h),{}),a=n.hostname||n.host||i||s.hostname||t.PGHOST||"localhost",l=n.port||s.port||t.PGPORT||5432,f=n.user||n.username||s.username||t.PGUSERNAME||t.PGUSER||Hf();n.no_prepare&&(n.prepare=!1),o.sslmode&&(o.ssl=o.sslmode,delete o.sslmode),"timeout"in n&&(console.log("The timeout option is deprecated, use idle_timeout instead"),n.idle_timeout=n.timeout),o.sslrootcert==="system"&&(o.ssl="verify-full");let u=["idle_timeout","connect_timeout","max_lifetime","max_pipeline","backoff","keep_alive"],y={max:10,ssl:!1,idle_timeout:null,connect_timeout:30,max_lifetime:Gf,max_pipeline:100,backoff:Zf,keep_alive:60,prepare:!0,debug:!1,fetch_types:!0,publications:"alltables",target_session_attrs:null};return{host:Array.isArray(a)?a:a.split(",").map(h=>h.split(":")[0]),port:Array.isArray(l)?l:a.split(",").map(h=>parseInt(h.split(":")[1]||l)),path:n.path||a.indexOf("/")>-1&&a+"/.s.PGSQL."+l,database:n.database||n.db||(s.pathname||"").slice(1)||t.PGDATABASE||f,user:f,pass:n.pass||n.password||s.password||t.PGPASSWORD||"",...Object.entries(y).reduce((h,[v,T])=>{let w=v in n?n[v]:v in o?o[v]==="disable"||o[v]==="false"?!1:o[v]:t["PG"+v.toUpperCase()]||T;return h[v]=typeof w=="string"&&u.includes(v)?+w:w,h},{}),connection:{application_name:"postgres.js",...n.connection,...Object.entries(o).reduce((h,[v,T])=>(v in y||(h[v]=T),h),{})},types:n.types||{},target_session_attrs:Kf(n,s,t),onnotice:n.onnotice,onnotify:n.onnotify,onclose:n.onclose,onparameter:n.onparameter,socket:n.socket,transform:Wf(n.transform||{undefined:void 0}),parameters:{},shared:{retries:0,typeArrayMap:{}},...ja(n.types)}}function Kf(r,e,t){let n=r.target_session_attrs||e.searchParams.get("target_session_attrs")||t.PGTARGETSESSIONATTRS;if(!n||["read-write","read-only","primary","standby","prefer-standby"].includes(n))return n;throw new Error("target_session_attrs "+n+" is not supported")}function Zf(r){return(.5+Math.random()/2)*Math.min(3**r/100,20)}function Gf(){return 60*(30+Math.random()*30)}function Wf(r){return{undefined:r.undefined,column:{from:typeof r.column=="function"?r.column:r.column&&r.column.from,to:r.column&&r.column.to},value:{from:typeof r.value=="function"?r.value:r.value&&r.value.from,to:r.value&&r.value.to},row:{from:typeof r.row=="function"?r.row:r.row&&r.row.from,to:r.row&&r.row.to}}}function Jf(r){if(!r||typeof r!="string")return{url:{searchParams:new Map}};let e=r;e=e.slice(e.indexOf("://")+3).split(/[?/]/)[0],e=decodeURIComponent(e.slice(e.indexOf("@")+1));let t=new URL(r.replace(e,e.split(",")[0]));return{url:{username:decodeURIComponent(t.username),password:decodeURIComponent(t.password),host:t.host,hostname:t.hostname,port:t.port,pathname:t.pathname,searchParams:t.searchParams},multihost:e.indexOf(",")>-1&&e}}function Hf(){try{return Ka.default.userInfo().username}catch{return process.env.USERNAME||process.env.USER||process.env.LOGNAME}}var d=Symbol.for("drizzle:entityKind"),cb=Symbol.for("drizzle:hasOwnEntityKind");function b(r,e){if(!r||typeof r!="object")return!1;if(r instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,d))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let t=Object.getPrototypeOf(r).constructor;if(t)for(;t;){if(d in t&&t[d]===e[d])return!0;t=Object.getPrototypeOf(t)}return!1}var Yf,Yn=class{write(e){console.log(e)}};Yf=d,c(Yn,Yf,"ConsoleLogWriter");var Xf,an=class{constructor(e){c(this,"writer");this.writer=e?.writer??new Yn}logQuery(e,t){let n=t.map(i=>{try{return JSON.stringify(i)}catch{return String(i)}}),s=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${s}`)}};Xf=d,c(an,Xf,"DefaultLogger");var ed,cn=class{logQuery(){}};ed=d,c(cn,ed,"NoopLogger");var td,rd,ke=class{constructor(){c(this,rd,"QueryPromise")}catch(e){return this.then(void 0,e)}finally(e){return this.then(t=>(e?.(),t),t=>{throw e?.(),t})}then(e,t){return this.execute().then(e,t)}};td=d,rd=Symbol.toStringTag,c(ke,td,"QueryPromise");var nd,ce=class{constructor(e,t){c(this,"name");c(this,"keyAsName");c(this,"primary");c(this,"notNull");c(this,"default");c(this,"defaultFn");c(this,"onUpdateFn");c(this,"hasDefault");c(this,"isUnique");c(this,"uniqueName");c(this,"uniqueType");c(this,"dataType");c(this,"columnType");c(this,"enumValues");c(this,"generated");c(this,"generatedIdentity");c(this,"config");this.table=e,this.config=t,this.name=t.name,this.keyAsName=t.keyAsName,this.notNull=t.notNull,this.default=t.default,this.defaultFn=t.defaultFn,this.onUpdateFn=t.onUpdateFn,this.hasDefault=t.hasDefault,this.primary=t.primaryKey,this.isUnique=t.isUnique,this.uniqueName=t.uniqueName,this.uniqueType=t.uniqueType,this.dataType=t.dataType,this.columnType=t.columnType,this.generated=t.generated,this.generatedIdentity=t.generatedIdentity}mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}};nd=d,c(ce,nd,"Column");var sd,ln=class{constructor(e,t,n){c(this,"config");c(this,"$default",this.$defaultFn);c(this,"$onUpdate",this.$onUpdateFn);this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:t,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}};sd=d,c(ln,sd,"ColumnBuilder");var it=Symbol.for("drizzle:Name");var id,un=class{constructor(e,t){c(this,"reference");c(this,"_onUpdate","no action");c(this,"_onDelete","no action");this.reference=()=>{let{name:n,columns:s,foreignColumns:i}=e();return{name:n,columns:s,foreignTable:i[0].table,foreignColumns:i}},t&&(this._onUpdate=t.onUpdate,this._onDelete=t.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new Xn(e,this)}};id=d,c(un,id,"PgForeignKeyBuilder");var od,Xn=class{constructor(e,t){c(this,"reference");c(this,"onUpdate");c(this,"onDelete");this.table=e,this.reference=t.reference,this.onUpdate=t._onUpdate,this.onDelete=t._onDelete}getName(){let{name:e,columns:t,foreignColumns:n}=this.reference(),s=t.map(a=>a.name),i=n.map(a=>a.name),o=[this.table[it],...s,n[0].table[it],...i];return e??`${o.join("_")}_fk`}};od=d,c(Xn,od,"PgForeignKey");function es(r,...e){return r(...e)}function Co(r,e){return`${r[it]}_${e.join("_")}_unique`}var ad,ts=class{constructor(e,t){c(this,"columns");c(this,"nullsNotDistinctConfig",!1);this.name=t,this.columns=e}nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new rs(e,this.columns,this.nullsNotDistinctConfig,this.name)}};ad=d,c(ts,ad,"PgUniqueConstraintBuilder");var cd,No=class{constructor(e){c(this,"name");this.name=e}on(...e){return new ts(e,this.name)}};cd=d,c(No,cd,"PgUniqueOnConstraintBuilder");var ld,rs=class{constructor(e,t,n,s){c(this,"columns");c(this,"name");c(this,"nullsNotDistinct",!1);this.table=e,this.columns=t,this.name=s??Co(this.table,this.columns.map(i=>i.name)),this.nullsNotDistinct=n}getName(){return this.name}};ld=d,c(rs,ld,"PgUniqueConstraint");function Ga(r,e,t){for(let n=e;n<r.length;n++){let s=r[n];if(s==="\\"){n++;continue}if(s==='"')return[r.slice(e,n).replace(/\\/g,""),n+1];if(!t&&(s===","||s==="}"))return[r.slice(e,n).replace(/\\/g,""),n]}return[r.slice(e).replace(/\\/g,""),r.length]}function Wa(r,e=0){let t=[],n=e,s=!1;for(;n<r.length;){let i=r[n];if(i===","){(s||n===e)&&t.push(""),s=!0,n++;continue}if(s=!1,i==="\\"){n+=2;continue}if(i==='"'){let[l,f]=Ga(r,n+1,!0);t.push(l),n=f;continue}if(i==="}")return[t,n+1];if(i==="{"){let[l,f]=Wa(r,n+1);t.push(l),n=f;continue}let[o,a]=Ga(r,n,!1);t.push(o),n=a}return[t,n]}function Ja(r){let[e]=Wa(r,1);return e}function Ao(r){return`{${r.map(e=>Array.isArray(e)?Ao(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var ud,M=class extends ln{constructor(){super(...arguments);c(this,"foreignKeyConfigs",[])}array(t){return new ss(this.config.name,this,t)}references(t,n={}){return this.foreignKeyConfigs.push({ref:t,actions:n}),this}unique(t,n){return this.config.isUnique=!0,this.config.uniqueName=t,this.config.uniqueType=n?.nulls,this}generatedAlwaysAs(t){return this.config.generated={as:t,type:"always",mode:"stored"},this}buildForeignKeys(t,n){return this.foreignKeyConfigs.map(({ref:s,actions:i})=>es((o,a)=>{let l=new un(()=>{let f=o();return{columns:[t],foreignColumns:[f]}});return a.onUpdate&&l.onUpdate(a.onUpdate),a.onDelete&&l.onDelete(a.onDelete),l.build(n)},s,i))}buildExtraConfigColumn(t){return new ns(t,this.config)}};ud=d,c(M,ud,"PgColumnBuilder");var fd,C=class extends ce{constructor(e,t){t.uniqueName||(t.uniqueName=Co(e,[t.name])),super(e,t),this.table=e}};fd=d,c(C,fd,"PgColumn");var dd,ns=class extends C{constructor(){super(...arguments);c(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});c(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(t){return this.indexConfig.opClass=t,this}};dd=d,c(ns,dd,"ExtraConfigColumn");var md,Po=class{constructor(e,t,n,s){c(this,"name");c(this,"keyAsName");c(this,"type");c(this,"indexConfig");this.name=e,this.keyAsName=t,this.type=n,this.indexConfig=s}};md=d,c(Po,md,"IndexedColumn");var pd,ss=class extends M{constructor(e,t,n){super(e,"array","PgArray"),this.config.baseBuilder=t,this.config.size=n}build(e){let t=this.config.baseBuilder.build(e);return new is(e,this.config,t)}};pd=d,c(ss,pd,"PgArrayBuilder");var hd,Eo=class extends C{constructor(t,n,s,i){super(t,n);c(this,"size");this.baseColumn=s,this.range=i,this.size=n.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(t){return typeof t=="string"&&(t=Ja(t)),t.map(n=>this.baseColumn.mapFromDriverValue(n))}mapToDriverValue(t,n=!1){let s=t.map(i=>i===null?null:b(this.baseColumn,Eo)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return n?s:Ao(s)}},is=Eo;hd=d,c(is,hd,"PgArray");var Oo=Symbol.for("drizzle:isPgEnum");function Ha(r){return!!r&&typeof r=="function"&&Oo in r&&r[Oo]===!0}var gd,os=class extends M{constructor(e,t){super(e,"string","PgEnumColumn"),this.config.enum=t}build(e){return new as(e,this.config)}};gd=d,c(os,gd,"PgEnumColumnBuilder");var yd,as=class extends C{constructor(t,n){super(t,n);c(this,"enum",this.config.enum);c(this,"enumValues",this.config.enum.enumValues);this.enum=n.enum}getSQLType(){return this.enum.enumName}};yd=d,c(as,yd,"PgEnumColumn");function Ya(r,e,t){let n=Object.assign(s=>new os(s??"",n),{enumName:r,enumValues:e,schema:t,[Oo]:!0});return n}var bd,Se=class{constructor(e,t,n,s=!1){this._={brand:"Subquery",sql:e,selectedFields:t,alias:n,isWith:s}}};bd=d,c(Se,bd,"Subquery");var wd,Ut=class extends Se{};wd=d,c(Ut,wd,"WithSubquery");var Xa="0.40.0";var ko,$o,ue={startActiveSpan(r,e){return ko?($o||($o=ko.trace.getTracer("drizzle-orm",Xa)),es((t,n)=>n.startActiveSpan(r,s=>{try{return e(s)}catch(i){throw s.setStatus({code:t.SpanStatusCode.ERROR,message:i instanceof Error?i.message:"Unknown error"}),i}finally{s.end()}}),ko,$o)):e()}};var me=Symbol.for("drizzle:ViewBaseConfig");var cs=Symbol.for("drizzle:Schema"),ls=Symbol.for("drizzle:Columns"),ec=Symbol.for("drizzle:ExtraConfigColumns"),Io=Symbol.for("drizzle:OriginalName"),Mo=Symbol.for("drizzle:BaseName"),fn=Symbol.for("drizzle:IsAlias"),tc=Symbol.for("drizzle:ExtraConfigBuilder"),vd=Symbol.for("drizzle:IsDrizzleTable"),_d,Sd,Td,xd,Nd,Cd,Ad,Pd,Ed,Od,P=class{constructor(e,t,n){c(this,Sd);c(this,Td);c(this,xd);c(this,Nd);c(this,Cd);c(this,Ad);c(this,Pd,!1);c(this,Ed,!0);c(this,Od);this[it]=this[Io]=e,this[cs]=t,this[Mo]=n}};_d=d,Sd=it,Td=Io,xd=cs,Nd=ls,Cd=ec,Ad=Mo,Pd=fn,Ed=vd,Od=tc,c(P,_d,"Table"),c(P,"Symbol",{Name:it,Schema:cs,OriginalName:Io,Columns:ls,ExtraConfigColumns:ec,BaseName:Mo,IsAlias:fn,ExtraConfigBuilder:tc});function Be(r){return r[it]}function Vt(r){return`${r[cs]??"public"}.${r[it]}`}var Id,Lo=class{};Id=d,c(Lo,Id,"FakePrimitiveParam");function jo(r){return r!=null&&typeof r.getSQL=="function"}function kd(r){let e={sql:"",params:[]};for(let t of r)e.sql+=t.sql,e.params.push(...t.params),t.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...t.typings));return e}var Md,Te=class{constructor(e){c(this,"value");this.value=Array.isArray(e)?e:[e]}getSQL(){return new L([this])}};Md=d,c(Te,Md,"StringChunk");var Ld,br=class{constructor(e){c(this,"decoder",nc);c(this,"shouldInlineParams",!1);this.queryChunks=e}append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return ue.startActiveSpan("drizzle.buildSQL",t=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return t?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,t){let n=Object.assign({},t,{inlineParams:t.inlineParams||this.shouldInlineParams,paramStartIndex:t.paramStartIndex||{value:0}}),{casing:s,escapeName:i,escapeParam:o,prepareTyping:a,inlineParams:l,paramStartIndex:f}=n;return kd(e.map(u=>{if(b(u,Te))return{sql:u.value.join(""),params:[]};if(b(u,wr))return{sql:i(u.value),params:[]};if(u===void 0)return{sql:"",params:[]};if(Array.isArray(u)){let y=[new Te("(")];for(let[h,v]of u.entries())y.push(v),h<u.length-1&&y.push(new Te(", "));return y.push(new Te(")")),this.buildQueryFromSourceParams(y,n)}if(b(u,br))return this.buildQueryFromSourceParams(u.queryChunks,{...n,inlineParams:l||u.shouldInlineParams});if(b(u,P)){let y=u[P.Symbol.Schema],h=u[P.Symbol.Name];return{sql:y===void 0||u[fn]?i(h):i(y)+"."+i(h),params:[]}}if(b(u,ce)){let y=s.getColumnCasing(u);if(t.invokeSource==="indexes")return{sql:i(y),params:[]};let h=u.table[P.Symbol.Schema];return{sql:u.table[fn]||h===void 0?i(u.table[P.Symbol.Name])+"."+i(y):i(h)+"."+i(u.table[P.Symbol.Name])+"."+i(y),params:[]}}if(b(u,Re)){let y=u[me].schema,h=u[me].name;return{sql:y===void 0||u[me].isAlias?i(h):i(y)+"."+i(h),params:[]}}if(b(u,Qe)){if(b(u.value,ft))return{sql:o(f.value++,u),params:[u],typings:["none"]};let y=u.value===null?null:u.encoder.mapToDriverValue(u.value);if(b(y,br))return this.buildQueryFromSourceParams([y],n);if(l)return{sql:this.mapInlineParam(y,n),params:[]};let h=["none"];return a&&(h=[a(u.encoder)]),{sql:o(f.value++,y),params:[y],typings:h}}return b(u,ft)?{sql:o(f.value++,u),params:[u],typings:["none"]}:b(u,br.Aliased)&&u.fieldAlias!==void 0?{sql:i(u.fieldAlias),params:[]}:b(u,Se)?u._.isWith?{sql:i(u._.alias),params:[]}:this.buildQueryFromSourceParams([new Te("("),u._.sql,new Te(") "),new wr(u._.alias)],n):Ha(u)?u.schema?{sql:i(u.schema)+"."+i(u.enumName),params:[]}:{sql:i(u.enumName),params:[]}:jo(u)?u.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([u.getSQL()],n):this.buildQueryFromSourceParams([new Te("("),u.getSQL(),new Te(")")],n):l?{sql:this.mapInlineParam(u,n),params:[]}:{sql:o(f.value++,u),params:[u],typings:["none"]}}))}mapInlineParam(e,{escapeString:t}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return t(e);if(typeof e=="object"){let n=e.toString();return t(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new br.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},L=br;Ld=d,c(L,Ld,"SQL");var jd,wr=class{constructor(e){c(this,"brand");this.value=e}getSQL(){return new L([this])}};jd=d,c(wr,jd,"Name");function rc(r){return typeof r=="object"&&r!==null&&"mapToDriverValue"in r&&typeof r.mapToDriverValue=="function"}var nc={mapFromDriverValue:r=>r},sc={mapToDriverValue:r=>r},tw={...nc,...sc},Dd,Qe=class{constructor(e,t=sc){c(this,"brand");this.value=e,this.encoder=t}getSQL(){return new L([this])}};Dd=d,c(Qe,Dd,"Param");function p(r,...e){let t=[];(e.length>0||r.length>0&&r[0]!=="")&&t.push(new Te(r[0]));for(let[n,s]of e.entries())t.push(s,new Te(r[n+1]));return new L(t)}(r=>{function e(){return new L([])}r.empty=e;function t(l){return new L(l)}r.fromList=t;function n(l){return new L([new Te(l)])}r.raw=n;function s(l,f){let u=[];for(let[y,h]of l.entries())y>0&&f!==void 0&&u.push(f),u.push(h);return new L(u)}r.join=s;function i(l){return new wr(l)}r.identifier=i;function o(l){return new ft(l)}r.placeholder=o;function a(l,f){return new Qe(l,f)}r.param=a})(p||(p={}));(r=>{var t;let n=class{constructor(i,o){c(this,"isSelectionField",!1);this.sql=i,this.fieldAlias=o}getSQL(){return this.sql}clone(){return new n(this.sql,this.fieldAlias)}},e=n;t=d,c(e,t,"SQL.Aliased"),r.Aliased=e})(L||(L={}));var Rd,ft=class{constructor(e){this.name=e}getSQL(){return new L([this])}};Rd=d,c(ft,Rd,"Placeholder");function Do(r,e){return r.map(t=>{if(b(t,ft)){if(!(t.name in e))throw new Error(`No value for placeholder "${t.name}" was provided`);return e[t.name]}if(b(t,Qe)&&b(t.value,ft)){if(!(t.value.name in e))throw new Error(`No value for placeholder "${t.value.name}" was provided`);return t.encoder.mapToDriverValue(e[t.value.name])}return t})}var $d=Symbol.for("drizzle:IsDrizzleView"),zd,Fd,Qd,Re=class{constructor({name:e,schema:t,selectedFields:n,query:s}){c(this,Fd);c(this,Qd,!0);this[me]={name:e,originalName:e,schema:t,selectedFields:n,query:s,isExisting:!s,isAlias:!1}}getSQL(){return new L([this])}};zd=d,Fd=me,Qd=$d,c(Re,zd,"View");ce.prototype.getSQL=function(){return new L([this])};P.prototype.getSQL=function(){return new L([this])};Se.prototype.getSQL=function(){return new L([this])};var qd,Mt=class{constructor(e){this.table=e}get(e,t){return t==="table"?this.table:e[t]}};qd=d,c(Mt,qd,"ColumnAliasProxyHandler");var Bd,Kt=class{constructor(e,t){this.alias=e,this.replaceOriginalName=t}get(e,t){if(t===P.Symbol.IsAlias)return!0;if(t===P.Symbol.Name)return this.alias;if(this.replaceOriginalName&&t===P.Symbol.OriginalName)return this.alias;if(t===me)return{...e[me],name:this.alias,isAlias:!0};if(t===P.Symbol.Columns){let s=e[P.Symbol.Columns];if(!s)return s;let i={};return Object.keys(s).map(o=>{i[o]=new Proxy(s[o],new Mt(new Proxy(e,this)))}),i}let n=e[t];return b(n,ce)?new Proxy(n,new Mt(new Proxy(e,this))):n}};Bd=d,c(Kt,Bd,"TableAliasProxyHandler");var Ud,Ro=class{constructor(e){this.alias=e}get(e,t){return t==="sourceTable"?dn(e.sourceTable,this.alias):e[t]}};Ud=d,c(Ro,Ud,"RelationTableAliasProxyHandler");function dn(r,e){return new Proxy(r,new Kt(e,!1))}function dt(r,e){return new Proxy(r,new Mt(new Proxy(r.table,new Kt(e,!1))))}function zo(r,e){return new L.Aliased(mn(r.sql,e),r.fieldAlias)}function mn(r,e){return p.join(r.queryChunks.map(t=>b(t,ce)?dt(t,e):b(t,L)?mn(t,e):b(t,L.Aliased)?zo(t,e):t))}var Vd,Fo=class{constructor(e){c(this,"config");this.config={...e}}get(e,t){if(t==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(t===me)return{...e[me],selectedFields:new Proxy(e[me].selectedFields,this)};if(typeof t=="symbol")return e[t];let s=(b(e,Se)?e._.selectedFields:b(e,Re)?e[me].selectedFields:e)[t];if(b(s,L.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!s.isSelectionField)return s.sql;let i=s.clone();return i.isSelectionField=!0,i}if(b(s,L)){if(this.config.sqlBehavior==="sql")return s;throw new Error(`You tried to reference "${t}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return b(s,ce)?this.config.alias?new Proxy(s,new Mt(new Proxy(s.table,new Kt(this.config.alias,this.config.replaceOriginalName??!1)))):s:typeof s!="object"||s===null?s:new Proxy(s,new Fo(this.config))}},ae=Fo;Vd=d,c(ae,Vd,"SelectionProxyHandler");function ic(r,e,t){let n={},s=r.reduce((i,{path:o,field:a},l)=>{let f;b(a,ce)?f=a:b(a,L)?f=a.decoder:f=a.sql.decoder;let u=i;for(let[y,h]of o.entries())if(y<o.length-1)h in u||(u[h]={}),u=u[h];else{let v=e[l],T=u[h]=v===null?null:f.mapFromDriverValue(v);if(t&&b(a,ce)&&o.length===2){let w=o[0];w in n?typeof n[w]=="string"&&n[w]!==Be(a.table)&&(n[w]=!1):n[w]=T===null?Be(a.table):!1}}return i},{});if(t&&Object.keys(n).length>0)for(let[i,o]of Object.entries(n))typeof o=="string"&&!t[o]&&(s[i]=null);return s}function He(r,e){return Object.entries(r).reduce((t,[n,s])=>{if(typeof n!="string")return t;let i=e?[...e,n]:[n];return b(s,ce)||b(s,L)||b(s,L.Aliased)?t.push({path:i,field:s}):b(s,P)?t.push(...He(s[P.Symbol.Columns],i)):t.push(...He(s,i)),t},[])}function pn(r,e){let t=Object.keys(r),n=Object.keys(e);if(t.length!==n.length)return!1;for(let[s,i]of t.entries())if(i!==n[s])return!1;return!0}function us(r,e){let t=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,s])=>b(s,L)||b(s,ce)?[n,s]:[n,new Qe(s,r[P.Symbol.Columns][n])]);if(t.length===0)throw new Error("No values to set");return Object.fromEntries(t)}function oc(r,e){for(let t of e)for(let n of Object.getOwnPropertyNames(t.prototype))n!=="constructor"&&Object.defineProperty(r.prototype,n,Object.getOwnPropertyDescriptor(t.prototype,n)||Object.create(null))}function hn(r){return r[P.Symbol.Columns]}function vt(r){return b(r,Se)?r._.alias:b(r,Re)?r[me].name:b(r,L)?void 0:r[P.Symbol.IsAlias]?r[P.Symbol.Name]:r[P.Symbol.BaseName]}function te(r,e){return{name:typeof r=="string"&&r.length>0?r:"",config:typeof r=="object"?r:e}}function ac(r){if(typeof r!="object"||r===null||r.constructor.name!=="Object")return!1;if("logger"in r){let e=typeof r.logger;return!(e!=="boolean"&&(e!=="object"||typeof r.logger.logQuery!="function")&&e!=="undefined")}if("schema"in r){let e=typeof r.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in r){let e=typeof r.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in r)return!(r.mode!=="default"||r.mode!=="planetscale"||r.mode!==void 0);if("connection"in r){let e=typeof r.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in r){let e=typeof r.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(r).length===0}var Kd,vr=class extends ke{constructor(t,n,s,i){super();c(this,"config");c(this,"authToken");c(this,"execute",t=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(t,this.authToken)));this.session=n,this.dialect=s,this.config={table:t,withList:i}}where(t){return this.config.where=t,this}returning(t=this.config.table[P.Symbol.Columns]){return this.config.returningFields=t,this.config.returning=He(t),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(t){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,t,!0))}prepare(t){return this._prepare(t)}setToken(t){return this.authToken=t,this}getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new ae({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};Kd=d,c(vr,Kd,"PgDelete");function Zd(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(t=>t.toLowerCase()).join("_")}function Gd(r){return(r.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((t,n,s)=>{let i=s===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return t+i},"")}function Wd(r){return r}var Jd,gn=class{constructor(e){c(this,"cache",{});c(this,"cachedTables",{});c(this,"convert");this.convert=e==="snake_case"?Zd:e==="camelCase"?Gd:Wd}getColumnCasing(e){if(!e.keyAsName)return e.name;let t=e.table[P.Symbol.Schema]??"public",n=e.table[P.Symbol.OriginalName],s=`${t}.${n}.${e.name}`;return this.cache[s]||this.cacheTable(e.table),this.cache[s]}cacheTable(e){let t=e[P.Symbol.Schema]??"public",n=e[P.Symbol.OriginalName],s=`${t}.${n}`;if(!this.cachedTables[s]){for(let i of Object.values(e[P.Symbol.Columns])){let o=`${s}.${i.name}`;this.cache[o]=this.convert(i.name)}this.cachedTables[s]=!0}}clearCache(){this.cache={},this.cachedTables={}}};Jd=d,c(gn,Jd,"CasingCache");var Hd,_r=class extends Error{constructor({message:e,cause:t}){super(e),this.name="DrizzleError",this.cause=t}};Hd=d,c(_r,Hd,"DrizzleError");var Yd,yn=class extends _r{constructor(){super({message:"Rollback"})}};Yd=d,c(yn,Yd,"TransactionRollbackError");var Xd,mt=class extends M{generatedAlwaysAsIdentity(e){if(e){let{name:t,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:t,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:t,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:t,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}};Xd=d,c(mt,Xd,"PgIntColumnBaseBuilder");var em,fs=class extends mt{constructor(e){super(e,"number","PgBigInt53")}build(e){return new ds(e,this.config)}};em=d,c(fs,em,"PgBigInt53Builder");var tm,ds=class extends C{getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}};tm=d,c(ds,tm,"PgBigInt53");var rm,ms=class extends mt{constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new ps(e,this.config)}};rm=d,c(ms,rm,"PgBigInt64Builder");var nm,ps=class extends C{getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}};nm=d,c(ps,nm,"PgBigInt64");function cc(r,e){let{name:t,config:n}=te(r,e);return n.mode==="number"?new fs(t):new ms(t)}var sm,hs=class extends M{constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new gs(e,this.config)}};sm=d,c(hs,sm,"PgBigSerial53Builder");var im,gs=class extends C{getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}};im=d,c(gs,im,"PgBigSerial53");var om,ys=class extends M{constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new bs(e,this.config)}};om=d,c(ys,om,"PgBigSerial64Builder");var am,bs=class extends C{getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}};am=d,c(bs,am,"PgBigSerial64");function lc(r,e){let{name:t,config:n}=te(r,e);return n.mode==="number"?new hs(t):new ys(t)}var cm,ws=class extends M{constructor(e){super(e,"boolean","PgBoolean")}build(e){return new vs(e,this.config)}};cm=d,c(ws,cm,"PgBooleanBuilder");var lm,vs=class extends C{getSQLType(){return"boolean"}};lm=d,c(vs,lm,"PgBoolean");function uc(r){return new ws(r??"")}var um,_s=class extends M{constructor(e,t){super(e,"string","PgChar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new Ss(e,this.config)}};um=d,c(_s,um,"PgCharBuilder");var fm,Ss=class extends C{constructor(){super(...arguments);c(this,"length",this.config.length);c(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}};fm=d,c(Ss,fm,"PgChar");function fc(r,e={}){let{name:t,config:n}=te(r,e);return new _s(t,n)}var dm,Ts=class extends M{constructor(e){super(e,"string","PgCidr")}build(e){return new xs(e,this.config)}};dm=d,c(Ts,dm,"PgCidrBuilder");var mm,xs=class extends C{getSQLType(){return"cidr"}};mm=d,c(xs,mm,"PgCidr");function dc(r){return new Ts(r??"")}var pm,Ns=class extends M{constructor(e,t,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=t,this.config.customTypeParams=n}build(e){return new Cs(e,this.config)}};pm=d,c(Ns,pm,"PgCustomColumnBuilder");var hm,Cs=class extends C{constructor(t,n){super(t,n);c(this,"sqlName");c(this,"mapTo");c(this,"mapFrom");this.sqlName=n.customTypeParams.dataType(n.fieldConfig),this.mapTo=n.customTypeParams.toDriver,this.mapFrom=n.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(t){return typeof this.mapFrom=="function"?this.mapFrom(t):t}mapToDriverValue(t){return typeof this.mapTo=="function"?this.mapTo(t):t}};hm=d,c(Cs,hm,"PgCustomColumn");function mc(r){return(e,t)=>{let{name:n,config:s}=te(e,t);return new Ns(n,s,r)}}var gm,ot=class extends M{defaultNow(){return this.default(p`now()`)}};gm=d,c(ot,gm,"PgDateColumnBaseBuilder");var ym,As=class extends ot{constructor(e){super(e,"date","PgDate")}build(e){return new Sr(e,this.config)}};ym=d,c(As,ym,"PgDateBuilder");var bm,Sr=class extends C{getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}};bm=d,c(Sr,bm,"PgDate");var wm,Ps=class extends ot{constructor(e){super(e,"string","PgDateString")}build(e){return new Tr(e,this.config)}};wm=d,c(Ps,wm,"PgDateStringBuilder");var vm,Tr=class extends C{getSQLType(){return"date"}};vm=d,c(Tr,vm,"PgDateString");function pc(r,e){let{name:t,config:n}=te(r,e);return n?.mode==="date"?new As(t):new Ps(t)}var _m,Es=class extends M{constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new Os(e,this.config)}};_m=d,c(Es,_m,"PgDoublePrecisionBuilder");var Sm,Os=class extends C{getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}};Sm=d,c(Os,Sm,"PgDoublePrecision");function hc(r){return new Es(r??"")}var Tm,ks=class extends M{constructor(e){super(e,"string","PgInet")}build(e){return new $s(e,this.config)}};Tm=d,c(ks,Tm,"PgInetBuilder");var xm,$s=class extends C{getSQLType(){return"inet"}};xm=d,c($s,xm,"PgInet");function gc(r){return new ks(r??"")}var Nm,Is=class extends mt{constructor(e){super(e,"number","PgInteger")}build(e){return new Ms(e,this.config)}};Nm=d,c(Is,Nm,"PgIntegerBuilder");var Cm,Ms=class extends C{getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}};Cm=d,c(Ms,Cm,"PgInteger");function yc(r){return new Is(r??"")}var Am,Ls=class extends M{constructor(e,t){super(e,"string","PgInterval"),this.config.intervalConfig=t}build(e){return new js(e,this.config)}};Am=d,c(Ls,Am,"PgIntervalBuilder");var Pm,js=class extends C{constructor(){super(...arguments);c(this,"fields",this.config.intervalConfig.fields);c(this,"precision",this.config.intervalConfig.precision)}getSQLType(){let t=this.fields?` ${this.fields}`:"",n=this.precision?`(${this.precision})`:"";return`interval${t}${n}`}};Pm=d,c(js,Pm,"PgInterval");function bc(r,e={}){let{name:t,config:n}=te(r,e);return new Ls(t,n)}var Em,Ds=class extends M{constructor(e){super(e,"json","PgJson")}build(e){return new xr(e,this.config)}};Em=d,c(Ds,Em,"PgJsonBuilder");var Om,xr=class extends C{constructor(e,t){super(e,t)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};Om=d,c(xr,Om,"PgJson");function wc(r){return new Ds(r??"")}var km,Rs=class extends M{constructor(e){super(e,"json","PgJsonb")}build(e){return new Nr(e,this.config)}};km=d,c(Rs,km,"PgJsonbBuilder");var $m,Nr=class extends C{constructor(e,t){super(e,t)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}};$m=d,c(Nr,$m,"PgJsonb");function vc(r){return new Rs(r??"")}var Im,zs=class extends M{constructor(e){super(e,"array","PgLine")}build(e){return new Fs(e,this.config)}};Im=d,c(zs,Im,"PgLineBuilder");var Mm,Fs=class extends C{getSQLType(){return"line"}mapFromDriverValue(e){let[t,n,s]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(n),Number.parseFloat(s)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}};Mm=d,c(Fs,Mm,"PgLine");var Lm,Qs=class extends M{constructor(e){super(e,"json","PgLineABC")}build(e){return new qs(e,this.config)}};Lm=d,c(Qs,Lm,"PgLineABCBuilder");var jm,qs=class extends C{getSQLType(){return"line"}mapFromDriverValue(e){let[t,n,s]=e.slice(1,-1).split(",");return{a:Number.parseFloat(t),b:Number.parseFloat(n),c:Number.parseFloat(s)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}};jm=d,c(qs,jm,"PgLineABC");function _c(r,e){let{name:t,config:n}=te(r,e);return!n?.mode||n.mode==="tuple"?new zs(t):new Qs(t)}var Dm,Bs=class extends M{constructor(e){super(e,"string","PgMacaddr")}build(e){return new Us(e,this.config)}};Dm=d,c(Bs,Dm,"PgMacaddrBuilder");var Rm,Us=class extends C{getSQLType(){return"macaddr"}};Rm=d,c(Us,Rm,"PgMacaddr");function Sc(r){return new Bs(r??"")}var zm,Vs=class extends M{constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Ks(e,this.config)}};zm=d,c(Vs,zm,"PgMacaddr8Builder");var Fm,Ks=class extends C{getSQLType(){return"macaddr8"}};Fm=d,c(Ks,Fm,"PgMacaddr8");function Tc(r){return new Vs(r??"")}var Qm,Zs=class extends M{constructor(e,t,n){super(e,"string","PgNumeric"),this.config.precision=t,this.config.scale=n}build(e){return new Cr(e,this.config)}};Qm=d,c(Zs,Qm,"PgNumericBuilder");var qm,Cr=class extends C{constructor(t,n){super(t,n);c(this,"precision");c(this,"scale");this.precision=n.precision,this.scale=n.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};qm=d,c(Cr,qm,"PgNumeric");function Qo(r,e){let{name:t,config:n}=te(r,e);return new Zs(t,n?.precision,n?.scale)}var xc=Qo;var Bm,Gs=class extends M{constructor(e){super(e,"array","PgPointTuple")}build(e){return new Ws(e,this.config)}};Bm=d,c(Gs,Bm,"PgPointTupleBuilder");var Um,Ws=class extends C{getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,n]=e.slice(1,-1).split(",");return[Number.parseFloat(t),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}};Um=d,c(Ws,Um,"PgPointTuple");var Vm,Js=class extends M{constructor(e){super(e,"json","PgPointObject")}build(e){return new Hs(e,this.config)}};Vm=d,c(Js,Vm,"PgPointObjectBuilder");var Km,Hs=class extends C{getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[t,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(t),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}};Km=d,c(Hs,Km,"PgPointObject");function Nc(r,e){let{name:t,config:n}=te(r,e);return!n?.mode||n.mode==="tuple"?new Gs(t):new Js(t)}function Zm(r){let e=[];for(let t=0;t<r.length;t+=2)e.push(Number.parseInt(r.slice(t,t+2),16));return new Uint8Array(e)}function Cc(r,e){let t=new ArrayBuffer(8),n=new DataView(t);for(let s=0;s<8;s++)n.setUint8(s,r[e+s]);return n.getFloat64(0,!0)}function qo(r){let e=Zm(r),t=0,n=e[t];t+=1;let s=new DataView(e.buffer),i=s.getUint32(t,n===1);t+=4;let o;if(i&536870912&&(o=s.getUint32(t,n===1),t+=4),(i&65535)===1){let a=Cc(e,t);t+=8;let l=Cc(e,t);return t+=8,[a,l]}throw new Error("Unsupported geometry type")}var Gm,Ys=class extends M{constructor(e){super(e,"array","PgGeometry")}build(e){return new Xs(e,this.config)}};Gm=d,c(Ys,Gm,"PgGeometryBuilder");var Wm,Xs=class extends C{getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return qo(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}};Wm=d,c(Xs,Wm,"PgGeometry");var Jm,ei=class extends M{constructor(e){super(e,"json","PgGeometryObject")}build(e){return new ti(e,this.config)}};Jm=d,c(ei,Jm,"PgGeometryObjectBuilder");var Hm,ti=class extends C{getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let t=qo(e);return{x:t[0],y:t[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}};Hm=d,c(ti,Hm,"PgGeometryObject");function Ac(r,e){let{name:t,config:n}=te(r,e);return!n?.mode||n.mode==="tuple"?new Ys(t):new ei(t)}var Ym,ri=class extends M{constructor(e,t){super(e,"number","PgReal"),this.config.length=t}build(e){return new ni(e,this.config)}};Ym=d,c(ri,Ym,"PgRealBuilder");var Xm,ni=class extends C{constructor(t,n){super(t,n);c(this,"mapFromDriverValue",t=>typeof t=="string"?Number.parseFloat(t):t)}getSQLType(){return"real"}};Xm=d,c(ni,Xm,"PgReal");function Pc(r){return new ri(r??"")}var ep,si=class extends M{constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new ii(e,this.config)}};ep=d,c(si,ep,"PgSerialBuilder");var tp,ii=class extends C{getSQLType(){return"serial"}};tp=d,c(ii,tp,"PgSerial");function Ec(r){return new si(r??"")}var rp,oi=class extends mt{constructor(e){super(e,"number","PgSmallInt")}build(e){return new ai(e,this.config)}};rp=d,c(oi,rp,"PgSmallIntBuilder");var np,ai=class extends C{constructor(){super(...arguments);c(this,"mapFromDriverValue",t=>typeof t=="string"?Number(t):t)}getSQLType(){return"smallint"}};np=d,c(ai,np,"PgSmallInt");function Oc(r){return new oi(r??"")}var sp,ci=class extends M{constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new li(e,this.config)}};sp=d,c(ci,sp,"PgSmallSerialBuilder");var ip,li=class extends C{getSQLType(){return"smallserial"}};ip=d,c(li,ip,"PgSmallSerial");function kc(r){return new ci(r??"")}var op,ui=class extends M{constructor(e,t){super(e,"string","PgText"),this.config.enumValues=t.enum}build(e){return new fi(e,this.config)}};op=d,c(ui,op,"PgTextBuilder");var ap,fi=class extends C{constructor(){super(...arguments);c(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}};ap=d,c(fi,ap,"PgText");function $c(r,e={}){let{name:t,config:n}=te(r,e);return new ui(t,n)}var cp,di=class extends ot{constructor(e,t,n){super(e,"string","PgTime"),this.withTimezone=t,this.precision=n,this.config.withTimezone=t,this.config.precision=n}build(e){return new Ar(e,this.config)}};cp=d,c(di,cp,"PgTimeBuilder");var lp,Ar=class extends C{constructor(t,n){super(t,n);c(this,"withTimezone");c(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};lp=d,c(Ar,lp,"PgTime");function Ic(r,e={}){let{name:t,config:n}=te(r,e);return new di(t,n.withTimezone??!1,n.precision)}var up,mi=class extends ot{constructor(e,t,n){super(e,"date","PgTimestamp"),this.config.withTimezone=t,this.config.precision=n}build(e){return new Pr(e,this.config)}};up=d,c(mi,up,"PgTimestampBuilder");var fp,Pr=class extends C{constructor(t,n){super(t,n);c(this,"withTimezone");c(this,"precision");c(this,"mapFromDriverValue",t=>new Date(this.withTimezone?t:t+"+0000"));c(this,"mapToDriverValue",t=>t.toISOString());this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}};fp=d,c(Pr,fp,"PgTimestamp");var dp,pi=class extends ot{constructor(e,t,n){super(e,"string","PgTimestampString"),this.config.withTimezone=t,this.config.precision=n}build(e){return new Er(e,this.config)}};dp=d,c(pi,dp,"PgTimestampStringBuilder");var mp,Er=class extends C{constructor(t,n){super(t,n);c(this,"withTimezone");c(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}};mp=d,c(Er,mp,"PgTimestampString");function Mc(r,e={}){let{name:t,config:n}=te(r,e);return n?.mode==="string"?new pi(t,n.withTimezone??!1,n.precision):new mi(t,n?.withTimezone??!1,n?.precision)}var pp,hi=class extends M{constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(p`gen_random_uuid()`)}build(e){return new Or(e,this.config)}};pp=d,c(hi,pp,"PgUUIDBuilder");var hp,Or=class extends C{getSQLType(){return"uuid"}};hp=d,c(Or,hp,"PgUUID");function bn(r){return new hi(r??"")}var gp,gi=class extends M{constructor(e,t){super(e,"string","PgVarchar"),this.config.length=t.length,this.config.enumValues=t.enum}build(e){return new yi(e,this.config)}};gp=d,c(gi,gp,"PgVarcharBuilder");var yp,yi=class extends C{constructor(){super(...arguments);c(this,"length",this.config.length);c(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}};yp=d,c(yi,yp,"PgVarchar");function kr(r,e={}){let{name:t,config:n}=te(r,e);return new gi(t,n)}var bp,bi=class extends M{constructor(e,t){super(e,"string","PgBinaryVector"),this.config.dimensions=t.dimensions}build(e){return new wi(e,this.config)}};bp=d,c(bi,bp,"PgBinaryVectorBuilder");var wp,wi=class extends C{constructor(){super(...arguments);c(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}};wp=d,c(wi,wp,"PgBinaryVector");function Lc(r,e){let{name:t,config:n}=te(r,e);return new bi(t,n)}var vp,vi=class extends M{constructor(e,t){super(e,"array","PgHalfVector"),this.config.dimensions=t.dimensions}build(e){return new _i(e,this.config)}};vp=d,c(vi,vp,"PgHalfVectorBuilder");var _p,_i=class extends C{constructor(){super(...arguments);c(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){return t.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}};_p=d,c(_i,_p,"PgHalfVector");function jc(r,e){let{name:t,config:n}=te(r,e);return new vi(t,n)}var Sp,Si=class extends M{constructor(e,t){super(e,"string","PgSparseVector"),this.config.dimensions=t.dimensions}build(e){return new Ti(e,this.config)}};Sp=d,c(Si,Sp,"PgSparseVectorBuilder");var Tp,Ti=class extends C{constructor(){super(...arguments);c(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}};Tp=d,c(Ti,Tp,"PgSparseVector");function Dc(r,e){let{name:t,config:n}=te(r,e);return new Si(t,n)}var xp,xi=class extends M{constructor(e,t){super(e,"array","PgVector"),this.config.dimensions=t.dimensions}build(e){return new Ni(e,this.config)}};xp=d,c(xi,xp,"PgVectorBuilder");var Np,Ni=class extends C{constructor(){super(...arguments);c(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){return t.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}};Np=d,c(Ni,Np,"PgVector");function Rc(r,e){let{name:t,config:n}=te(r,e);return new xi(t,n)}function zc(){return{bigint:cc,bigserial:lc,boolean:uc,char:fc,cidr:dc,customType:mc,date:pc,doublePrecision:hc,inet:gc,integer:yc,interval:bc,json:wc,jsonb:vc,line:_c,macaddr:Sc,macaddr8:Tc,numeric:Qo,point:Nc,geometry:Ac,real:Pc,serial:Ec,smallint:Oc,smallserial:kc,text:$c,time:Ic,timestamp:Mc,uuid:bn,varchar:kr,bit:Lc,halfvec:jc,sparsevec:Dc,vector:Rc}}var Bo=Symbol.for("drizzle:PgInlineForeignKeys"),Fc=Symbol.for("drizzle:EnableRLS"),Cp,Ap,Pp,Ep,Op,Ae=class extends P{constructor(){super(...arguments);c(this,Ap,[]);c(this,Pp,!1);c(this,Ep);c(this,Op,{})}};Cp=d,Ap=Bo,Pp=Fc,Ep=P.Symbol.ExtraConfigBuilder,Op=P.Symbol.ExtraConfigColumns,c(Ae,Cp,"PgTable"),c(Ae,"Symbol",Object.assign({},P.Symbol,{InlineForeignKeys:Bo,EnableRLS:Fc}));function Uo(r,e,t,n,s=r){let i=new Ae(r,n,s),o=typeof e=="function"?e(zc()):e,a=Object.fromEntries(Object.entries(o).map(([u,y])=>{let h=y;h.setName(u);let v=h.build(i);return i[Bo].push(...h.buildForeignKeys(v,i)),[u,v]})),l=Object.fromEntries(Object.entries(o).map(([u,y])=>{let h=y;h.setName(u);let v=h.buildExtraConfigColumn(i);return[u,v]})),f=Object.assign(i,a);return f[P.Symbol.Columns]=a,f[P.Symbol.ExtraConfigColumns]=l,t&&(f[Ae.Symbol.ExtraConfigBuilder]=t),Object.assign(f,{enableRLS:()=>(f[Ae.Symbol.EnableRLS]=!0,f)})}var Vo=(r,e,t)=>Uo(r,e,t,void 0);var kp,wn=class{constructor(e,t){c(this,"columns");c(this,"name");this.columns=e,this.name=t}build(e){return new Ci(e,this.columns,this.name)}};kp=d,c(wn,kp,"PgPrimaryKeyBuilder");var $p,Ci=class{constructor(e,t,n){c(this,"columns");c(this,"name");this.table=e,this.columns=t,this.name=n}getName(){return this.name??`${this.table[Ae.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}};$p=d,c(Ci,$p,"PgPrimaryKey");function Ue(r,e){return rc(e)&&!jo(r)&&!b(r,Qe)&&!b(r,ft)&&!b(r,ce)&&!b(r,P)&&!b(r,Re)?new Qe(r,e):r}var Zt=(r,e)=>p`${r} = ${Ue(e,r)}`,Qc=(r,e)=>p`${r} <> ${Ue(e,r)}`;function vn(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new L(e):new L([new Te("("),p.join(e,new Te(" and ")),new Te(")")])}function qc(...r){let e=r.filter(t=>t!==void 0);if(e.length!==0)return e.length===1?new L(e):new L([new Te("("),p.join(e,new Te(" or ")),new Te(")")])}function Bc(r){return p`not ${r}`}var Uc=(r,e)=>p`${r} > ${Ue(e,r)}`,Vc=(r,e)=>p`${r} >= ${Ue(e,r)}`,Kc=(r,e)=>p`${r} < ${Ue(e,r)}`,Zc=(r,e)=>p`${r} <= ${Ue(e,r)}`;function Gc(r,e){return Array.isArray(e)?e.length===0?p`false`:p`${r} in ${e.map(t=>Ue(t,r))}`:p`${r} in ${Ue(e,r)}`}function Wc(r,e){return Array.isArray(e)?e.length===0?p`true`:p`${r} not in ${e.map(t=>Ue(t,r))}`:p`${r} not in ${Ue(e,r)}`}function Jc(r){return p`${r} is null`}function Hc(r){return p`${r} is not null`}function Yc(r){return p`exists ${r}`}function Xc(r){return p`not exists ${r}`}function el(r,e,t){return p`${r} between ${Ue(e,r)} and ${Ue(t,r)}`}function tl(r,e,t){return p`${r} not between ${Ue(e,r)} and ${Ue(t,r)}`}function Ai(r,e){return p`${r} like ${e}`}function rl(r,e){return p`${r} not like ${e}`}function nl(r,e){return p`${r} ilike ${e}`}function sl(r,e){return p`${r} not ilike ${e}`}function il(r){return p`${r} asc`}function ol(r){return p`${r} desc`}var Lp,_n=class{constructor(e,t,n){c(this,"referencedTableName");c(this,"fieldName");this.sourceTable=e,this.referencedTable=t,this.relationName=n,this.referencedTableName=t[P.Symbol.Name]}};Lp=d,c(_n,Lp,"Relation");var jp,Pi=class{constructor(e,t){this.table=e,this.config=t}};jp=d,c(Pi,jp,"Relations");var Dp,Ko=class extends _n{constructor(e,t,n,s){super(e,t,n?.relationName),this.config=n,this.isNullable=s}withFieldName(e){let t=new Ko(this.sourceTable,this.referencedTable,this.config,this.isNullable);return t.fieldName=e,t}},_t=Ko;Dp=d,c(_t,Dp,"One");var Rp,Zo=class extends _n{constructor(e,t,n){super(e,t,n?.relationName),this.config=n}withFieldName(e){let t=new Zo(this.sourceTable,this.referencedTable,this.config);return t.fieldName=e,t}},$r=Zo;Rp=d,c($r,Rp,"Many");function al(){return{and:vn,between:el,eq:Zt,exists:Yc,gt:Uc,gte:Vc,ilike:nl,inArray:Gc,isNull:Jc,isNotNull:Hc,like:Ai,lt:Kc,lte:Zc,ne:Qc,not:Bc,notBetween:tl,notExists:Xc,notLike:rl,notIlike:sl,notInArray:Wc,or:qc,sql:p}}function cl(){return{sql:p,asc:il,desc:ol}}function ll(r,e){Object.keys(r).length===1&&"default"in r&&!b(r.default,P)&&(r=r.default);let t={},n={},s={};for(let[i,o]of Object.entries(r))if(b(o,P)){let a=Vt(o),l=n[a];t[a]=i,s[i]={tsName:i,dbName:o[P.Symbol.Name],schema:o[P.Symbol.Schema],columns:o[P.Symbol.Columns],relations:l?.relations??{},primaryKey:l?.primaryKey??[]};for(let u of Object.values(o[P.Symbol.Columns]))u.primary&&s[i].primaryKey.push(u);let f=o[P.Symbol.ExtraConfigBuilder]?.(o[P.Symbol.ExtraConfigColumns]);if(f)for(let u of Object.values(f))b(u,wn)&&s[i].primaryKey.push(...u.columns)}else if(b(o,Pi)){let a=Vt(o.table),l=t[a],f=o.config(e(o.table)),u;for(let[y,h]of Object.entries(f))if(l){let v=s[l];v.relations[y]=h,u&&v.primaryKey.push(...u)}else a in n||(n[a]={relations:{},primaryKey:u}),n[a].relations[y]=h}return{tables:s,tableNamesMap:t}}function Ip(r){return function(t,n){return new _t(r,t,n,n?.fields.reduce((s,i)=>s&&i.notNull,!0)??!1)}}function Mp(r){return function(t,n){return new $r(r,t,n)}}function ul(r,e,t){if(b(t,_t)&&t.config)return{fields:t.config.fields,references:t.config.references};let n=e[Vt(t.referencedTable)];if(!n)throw new Error(`Table "${t.referencedTable[P.Symbol.Name]}" not found in schema`);let s=r[n];if(!s)throw new Error(`Table "${n}" not found in schema`);let i=t.sourceTable,o=e[Vt(i)];if(!o)throw new Error(`Table "${i[P.Symbol.Name]}" not found in schema`);let a=[];for(let l of Object.values(s.relations))(t.relationName&&t!==l&&l.relationName===t.relationName||!t.relationName&&l.referencedTable===t.sourceTable)&&a.push(l);if(a.length>1)throw t.relationName?new Error(`There are multiple relations with name "${t.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${t.sourceTable[P.Symbol.Name]}". Please specify relation name`);if(a[0]&&b(a[0],_t)&&a[0].config)return{fields:a[0].config.references,references:a[0].config.fields};throw new Error(`There is not enough information to infer relation "${o}.${t.fieldName}"`)}function fl(r){return{one:Ip(r),many:Mp(r)}}function Ei(r,e,t,n,s=i=>i){let i={};for(let[o,a]of n.entries())if(a.isJson){let l=e.relations[a.tsKey],f=t[o],u=typeof f=="string"?JSON.parse(f):f;i[a.tsKey]=b(l,_t)?u&&Ei(r,r[a.relationTableTsKey],u,a.selection,s):u.map(y=>Ei(r,r[a.relationTableTsKey],y,a.selection,s))}else{let l=s(t[o]),f=a.field,u;b(f,ce)?u=f:b(f,L)?u=f.decoder:u=f.sql.decoder,i[a.tsKey]=l===null?null:u.mapFromDriverValue(l)}return i}var zp,pt=class extends Re{};zp=d,c(pt,zp,"PgViewBase");var Fp,St=class{constructor(e){c(this,"casing");this.casing=new gn(e?.casing)}async migrate(e,t,n){let s=typeof n=="string"?"__drizzle_migrations":n.migrationsTable??"__drizzle_migrations",i=typeof n=="string"?"drizzle":n.migrationsSchema??"drizzle",o=p`
			CREATE TABLE IF NOT EXISTS ${p.identifier(i)}.${p.identifier(s)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await t.execute(p`CREATE SCHEMA IF NOT EXISTS ${p.identifier(i)}`),await t.execute(o);let l=(await t.all(p`select id, hash, created_at from ${p.identifier(i)}.${p.identifier(s)} order by created_at desc limit 1`))[0];await t.transaction(async f=>{for await(let u of e)if(!l||Number(l.created_at)<u.folderMillis){for(let y of u.sql)await f.execute(p.raw(y));await f.execute(p`insert into ${p.identifier(i)}.${p.identifier(s)} ("hash", "created_at") values(${u.hash}, ${u.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!e?.length)return;let t=[p`with `];for(let[n,s]of e.entries())t.push(p`${p.identifier(s._.alias)} as (${s._.sql})`),n<e.length-1&&t.push(p`, `);return t.push(p` `),p.join(t)}buildDeleteQuery({table:e,where:t,returning:n,withList:s}){let i=this.buildWithCTE(s),o=n?p` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,a=t?p` where ${t}`:void 0;return p`${i}delete from ${e}${a}${o}`}buildUpdateSet(e,t){let n=e[P.Symbol.Columns],s=Object.keys(n).filter(o=>t[o]!==void 0||n[o]?.onUpdateFn!==void 0),i=s.length;return p.join(s.flatMap((o,a)=>{let l=n[o],f=t[o]??p.param(l.onUpdateFn(),l),u=p`${p.identifier(this.casing.getColumnCasing(l))} = ${f}`;return a<i-1?[u,p.raw(", ")]:[u]}))}buildUpdateQuery({table:e,set:t,where:n,returning:s,withList:i,from:o,joins:a}){let l=this.buildWithCTE(i),f=e[Ae.Symbol.Name],u=e[Ae.Symbol.Schema],y=e[Ae.Symbol.OriginalName],h=f===y?void 0:f,v=p`${u?p`${p.identifier(u)}.`:void 0}${p.identifier(y)}${h&&p` ${p.identifier(h)}`}`,T=this.buildUpdateSet(e,t),w=o&&p.join([p.raw(" from "),this.buildFromTable(o)]),j=this.buildJoins(a),N=s?p` returning ${this.buildSelection(s,{isSingleTable:!o})}`:void 0,q=n?p` where ${n}`:void 0;return p`${l}update ${v} set ${T}${w}${j}${q}${N}`}buildSelection(e,{isSingleTable:t=!1}={}){let n=e.length,s=e.flatMap(({field:i},o)=>{let a=[];if(b(i,L.Aliased)&&i.isSelectionField)a.push(p.identifier(i.fieldAlias));else if(b(i,L.Aliased)||b(i,L)){let l=b(i,L.Aliased)?i.sql:i;t?a.push(new L(l.queryChunks.map(f=>b(f,C)?p.identifier(this.casing.getColumnCasing(f)):f))):a.push(l),b(i,L.Aliased)&&a.push(p` as ${p.identifier(i.fieldAlias)}`)}else b(i,ce)&&(t?a.push(p.identifier(this.casing.getColumnCasing(i))):a.push(i));return o<n-1&&a.push(p`, `),a});return p.join(s)}buildJoins(e){if(!e||e.length===0)return;let t=[];for(let[n,s]of e.entries()){n===0&&t.push(p` `);let i=s.table,o=s.lateral?p` lateral`:void 0;if(b(i,Ae)){let a=i[Ae.Symbol.Name],l=i[Ae.Symbol.Schema],f=i[Ae.Symbol.OriginalName],u=a===f?void 0:s.alias;t.push(p`${p.raw(s.joinType)} join${o} ${l?p`${p.identifier(l)}.`:void 0}${p.identifier(f)}${u&&p` ${p.identifier(u)}`} on ${s.on}`)}else if(b(i,Re)){let a=i[me].name,l=i[me].schema,f=i[me].originalName,u=a===f?void 0:s.alias;t.push(p`${p.raw(s.joinType)} join${o} ${l?p`${p.identifier(l)}.`:void 0}${p.identifier(f)}${u&&p` ${p.identifier(u)}`} on ${s.on}`)}else t.push(p`${p.raw(s.joinType)} join${o} ${i} on ${s.on}`);n<e.length-1&&t.push(p` `)}return p.join(t)}buildFromTable(e){if(b(e,P)&&e[P.Symbol.OriginalName]!==e[P.Symbol.Name]){let t=p`${p.identifier(e[P.Symbol.OriginalName])}`;return e[P.Symbol.Schema]&&(t=p`${p.identifier(e[P.Symbol.Schema])}.${t}`),p`${t} ${p.identifier(e[P.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:t,fieldsFlat:n,where:s,having:i,table:o,joins:a,orderBy:l,groupBy:f,limit:u,offset:y,lockingClause:h,distinct:v,setOperators:T}){let w=n??He(t);for(let ie of w)if(b(ie.field,ce)&&Be(ie.field.table)!==(b(o,Se)?o._.alias:b(o,pt)?o[me].name:b(o,L)?void 0:Be(o))&&!(pe=>a?.some(({alias:he})=>he===(pe[P.Symbol.IsAlias]?Be(pe):pe[P.Symbol.BaseName])))(ie.field.table)){let pe=Be(ie.field.table);throw new Error(`Your "${ie.path.join("->")}" field references a column "${pe}"."${ie.field.name}", but the table "${pe}" is not part of the query! Did you forget to join it?`)}let j=!a||a.length===0,N=this.buildWithCTE(e),q;v&&(q=v===!0?p` distinct`:p` distinct on (${p.join(v.on,p`, `)})`);let z=this.buildSelection(w,{isSingleTable:j}),I=this.buildFromTable(o),D=this.buildJoins(a),Y=s?p` where ${s}`:void 0,k=i?p` having ${i}`:void 0,F;l&&l.length>0&&(F=p` order by ${p.join(l,p`, `)}`);let Z;f&&f.length>0&&(Z=p` group by ${p.join(f,p`, `)}`);let S=typeof u=="object"||typeof u=="number"&&u>=0?p` limit ${u}`:void 0,G=y?p` offset ${y}`:void 0,U=p.empty();if(h){let ie=p` for ${p.raw(h.strength)}`;h.config.of&&ie.append(p` of ${p.join(Array.isArray(h.config.of)?h.config.of:[h.config.of],p`, `)}`),h.config.noWait?ie.append(p` no wait`):h.config.skipLocked&&ie.append(p` skip locked`),U.append(ie)}let W=p`${N}select${q} ${z} from ${I}${D}${Y}${Z}${k}${F}${S}${G}${U}`;return T.length>0?this.buildSetOperations(W,T):W}buildSetOperations(e,t){let[n,...s]=t;if(!n)throw new Error("Cannot pass undefined values to any set operator");return s.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),s)}buildSetOperationQuery({leftSelect:e,setOperator:{type:t,isAll:n,rightSelect:s,limit:i,orderBy:o,offset:a}}){let l=p`(${e.getSQL()}) `,f=p`(${s.getSQL()})`,u;if(o&&o.length>0){let T=[];for(let w of o)if(b(w,C))T.push(p.identifier(w.name));else if(b(w,L)){for(let j=0;j<w.queryChunks.length;j++){let N=w.queryChunks[j];b(N,C)&&(w.queryChunks[j]=p.identifier(N.name))}T.push(p`${w}`)}else T.push(p`${w}`);u=p` order by ${p.join(T,p`, `)} `}let y=typeof i=="object"||typeof i=="number"&&i>=0?p` limit ${i}`:void 0,h=p.raw(`${t} ${n?"all ":""}`),v=a?p` offset ${a}`:void 0;return p`${l}${h}${f}${u}${y}${v}`}buildInsertQuery({table:e,values:t,onConflict:n,returning:s,withList:i,select:o,overridingSystemValue_:a}){let l=[],f=e[P.Symbol.Columns],u=Object.entries(f).filter(([N,q])=>!q.shouldDisableInsert()),y=u.map(([,N])=>p.identifier(this.casing.getColumnCasing(N)));if(o){let N=t;b(N,L)?l.push(N):l.push(N.getSQL())}else{let N=t;l.push(p.raw("values "));for(let[q,z]of N.entries()){let I=[];for(let[D,Y]of u){let k=z[D];if(k===void 0||b(k,Qe)&&k.value===void 0)if(Y.defaultFn!==void 0){let F=Y.defaultFn(),Z=b(F,L)?F:p.param(F,Y);I.push(Z)}else if(!Y.default&&Y.onUpdateFn!==void 0){let F=Y.onUpdateFn(),Z=b(F,L)?F:p.param(F,Y);I.push(Z)}else I.push(p`default`);else I.push(k)}l.push(I),q<N.length-1&&l.push(p`, `)}}let h=this.buildWithCTE(i),v=p.join(l),T=s?p` returning ${this.buildSelection(s,{isSingleTable:!0})}`:void 0,w=n?p` on conflict ${n}`:void 0,j=a===!0?p`overriding system value `:void 0;return p`${h}insert into ${e} ${y} ${j}${v}${w}${T}`}buildRefreshMaterializedViewQuery({view:e,concurrently:t,withNoData:n}){let s=t?p` concurrently`:void 0,i=n?p` with no data`:void 0;return p`refresh materialized view${s} ${e}${i}`}prepareTyping(e){return b(e,Nr)||b(e,xr)?"json":b(e,Cr)?"decimal":b(e,Ar)?"time":b(e,Pr)||b(e,Er)?"timestamp":b(e,Sr)||b(e,Tr)?"date":b(e,Or)?"uuid":"none"}sqlToQuery(e,t){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:t})}buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:n,table:s,tableConfig:i,queryConfig:o,tableAlias:a,nestedQueryRelation:l,joinOn:f}){let u=[],y,h,v=[],T,w=[];if(o===!0)u=Object.entries(i.columns).map(([q,z])=>({dbKey:z.name,tsKey:q,field:dt(z,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let N=Object.fromEntries(Object.entries(i.columns).map(([k,F])=>[k,dt(F,a)]));if(o.where){let k=typeof o.where=="function"?o.where(N,al()):o.where;T=k&&mn(k,a)}let q=[],z=[];if(o.columns){let k=!1;for(let[F,Z]of Object.entries(o.columns))Z!==void 0&&F in i.columns&&(!k&&Z===!0&&(k=!0),z.push(F));z.length>0&&(z=k?z.filter(F=>o.columns?.[F]===!0):Object.keys(i.columns).filter(F=>!z.includes(F)))}else z=Object.keys(i.columns);for(let k of z){let F=i.columns[k];q.push({tsKey:k,value:F})}let I=[];o.with&&(I=Object.entries(o.with).filter(k=>!!k[1]).map(([k,F])=>({tsKey:k,queryConfig:F,relation:i.relations[k]})));let D;if(o.extras){D=typeof o.extras=="function"?o.extras(N,{sql:p}):o.extras;for(let[k,F]of Object.entries(D))q.push({tsKey:k,value:zo(F,a)})}for(let{tsKey:k,value:F}of q)u.push({dbKey:b(F,L.Aliased)?F.fieldAlias:i.columns[k].name,tsKey:k,field:b(F,ce)?dt(F,a):F,relationTableTsKey:void 0,isJson:!1,selection:[]});let Y=typeof o.orderBy=="function"?o.orderBy(N,cl()):o.orderBy??[];Array.isArray(Y)||(Y=[Y]),v=Y.map(k=>b(k,ce)?dt(k,a):mn(k,a)),y=o.limit,h=o.offset;for(let{tsKey:k,queryConfig:F,relation:Z}of I){let S=ul(t,n,Z),G=Vt(Z.referencedTable),U=n[G],W=`${a}_${k}`,ie=vn(...S.fields.map((ze,_)=>Zt(dt(S.references[_],W),dt(ze,a)))),pe=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:t,tableNamesMap:n,table:e[U],tableConfig:t[U],queryConfig:b(Z,_t)?F===!0?{limit:1}:{...F,limit:1}:F,tableAlias:W,joinOn:ie,nestedQueryRelation:Z}),he=p`${p.identifier(W)}.${p.identifier("data")}`.as(k);w.push({on:p`true`,table:new Se(pe.sql,{},W),alias:W,joinType:"left",lateral:!0}),u.push({dbKey:k,tsKey:k,field:he,relationTableTsKey:U,isJson:!0,selection:pe.selection})}}if(u.length===0)throw new _r({message:`No fields selected for table "${i.tsName}" ("${a}")`});let j;if(T=vn(f,T),l){let N=p`json_build_array(${p.join(u.map(({field:I,tsKey:D,isJson:Y})=>Y?p`${p.identifier(`${a}_${D}`)}.${p.identifier("data")}`:b(I,L.Aliased)?I.sql:I),p`, `)})`;b(l,$r)&&(N=p`coalesce(json_agg(${N}${v.length>0?p` order by ${p.join(v,p`, `)}`:void 0}), '[]'::json)`);let q=[{dbKey:"data",tsKey:"data",field:N.as("data"),isJson:!0,relationTableTsKey:i.tsName,selection:u}];y!==void 0||h!==void 0||v.length>0?(j=this.buildSelectQuery({table:dn(s,a),fields:{},fieldsFlat:[{path:[],field:p.raw("*")}],where:T,limit:y,offset:h,orderBy:v,setOperators:[]}),T=void 0,y=void 0,h=void 0,v=[]):j=dn(s,a),j=this.buildSelectQuery({table:b(j,Ae)?j:new Se(j,{},a),fields:{},fieldsFlat:q.map(({field:I})=>({path:[],field:b(I,ce)?dt(I,a):I})),joins:w,where:T,limit:y,offset:h,orderBy:v,setOperators:[]})}else j=this.buildSelectQuery({table:dn(s,a),fields:{},fieldsFlat:u.map(({field:N})=>({path:[],field:b(N,ce)?dt(N,a):N})),joins:w,where:T,limit:y,offset:h,orderBy:v,setOperators:[]});return{tableTsKey:i.tsName,sql:j,selection:u}}};Fp=d,c(St,Fp,"PgDialect");var Qp,Sn=class{getSelectedFields(){return this._.selectedFields}};Qp=d,c(Sn,Qp,"TypedQueryBuilder");var Wp,$e=class{constructor(e){c(this,"fields");c(this,"session");c(this,"dialect");c(this,"withList",[]);c(this,"distinct");c(this,"authToken");this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}setToken(e){return this.authToken=e,this}from(e){let t=!!this.fields,n=e,s;return this.fields?s=this.fields:b(n,Se)?s=Object.fromEntries(Object.keys(n._.selectedFields).map(i=>[i,n[i]])):b(n,pt)?s=n[me].selectedFields:b(n,L)?s={}:s=hn(n),new Tn({table:n,fields:s,isPartialSelect:t,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}};Wp=d,c($e,Wp,"PgSelectBuilder");var Jp,Oi=class extends Sn{constructor({table:t,fields:n,isPartialSelect:s,session:i,dialect:o,withList:a,distinct:l}){super();c(this,"_");c(this,"config");c(this,"joinsNotNullableMap");c(this,"tableName");c(this,"isPartialSelect");c(this,"session");c(this,"dialect");c(this,"leftJoin",this.createJoin("left"));c(this,"rightJoin",this.createJoin("right"));c(this,"innerJoin",this.createJoin("inner"));c(this,"fullJoin",this.createJoin("full"));c(this,"union",this.createSetOperator("union",!1));c(this,"unionAll",this.createSetOperator("union",!0));c(this,"intersect",this.createSetOperator("intersect",!1));c(this,"intersectAll",this.createSetOperator("intersect",!0));c(this,"except",this.createSetOperator("except",!1));c(this,"exceptAll",this.createSetOperator("except",!0));this.config={withList:a,table:t,fields:{...n},distinct:l,setOperators:[]},this.isPartialSelect=s,this.session=i,this.dialect=o,this._={selectedFields:n},this.tableName=vt(t),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(t){return(n,s)=>{let i=this.tableName,o=vt(n);if(typeof o=="string"&&this.config.joins?.some(a=>a.alias===o))throw new Error(`Alias "${o}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof i=="string"&&(this.config.fields={[i]:this.config.fields}),typeof o=="string"&&!b(n,L))){let a=b(n,Se)?n._.selectedFields:b(n,Re)?n[me].selectedFields:n[P.Symbol.Columns];this.config.fields[o]=a}if(typeof s=="function"&&(s=s(new Proxy(this.config.fields,new ae({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:s,table:n,joinType:t,alias:o}),typeof o=="string")switch(t){case"left":{this.joinsNotNullableMap[o]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[o]=!0;break}case"inner":{this.joinsNotNullableMap[o]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[o]=!1;break}}return this}}createSetOperator(t,n){return s=>{let i=typeof s=="function"?s(qp()):s;if(!pn(this.getSelectedFields(),i.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:t,isAll:n,rightSelect:i}),this}}addSetOperators(t){return this.config.setOperators.push(...t),this}where(t){return typeof t=="function"&&(t=t(new Proxy(this.config.fields,new ae({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=t,this}having(t){return typeof t=="function"&&(t=t(new Proxy(this.config.fields,new ae({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=t,this}groupBy(...t){if(typeof t[0]=="function"){let n=t[0](new Proxy(this.config.fields,new ae({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(n)?n:[n]}else this.config.groupBy=t;return this}orderBy(...t){if(typeof t[0]=="function"){let n=t[0](new Proxy(this.config.fields,new ae({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),s=Array.isArray(n)?n:[n];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=s:this.config.orderBy=s}else{let n=t;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}return this}limit(t){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=t:this.config.limit=t,this}offset(t){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=t:this.config.offset=t,this}for(t,n={}){return this.config.lockingClause={strength:t,config:n},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}as(t){return new Proxy(new Se(this.getSQL(),this.config.fields,t),new ae({alias:t,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new ae({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}};Jp=d,c(Oi,Jp,"PgSelectQueryBuilder");var Hp,Tn=class extends Oi{constructor(){super(...arguments);c(this,"authToken");c(this,"execute",t=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(t,this.authToken)))}_prepare(t){let{session:n,config:s,dialect:i,joinsNotNullableMap:o,authToken:a}=this;if(!n)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return ue.startActiveSpan("drizzle.prepareQuery",()=>{let l=He(s.fields),f=n.prepareQuery(i.sqlToQuery(this.getSQL()),l,t,!0);return f.joinsNotNullableMap=o,f.setToken(a)})}prepare(t){return this._prepare(t)}setToken(t){return this.authToken=t,this}};Hp=d,c(Tn,Hp,"PgSelect");oc(Tn,[ke]);function Ir(r,e){return(t,n,...s)=>{let i=[n,...s].map(o=>({type:r,isAll:e,rightSelect:o}));for(let o of i)if(!pn(t.getSelectedFields(),o.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return t.addSetOperators(i)}}var qp=()=>({union:Bp,unionAll:Up,intersect:Vp,intersectAll:Kp,except:Zp,exceptAll:Gp}),Bp=Ir("union",!1),Up=Ir("union",!0),Vp=Ir("intersect",!1),Kp=Ir("intersect",!0),Zp=Ir("except",!1),Gp=Ir("except",!0);var Yp,ht=class{constructor(e){c(this,"dialect");c(this,"dialectConfig");c(this,"$with",(e,t)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(n)),new Proxy(new Ut(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new ae({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}});this.dialect=b(e,St)?e:void 0,this.dialectConfig=b(e,St)?void 0:e}with(...e){let t=this;function n(o){return new $e({fields:o??void 0,session:void 0,dialect:t.getDialect(),withList:e})}function s(o){return new $e({fields:o??void 0,session:void 0,dialect:t.getDialect(),distinct:!0})}function i(o,a){return new $e({fields:a??void 0,session:void 0,dialect:t.getDialect(),distinct:{on:o}})}return{select:n,selectDistinct:s,selectDistinctOn:i}}select(e){return new $e({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new $e({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,t){return new $e({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new St(this.dialectConfig)),this.dialect}};Yp=d,c(ht,Yp,"PgQueryBuilder");var Xp,Mr=class{constructor(e,t,n,s,i){c(this,"authToken");this.table=e,this.session=t,this.dialect=n,this.withList=s,this.overridingSystemValue_=i}setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");let t=e.map(n=>{let s={},i=this.table[P.Symbol.Columns];for(let o of Object.keys(n)){let a=n[o];s[o]=b(a,L)?a:new Qe(a,i[o])}return s});return new xn(this.table,t,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){let t=typeof e=="function"?e(new ht):e;if(!b(t,L)&&!pn(this.table[ls],t._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new xn(this.table,t,this.session,this.dialect,this.withList,!0)}};Xp=d,c(Mr,Xp,"PgInsertBuilder");var eh,xn=class extends ke{constructor(t,n,s,i,o,a,l){super();c(this,"config");c(this,"authToken");c(this,"execute",t=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(t,this.authToken)));this.session=s,this.dialect=i,this.config={table:t,values:n,withList:o,select:a,overridingSystemValue_:l}}returning(t=this.config.table[P.Symbol.Columns]){return this.config.returningFields=t,this.config.returning=He(t),this}onConflictDoNothing(t={}){if(t.target===void 0)this.config.onConflict=p`do nothing`;else{let n="";n=Array.isArray(t.target)?t.target.map(i=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(i))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(t.target));let s=t.where?p` where ${t.where}`:void 0;this.config.onConflict=p`(${p.raw(n)})${s} do nothing`}return this}onConflictDoUpdate(t){if(t.where&&(t.targetWhere||t.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let n=t.where?p` where ${t.where}`:void 0,s=t.targetWhere?p` where ${t.targetWhere}`:void 0,i=t.setWhere?p` where ${t.setWhere}`:void 0,o=this.dialect.buildUpdateSet(this.config.table,us(this.config.table,t.set)),a="";return a=Array.isArray(t.target)?t.target.map(l=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(l))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(t.target)),this.config.onConflict=p`(${p.raw(a)})${s} do update set ${o}${n}${i}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(t){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,t,!0))}prepare(t){return this._prepare(t)}setToken(t){return this.authToken=t,this}getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new ae({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};eh=d,c(xn,eh,"PgInsert");var th,Nn=class extends ke{constructor(t,n,s){super();c(this,"config");c(this,"authToken");c(this,"execute",t=>ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(t,this.authToken)));this.session=n,this.dialect=s,this.config={view:t}}concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(t){return ue.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,t,!0))}prepare(t){return this._prepare(t)}setToken(t){return this.authToken=t,this}};th=d,c(Nn,th,"PgRefreshMaterializedView");var rh,Lr=class{constructor(e,t,n,s){c(this,"authToken");this.table=e,this.session=t,this.dialect=n,this.withList=s}setToken(e){return this.authToken=e,this}set(e){return new ki(this.table,us(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}};rh=d,c(Lr,rh,"PgUpdateBuilder");var nh,ki=class extends ke{constructor(t,n,s,i,o){super();c(this,"config");c(this,"tableName");c(this,"joinsNotNullableMap");c(this,"leftJoin",this.createJoin("left"));c(this,"rightJoin",this.createJoin("right"));c(this,"innerJoin",this.createJoin("inner"));c(this,"fullJoin",this.createJoin("full"));c(this,"authToken");c(this,"execute",t=>this._prepare().execute(t,this.authToken));this.session=s,this.dialect=i,this.config={set:n,table:t,withList:o,joins:[]},this.tableName=vt(t),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}from(t){let n=t,s=vt(n);return typeof s=="string"&&(this.joinsNotNullableMap[s]=!0),this.config.from=n,this}getTableLikeFields(t){return b(t,Ae)?t[P.Symbol.Columns]:b(t,Se)?t._.selectedFields:t[me].selectedFields}createJoin(t){return(n,s)=>{let i=vt(n);if(typeof i=="string"&&this.config.joins.some(o=>o.alias===i))throw new Error(`Alias "${i}" is already used in this query`);if(typeof s=="function"){let o=this.config.from&&!b(this.config.from,L)?this.getTableLikeFields(this.config.from):void 0;s=s(new Proxy(this.config.table[P.Symbol.Columns],new ae({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),o&&new Proxy(o,new ae({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:s,table:n,joinType:t,alias:i}),typeof i=="string")switch(t){case"left":{this.joinsNotNullableMap[i]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[i]=!0;break}case"inner":{this.joinsNotNullableMap[i]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([o])=>[o,!1])),this.joinsNotNullableMap[i]=!1;break}}return this}}where(t){return this.config.where=t,this}returning(t){if(!t&&(t=Object.assign({},this.config.table[P.Symbol.Columns]),this.config.from)){let n=vt(this.config.from);if(typeof n=="string"&&this.config.from&&!b(this.config.from,L)){let s=this.getTableLikeFields(this.config.from);t[n]=s}for(let s of this.config.joins){let i=vt(s.table);if(typeof i=="string"&&!b(s.table,L)){let o=this.getTableLikeFields(s.table);t[i]=o}}}return this.config.returningFields=t,this.config.returning=He(t),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(t){let n=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,t,!0);return n.joinsNotNullableMap=this.joinsNotNullableMap,n}prepare(t){return this._prepare(t)}setToken(t){return this.authToken=t,this}getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new ae({alias:Be(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}};nh=d,c(ki,nh,"PgUpdate");var sh,ih,$i=class extends L{constructor(t){super($i.buildEmbeddedCount(t.source,t.filters).queryChunks);c(this,"sql");c(this,"token");c(this,ih,"PgCountBuilder");c(this,"session");this.params=t,this.mapWith(Number),this.session=t.session,this.sql=$i.buildCount(t.source,t.filters)}static buildEmbeddedCount(t,n){return p`(select count(*) from ${t}${p.raw(" where ").if(n)}${n})`}static buildCount(t,n){return p`select count(*) as count from ${t}${p.raw(" where ").if(n)}${n};`}setToken(t){return this.token=t,this}then(t,n){return Promise.resolve(this.session.count(this.sql,this.token)).then(t,n)}catch(t){return this.then(void 0,t)}finally(t){return this.then(n=>(t?.(),n),n=>{throw t?.(),n})}},Cn=$i;sh=d,ih=Symbol.toStringTag,c(Cn,sh,"PgCountBuilder");var oh,An=class{constructor(e,t,n,s,i,o,a){this.fullSchema=e,this.schema=t,this.tableNamesMap=n,this.table=s,this.tableConfig=i,this.dialect=o,this.session=a}findMany(e){return new Pn(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new Pn(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}};oh=d,c(An,oh,"PgRelationalQueryBuilder");var ah,Pn=class extends ke{constructor(t,n,s,i,o,a,l,f,u){super();c(this,"authToken");this.fullSchema=t,this.schema=n,this.tableNamesMap=s,this.table=i,this.tableConfig=o,this.dialect=a,this.session=l,this.config=f,this.mode=u}_prepare(t){return ue.startActiveSpan("drizzle.prepareQuery",()=>{let{query:n,builtQuery:s}=this._toSQL();return this.session.prepareQuery(s,void 0,t,!0,(i,o)=>{let a=i.map(l=>Ei(this.schema,this.tableConfig,l,n.selection,o));return this.mode==="first"?a[0]:a})})}prepare(t){return this._prepare(t)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let t=this._getQuery(),n=this.dialect.sqlToQuery(t.sql);return{query:t,builtQuery:n}}toSQL(){return this._toSQL().builtQuery}setToken(t){return this.authToken=t,this}execute(){return ue.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}};ah=d,c(Pn,ah,"PgRelationalQuery");var ch,En=class extends ke{constructor(e,t,n,s){super(),this.execute=e,this.sql=t,this.query=n,this.mapBatchResult=s}getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,t){return t?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}};ch=d,c(En,ch,"PgRaw");var lh,Gt=class{constructor(e,t,n){c(this,"query");c(this,"$with",(e,t)=>{let n=this;return{as:i=>(typeof i=="function"&&(i=i(new ht(n.dialect))),new Proxy(new Ut(i.getSQL(),t??("getSelectedFields"in i?i.getSelectedFields()??{}:{}),e,!0),new ae({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}});c(this,"authToken");if(this.dialect=e,this.session=t,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:t}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:t},this.query={},this._.schema)for(let[s,i]of Object.entries(this._.schema))this.query[s]=new An(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[s],i,e,t)}$count(e,t){return new Cn({source:e,filters:t,session:this.session})}with(...e){let t=this;function n(f){return new $e({fields:f??void 0,session:t.session,dialect:t.dialect,withList:e})}function s(f){return new $e({fields:f??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:!0})}function i(f,u){return new $e({fields:u??void 0,session:t.session,dialect:t.dialect,withList:e,distinct:{on:f}})}function o(f){return new Lr(f,t.session,t.dialect,e)}function a(f){return new Mr(f,t.session,t.dialect,e)}function l(f){return new vr(f,t.session,t.dialect,e)}return{select:n,selectDistinct:s,selectDistinctOn:i,update:o,insert:a,delete:l}}select(e){return new $e({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new $e({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,t){return new $e({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new Lr(e,this.session,this.dialect)}insert(e){return new Mr(e,this.session,this.dialect)}delete(e){return new vr(e,this.session,this.dialect)}refreshMaterializedView(e){return new Nn(e,this.session,this.dialect)}execute(e){let t=typeof e=="string"?p.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(t),s=this.session.prepareQuery(n,void 0,void 0,!1);return new En(()=>s.execute(void 0,this.authToken),t,n,i=>s.mapResult(i,!0))}transaction(e,t){return this.session.transaction(e,t)}};lh=d,c(Gt,lh,"PgDatabase");var uh,Ii=class{constructor(e,t,n){this.seqName=e,this.seqOptions=t,this.schema=n}};uh=d,c(Ii,uh,"PgSequence");function dl(r,e,t){return new Ii(r,e,t)}var Go=Symbol.for("drizzle:PgViewConfig");var fh,On=class{constructor(e,t){c(this,"config",{});this.name=e,this.schema=t}with(e){return this.config.with=e,this}};fh=d,c(On,fh,"PgDefaultViewBuilderCore");var dh,Mi=class extends On{as(e){typeof e=="function"&&(e=e(new ht));let t=new ae({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),n=new Proxy(e.getSelectedFields(),t);return new Proxy(new jr({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:n,query:e.getSQL().inlineParams()}}),t)}};dh=d,c(Mi,dh,"PgViewBuilder");var mh,Li=class extends On{constructor(t,n,s){super(t,s);c(this,"columns");this.columns=hn(Vo(t,n))}existing(){return new Proxy(new jr({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new ae({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(t){return new Proxy(new jr({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:t.inlineParams()}}),new ae({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};mh=d,c(Li,mh,"PgManualViewBuilder");var ph,kn=class{constructor(e,t){c(this,"config",{});this.name=e,this.schema=t}using(e){return this.config.using=e,this}with(e){return this.config.with=e,this}tablespace(e){return this.config.tablespace=e,this}withNoData(){return this.config.withNoData=!0,this}};ph=d,c(kn,ph,"PgMaterializedViewBuilderCore");var hh,ji=class extends kn{as(e){typeof e=="function"&&(e=e(new ht));let t=new ae({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),n=new Proxy(e.getSelectedFields(),t);return new Proxy(new Dr({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:n,query:e.getSQL().inlineParams()}}),t)}};hh=d,c(ji,hh,"PgMaterializedViewBuilder");var gh,Di=class extends kn{constructor(t,n,s){super(t,s);c(this,"columns");this.columns=hn(Vo(t,n))}existing(){return new Proxy(new Dr({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new ae({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(t){return new Proxy(new Dr({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:t.inlineParams()}}),new ae({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}};gh=d,c(Di,gh,"PgManualMaterializedViewBuilder");var yh,bh,jr=class extends pt{constructor({pgConfig:t,config:n}){super(n);c(this,bh);t&&(this[Go]={with:t.with})}};yh=d,bh=Go,c(jr,yh,"PgView");var ml=Symbol.for("drizzle:PgMaterializedViewConfig"),wh,vh,Dr=class extends pt{constructor({pgConfig:t,config:n}){super(n);c(this,vh);this[ml]={with:t?.with,using:t?.using,tablespace:t?.tablespace,withNoData:t?.withNoData}}};wh=d,vh=ml,c(Dr,wh,"PgMaterializedView");function pl(r,e,t){return e?new Li(r,e,t):new Mi(r,t)}function hl(r,e,t){return e?new Di(r,e,t):new ji(r,t)}var _h,Ri=class{constructor(e){c(this,"table",(e,t,n)=>Uo(e,t,n,this.schemaName));c(this,"view",(e,t)=>pl(e,t,this.schemaName));c(this,"materializedView",(e,t)=>hl(e,t,this.schemaName));c(this,"enum",(e,t)=>Ya(e,t,this.schemaName));c(this,"sequence",(e,t)=>dl(e,t,this.schemaName));this.schemaName=e}getSQL(){return new L([p.identifier(this.schemaName)])}shouldOmitSQLParens(){return!0}};_h=d,c(Ri,_h,"PgSchema");function gl(r){if(r==="public")throw new Error("You can't specify 'public' as schema name. Postgres is using public schema by default. If you want to use 'public' schema, just use pgTable() instead of creating a schema");return new Ri(r)}var Sh,$n=class{constructor(e){c(this,"authToken");c(this,"joinsNotNullableMap");this.query=e}getQuery(){return this.query}mapResult(e,t){return e}setToken(e){return this.authToken=e,this}};Sh=d,c($n,Sh,"PgPreparedQuery");var Th,In=class{constructor(e){this.dialect=e}execute(e,t){return ue.startActiveSpan("drizzle.operation",()=>ue.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(t).execute(void 0,t))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,t){let n=await this.execute(e,t);return Number(n[0].count)}};Th=d,c(In,Th,"PgSession");var xh,Mn=class extends Gt{constructor(e,t,n,s=0){super(e,t,n),this.schema=n,this.nestedIndex=s}rollback(){throw new yn}getTransactionConfigSQL(e){let t=[];return e.isolationLevel&&t.push(`isolation level ${e.isolationLevel}`),e.accessMode&&t.push(e.accessMode),typeof e.deferrable=="boolean"&&t.push(e.deferrable?"deferrable":"not deferrable"),p.raw(t.join(" "))}setTransaction(e){return this.session.execute(p`set transaction ${this.getTransactionConfigSQL(e)}`)}};xh=d,c(Mn,xh,"PgTransaction");var Nh,zi=class extends $n{constructor(e,t,n,s,i,o,a){super({sql:t,params:n}),this.client=e,this.queryString=t,this.params=n,this.logger=s,this.fields=i,this._isResponseInArrayMode=o,this.customResultMapper=a}async execute(e={}){return ue.startActiveSpan("drizzle.execute",async t=>{let n=Do(this.params,e);t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.logger.logQuery(this.queryString,n);let{fields:s,queryString:i,client:o,joinsNotNullableMap:a,customResultMapper:l}=this;if(!s&&!l)return ue.startActiveSpan("drizzle.driver.execute",()=>o.unsafe(i,n));let f=await ue.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":i,"drizzle.query.params":JSON.stringify(n)}),o.unsafe(i,n).values()));return ue.startActiveSpan("drizzle.mapResponse",()=>l?l(f):f.map(u=>ic(s,u,a)))})}all(e={}){return ue.startActiveSpan("drizzle.execute",async t=>{let n=Do(this.params,e);return t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.logger.logQuery(this.queryString,n),ue.startActiveSpan("drizzle.driver.execute",()=>(t?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(n)}),this.client.unsafe(this.queryString,n)))})}isResponseInArrayMode(){return this._isResponseInArrayMode}};Nh=d,c(zi,Nh,"PostgresJsPreparedQuery");var Ch,Wo=class extends In{constructor(t,n,s,i={}){super(n);c(this,"logger");this.client=t,this.schema=s,this.options=i,this.logger=i.logger??new cn}prepareQuery(t,n,s,i,o){return new zi(this.client,t.sql,t.params,this.logger,n,i,o)}query(t,n){return this.logger.logQuery(t,n),this.client.unsafe(t,n).values()}queryObjects(t,n){return this.client.unsafe(t,n)}transaction(t,n){return this.client.begin(async s=>{let i=new Wo(s,this.dialect,this.schema,this.options),o=new Fi(this.dialect,i,this.schema);return n&&await o.setTransaction(n),t(o)})}},Rr=Wo;Ch=d,c(Rr,Ch,"PostgresJsSession");var Ah,Jo=class extends Mn{constructor(e,t,n,s=0){super(e,t,n,s),this.session=t}transaction(e){return this.session.client.savepoint(t=>{let n=new Rr(t,this.dialect,this.schema,this.session.options),s=new Jo(this.dialect,n,this.schema);return e(s)})}},Fi=Jo;Ah=d,c(Fi,Ah,"PostgresJsTransaction");var Ph,Qi=class extends Gt{};Ph=d,c(Qi,Ph,"PostgresJsDatabase");function zr(r,e={}){let t=l=>l;for(let l of["1184","1082","1083","1114"])r.options.parsers[l]=t,r.options.serializers[l]=t;r.options.serializers[114]=t,r.options.serializers[3802]=t;let n=new St({casing:e.casing}),s;e.logger===!0?s=new an:e.logger!==!1&&(s=e.logger);let i;if(e.schema){let l=ll(e.schema,fl);i={fullSchema:e.schema,schema:l.tables,tableNamesMap:l.tableNamesMap}}let o=new Rr(r,n,i,{logger:s}),a=new Qi(n,o,i);return a.$client=r,a}function qi(...r){if(typeof r[0]=="string"){let e=yr(r[0]);return zr(e,r[1])}if(ac(r[0])){let{connection:e,client:t,...n}=r[0];if(t)return zr(t,n);if(typeof e=="object"&&e.url!==void 0){let{url:i,...o}=e,a=yr(i,o);return zr(a,n)}let s=yr(e);return zr(s,n)}return zr(r[0],r[1])}(r=>{function e(t){return zr({options:{parsers:{},serializers:{}}},t)}r.mock=e})(qi||(qi={}));var Jt=Je(ca(),1),xt=Je(Hl(),1);function pg(){xt.PojosMetadataMap.create("Listing",{id:String,title:String,price:Number,purchaseType:String,sellerId:String}),xt.PojosMetadataMap.create("ListingApiQuery",{searchTitle:String,condition:String,proximityMiles:String,searchMatchMode:String}),xt.PojosMetadataMap.create("ListingApiQueryUnstructured",{searchTitle:String,condition:String,proximityMiles:String,searchMatchMode:String}),xt.PojosMetadataMap.create("ListingOutputDto",{id:String,title:String,price:Number,purchaseType:String,sellerId:String}),xt.PojosMetadataMap.create("ListingInputDto",{title:String,price:Number,purchaseType:String,sellerId:String}),xt.PojosMetadataMap.create("ListingTable",{id:String,title:String,price:Number,purchaseType:String,sellerId:String})}pg();var Ye=(0,Jt.createMapper)({strategyInitializer:(0,xt.pojos)()});(0,Jt.createMap)(Ye,"Listing","ListingOutputDto");(0,Jt.createMap)(Ye,"ListingInputDto","Listing");(0,Jt.createMap)(Ye,"ListingTable","Listing");(0,Jt.createMap)(Ye,"ListingApiQueryUnstructured","ListingApiQuery");var hg=gl("listing_service"),qr=hg.table("listings",{title:kr().notNull(),sellerId:bn("seller_id").notNull(),purchaseType:kr("purchase_type").default("SALE"),id:bn("id").defaultRandom().primaryKey(),price:xc().notNull(),condition:kr()});var Wi=class{constructor(e,t){this._dbClient=e;this._mapper=t}async create(e){let[t]=await this._dbClient.insert(qr).values(e).returning();return this._mapper.map(t,"ListingTable","Listing")}async getAllByQuery(e){let t=this._dbClient.select().from(qr).where(Zt(qr.condition,"NEW")).$dynamic();console.log(e),e.searchTitle&&(e.searchMatchMode==="FUZZY"?t.where(Ai(qr.title,`%${e.searchTitle}%`)):t.where(Zt(qr.title,e.searchTitle)));let n=await t;if(!n.length)throw new Error("no listings found matching filters");return n.map(s=>this._mapper.map(s,"ListingTable","Listing"))}};var ne;(function(r){r.assertEqual=s=>s;function e(s){}r.assertIs=e;function t(s){throw new Error}r.assertNever=t,r.arrayToEnum=s=>{let i={};for(let o of s)i[o]=o;return i},r.getValidEnumValues=s=>{let i=r.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(let a of i)o[a]=s[a];return r.objectValues(o)},r.objectValues=s=>r.objectKeys(s).map(function(i){return s[i]}),r.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{let i=[];for(let o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},r.find=(s,i)=>{for(let o of s)if(i(o))return o},r.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}r.joinValues=n,r.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(ne||(ne={}));var fa;(function(r){r.mergeShapes=(e,t)=>({...e,...t})})(fa||(fa={}));var O=ne.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ct=r=>{switch(typeof r){case"undefined":return O.undefined;case"string":return O.string;case"number":return isNaN(r)?O.nan:O.number;case"boolean":return O.boolean;case"function":return O.function;case"bigint":return O.bigint;case"symbol":return O.symbol;case"object":return Array.isArray(r)?O.array:r===null?O.null:r.then&&typeof r.then=="function"&&r.catch&&typeof r.catch=="function"?O.promise:typeof Map<"u"&&r instanceof Map?O.map:typeof Set<"u"&&r instanceof Set?O.set:typeof Date<"u"&&r instanceof Date?O.date:O.object;default:return O.unknown}},x=ne.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),gg=r=>JSON.stringify(r,null,2).replace(/"([^"]+)":/g,"$1:"),xe=class extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(i){return i.message},n={_errors:[]},s=i=>{for(let o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(t(o));else{let a=n,l=0;for(;l<o.path.length;){let f=o.path[l];l===o.path.length-1?(a[f]=a[f]||{_errors:[]},a[f]._errors.push(t(o))):a[f]=a[f]||{_errors:[]},a=a[f],l++}}};return s(this),n}static assert(e){if(!(e instanceof xe))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ne.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){let t={},n=[];for(let s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}};xe.create=r=>new xe(r);var Vr=(r,e)=>{let t;switch(r.code){case x.invalid_type:r.received===O.undefined?t="Required":t=`Expected ${r.expected}, received ${r.received}`;break;case x.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(r.expected,ne.jsonStringifyReplacer)}`;break;case x.unrecognized_keys:t=`Unrecognized key(s) in object: ${ne.joinValues(r.keys,", ")}`;break;case x.invalid_union:t="Invalid input";break;case x.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${ne.joinValues(r.options)}`;break;case x.invalid_enum_value:t=`Invalid enum value. Expected ${ne.joinValues(r.options)}, received '${r.received}'`;break;case x.invalid_arguments:t="Invalid function arguments";break;case x.invalid_return_type:t="Invalid function return type";break;case x.invalid_date:t="Invalid date";break;case x.invalid_string:typeof r.validation=="object"?"includes"in r.validation?(t=`Invalid input: must include "${r.validation.includes}"`,typeof r.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${r.validation.position}`)):"startsWith"in r.validation?t=`Invalid input: must start with "${r.validation.startsWith}"`:"endsWith"in r.validation?t=`Invalid input: must end with "${r.validation.endsWith}"`:ne.assertNever(r.validation):r.validation!=="regex"?t=`Invalid ${r.validation}`:t="Invalid";break;case x.too_small:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at least":"more than"} ${r.minimum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at least":"over"} ${r.minimum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${r.minimum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly equal to ":r.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(r.minimum))}`:t="Invalid input";break;case x.too_big:r.type==="array"?t=`Array must contain ${r.exact?"exactly":r.inclusive?"at most":"less than"} ${r.maximum} element(s)`:r.type==="string"?t=`String must contain ${r.exact?"exactly":r.inclusive?"at most":"under"} ${r.maximum} character(s)`:r.type==="number"?t=`Number must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="bigint"?t=`BigInt must be ${r.exact?"exactly":r.inclusive?"less than or equal to":"less than"} ${r.maximum}`:r.type==="date"?t=`Date must be ${r.exact?"exactly":r.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(r.maximum))}`:t="Invalid input";break;case x.custom:t="Invalid input";break;case x.invalid_intersection_types:t="Intersection results could not be merged";break;case x.not_multiple_of:t=`Number must be a multiple of ${r.multipleOf}`;break;case x.not_finite:t="Number must be finite";break;default:t=e.defaultError,ne.assertNever(r)}return{message:t}},tu=Vr;function yg(r){tu=r}function Ji(){return tu}var Hi=r=>{let{data:e,path:t,errorMaps:n,issueData:s}=r,i=[...t,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let a="",l=n.filter(f=>!!f).slice().reverse();for(let f of l)a=f(o,{data:e,defaultError:a}).message;return{...s,path:i,message:a}},bg=[];function E(r,e){let t=Ji(),n=Hi({issueData:e,data:r.data,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,t,t===Vr?void 0:Vr].filter(s=>!!s)});r.common.issues.push(n)}var Ee=class{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){let n=[];for(let s of t){if(s.status==="aborted")return K;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){let n=[];for(let s of t){let i=await s.key,o=await s.value;n.push({key:i,value:o})}return Ee.mergeObjectSync(e,n)}static mergeObjectSync(e,t){let n={};for(let s of t){let{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return K;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}},K=Object.freeze({status:"aborted"}),Ur=r=>({status:"dirty",value:r}),qe=r=>({status:"valid",value:r}),da=r=>r.status==="aborted",ma=r=>r.status==="dirty",Ht=r=>r.status==="valid",Rn=r=>typeof Promise<"u"&&r instanceof Promise;function Yi(r,e,t,n){if(t==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?r!==e||!n:!e.has(r))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?n:t==="a"?n.call(r):n?n.value:e.get(r)}function ru(r,e,t,n,s){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?r!==e||!s:!e.has(r))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?s.call(r,t):s?s.value=t:e.set(r,t),t}var R;(function(r){r.errToObj=e=>typeof e=="string"?{message:e}:e||{},r.toString=e=>typeof e=="string"?e:e?.message})(R||(R={}));var jn,Dn,et=class{constructor(e,t,n,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Yl=(r,e)=>{if(Ht(e))return{success:!0,data:e.value};if(!r.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new xe(r.common.issues);return this._error=t,this._error}}};function J(r){if(!r)return{};let{errorMap:e,invalid_type_error:t,required_error:n,description:s}=r;if(e&&(t||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>{var l,f;let{message:u}=r;return o.code==="invalid_enum_value"?{message:u??a.defaultError}:typeof a.data>"u"?{message:(l=u??n)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(f=u??t)!==null&&f!==void 0?f:a.defaultError}},description:s}}var H=class{get description(){return this._def.description}_getType(e){return Ct(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ct(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ee,ctx:{common:e.parent.common,data:e.data,parsedType:Ct(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(Rn(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){let t=this._parse(e);return Promise.resolve(t)}parse(e,t){let n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;let s={common:{issues:[],async:(n=t?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ct(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Yl(s,i)}"~validate"(e){var t,n;let s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ct(e)};if(!this["~standard"].async)try{let i=this._parseSync({data:e,path:[],parent:s});return Ht(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((n=(t=i?.message)===null||t===void 0?void 0:t.toLowerCase())===null||n===void 0)&&n.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(i=>Ht(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(e,t){let n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){let n={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ct(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(Rn(s)?s:Promise.resolve(s));return Yl(n,i)}refine(e,t){let n=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{let o=e(s),a=()=>i.addIssue({code:x.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,t){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof t=="function"?t(n,s):t),!1))}_refinement(e){return new We({schema:this,typeName:V.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Xe.create(this,this._def)}nullable(){return wt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ge.create(this)}promise(){return zt.create(this,this._def)}or(e){return tr.create([this,e],this._def)}and(e){return rr.create(this,e,this._def)}transform(e){return new We({...J(this._def),schema:this,typeName:V.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let t=typeof e=="function"?e:()=>e;return new ar({...J(this._def),innerType:this,defaultValue:t,typeName:V.ZodDefault})}brand(){return new zn({typeName:V.ZodBranded,type:this,...J(this._def)})}catch(e){let t=typeof e=="function"?e:()=>e;return new cr({...J(this._def),innerType:this,catchValue:t,typeName:V.ZodCatch})}describe(e){let t=this.constructor;return new t({...this._def,description:e})}pipe(e){return lr.create(this,e)}readonly(){return ur.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},wg=/^c[^\s-]{8,}$/i,vg=/^[0-9a-z]+$/,_g=/^[0-9A-HJKMNP-TV-Z]{26}$/i,Sg=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Tg=/^[a-z0-9_-]{21}$/i,xg=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,Ng=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Cg=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Ag="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",ua,Pg=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Eg=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,Og=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,kg=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,$g=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ig=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nu="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Mg=new RegExp(`^${nu}$`);function su(r){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return r.precision?e=`${e}\\.\\d{${r.precision}}`:r.precision==null&&(e=`${e}(\\.\\d+)?`),e}function Lg(r){return new RegExp(`^${su(r)}$`)}function iu(r){let e=`${nu}T${su(r)}`,t=[];return t.push(r.local?"Z?":"Z"),r.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function jg(r,e){return!!((e==="v4"||!e)&&Pg.test(r)||(e==="v6"||!e)&&Og.test(r))}function Dg(r,e){if(!xg.test(r))return!1;try{let[t]=r.split("."),n=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(n));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function Rg(r,e){return!!((e==="v4"||!e)&&Eg.test(r)||(e==="v6"||!e)&&kg.test(r))}var Ze=class extends H{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==O.string){let i=this._getOrReturnCtx(e);return E(i,{code:x.invalid_type,expected:O.string,received:i.parsedType}),K}let n=new Ee,s;for(let i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:x.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:x.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){let o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?E(s,{code:x.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&E(s,{code:x.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")Cg.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"email",code:x.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")ua||(ua=new RegExp(Ag,"u")),ua.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"emoji",code:x.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")Sg.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"uuid",code:x.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")Tg.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"nanoid",code:x.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")wg.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cuid",code:x.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")vg.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cuid2",code:x.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")_g.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"ulid",code:x.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),E(s,{validation:"url",code:x.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"regex",code:x.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),E(s,{code:x.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),E(s,{code:x.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),E(s,{code:x.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?iu(i).test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:x.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?Mg.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:x.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?Lg(i).test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{code:x.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?Ng.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"duration",code:x.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?jg(e.data,i.version)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"ip",code:x.invalid_string,message:i.message}),n.dirty()):i.kind==="jwt"?Dg(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"jwt",code:x.invalid_string,message:i.message}),n.dirty()):i.kind==="cidr"?Rg(e.data,i.version)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"cidr",code:x.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?$g.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"base64",code:x.invalid_string,message:i.message}),n.dirty()):i.kind==="base64url"?Ig.test(e.data)||(s=this._getOrReturnCtx(e,s),E(s,{validation:"base64url",code:x.invalid_string,message:i.message}),n.dirty()):ne.assertNever(i);return{status:n.value,value:e.data}}_regex(e,t,n){return this.refinement(s=>e.test(s),{validation:t,code:x.invalid_string,...R.errToObj(n)})}_addCheck(e){return new Ze({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...R.errToObj(e)})}url(e){return this._addCheck({kind:"url",...R.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...R.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...R.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...R.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...R.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...R.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...R.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...R.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...R.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...R.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...R.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...R.errToObj(e)})}datetime(e){var t,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(t=e?.offset)!==null&&t!==void 0?t:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...R.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...R.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...R.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...R.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...R.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...R.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...R.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...R.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...R.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...R.errToObj(t)})}nonempty(e){return this.min(1,R.errToObj(e))}trim(){return new Ze({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ze({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ze({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};Ze.create=r=>{var e;return new Ze({checks:[],typeName:V.ZodString,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...J(r)})};function zg(r,e){let t=(r.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=t>n?t:n,i=parseInt(r.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}var gt=class extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==O.number){let i=this._getOrReturnCtx(e);return E(i,{code:x.invalid_type,expected:O.number,received:i.parsedType}),K}let n,s=new Ee;for(let i of this._def.checks)i.kind==="int"?ne.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),E(n,{code:x.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:x.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:x.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?zg(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),E(n,{code:x.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),E(n,{code:x.not_finite,message:i.message}),s.dirty()):ne.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,R.toString(t))}gt(e,t){return this.setLimit("min",e,!1,R.toString(t))}lte(e,t){return this.setLimit("max",e,!0,R.toString(t))}lt(e,t){return this.setLimit("max",e,!1,R.toString(t))}setLimit(e,t,n,s){return new gt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:R.toString(s)}]})}_addCheck(e){return new gt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:R.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:R.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:R.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:R.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:R.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:R.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:R.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:R.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:R.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ne.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(t===null||n.value>t)&&(t=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}};gt.create=r=>new gt({checks:[],typeName:V.ZodNumber,coerce:r?.coerce||!1,...J(r)});var yt=class extends H{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==O.bigint)return this._getInvalidInput(e);let n,s=new Ee;for(let i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:x.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),E(n,{code:x.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),E(n,{code:x.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):ne.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return E(t,{code:x.invalid_type,expected:O.bigint,received:t.parsedType}),K}gte(e,t){return this.setLimit("min",e,!0,R.toString(t))}gt(e,t){return this.setLimit("min",e,!1,R.toString(t))}lte(e,t){return this.setLimit("max",e,!0,R.toString(t))}lt(e,t){return this.setLimit("max",e,!1,R.toString(t))}setLimit(e,t,n,s){return new yt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:R.toString(s)}]})}_addCheck(e){return new yt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:R.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:R.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:R.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:R.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:R.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}};yt.create=r=>{var e;return new yt({checks:[],typeName:V.ZodBigInt,coerce:(e=r?.coerce)!==null&&e!==void 0?e:!1,...J(r)})};var Yt=class extends H{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==O.boolean){let n=this._getOrReturnCtx(e);return E(n,{code:x.invalid_type,expected:O.boolean,received:n.parsedType}),K}return qe(e.data)}};Yt.create=r=>new Yt({typeName:V.ZodBoolean,coerce:r?.coerce||!1,...J(r)});var Pt=class extends H{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==O.date){let i=this._getOrReturnCtx(e);return E(i,{code:x.invalid_type,expected:O.date,received:i.parsedType}),K}if(isNaN(e.data.getTime())){let i=this._getOrReturnCtx(e);return E(i,{code:x.invalid_date}),K}let n=new Ee,s;for(let i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:x.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),E(s,{code:x.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):ne.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Pt({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:R.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:R.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}};Pt.create=r=>new Pt({checks:[],coerce:r?.coerce||!1,typeName:V.ZodDate,...J(r)});var Kr=class extends H{_parse(e){if(this._getType(e)!==O.symbol){let n=this._getOrReturnCtx(e);return E(n,{code:x.invalid_type,expected:O.symbol,received:n.parsedType}),K}return qe(e.data)}};Kr.create=r=>new Kr({typeName:V.ZodSymbol,...J(r)});var Xt=class extends H{_parse(e){if(this._getType(e)!==O.undefined){let n=this._getOrReturnCtx(e);return E(n,{code:x.invalid_type,expected:O.undefined,received:n.parsedType}),K}return qe(e.data)}};Xt.create=r=>new Xt({typeName:V.ZodUndefined,...J(r)});var er=class extends H{_parse(e){if(this._getType(e)!==O.null){let n=this._getOrReturnCtx(e);return E(n,{code:x.invalid_type,expected:O.null,received:n.parsedType}),K}return qe(e.data)}};er.create=r=>new er({typeName:V.ZodNull,...J(r)});var Rt=class extends H{constructor(){super(...arguments),this._any=!0}_parse(e){return qe(e.data)}};Rt.create=r=>new Rt({typeName:V.ZodAny,...J(r)});var At=class extends H{constructor(){super(...arguments),this._unknown=!0}_parse(e){return qe(e.data)}};At.create=r=>new At({typeName:V.ZodUnknown,...J(r)});var at=class extends H{_parse(e){let t=this._getOrReturnCtx(e);return E(t,{code:x.invalid_type,expected:O.never,received:t.parsedType}),K}};at.create=r=>new at({typeName:V.ZodNever,...J(r)});var Zr=class extends H{_parse(e){if(this._getType(e)!==O.undefined){let n=this._getOrReturnCtx(e);return E(n,{code:x.invalid_type,expected:O.void,received:n.parsedType}),K}return qe(e.data)}};Zr.create=r=>new Zr({typeName:V.ZodVoid,...J(r)});var Ge=class extends H{_parse(e){let{ctx:t,status:n}=this._processInputParams(e),s=this._def;if(t.parsedType!==O.array)return E(t,{code:x.invalid_type,expected:O.array,received:t.parsedType}),K;if(s.exactLength!==null){let o=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(o||a)&&(E(t,{code:o?x.too_big:x.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(E(t,{code:x.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(E(t,{code:x.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map((o,a)=>s.type._parseAsync(new et(t,o,t.path,a)))).then(o=>Ee.mergeArray(n,o));let i=[...t.data].map((o,a)=>s.type._parseSync(new et(t,o,t.path,a)));return Ee.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new Ge({...this._def,minLength:{value:e,message:R.toString(t)}})}max(e,t){return new Ge({...this._def,maxLength:{value:e,message:R.toString(t)}})}length(e,t){return new Ge({...this._def,exactLength:{value:e,message:R.toString(t)}})}nonempty(e){return this.min(1,e)}};Ge.create=(r,e)=>new Ge({type:r,minLength:null,maxLength:null,exactLength:null,typeName:V.ZodArray,...J(e)});function Br(r){if(r instanceof we){let e={};for(let t in r.shape){let n=r.shape[t];e[t]=Xe.create(Br(n))}return new we({...r._def,shape:()=>e})}else return r instanceof Ge?new Ge({...r._def,type:Br(r.element)}):r instanceof Xe?Xe.create(Br(r.unwrap())):r instanceof wt?wt.create(Br(r.unwrap())):r instanceof tt?tt.create(r.items.map(e=>Br(e))):r}var we=class extends H{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),t=ne.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==O.object){let f=this._getOrReturnCtx(e);return E(f,{code:x.invalid_type,expected:O.object,received:f.parsedType}),K}let{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof at&&this._def.unknownKeys==="strip"))for(let f in s.data)o.includes(f)||a.push(f);let l=[];for(let f of o){let u=i[f],y=s.data[f];l.push({key:{status:"valid",value:f},value:u._parse(new et(s,y,s.path,f)),alwaysSet:f in s.data})}if(this._def.catchall instanceof at){let f=this._def.unknownKeys;if(f==="passthrough")for(let u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(f==="strict")a.length>0&&(E(s,{code:x.unrecognized_keys,keys:a}),n.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let f=this._def.catchall;for(let u of a){let y=s.data[u];l.push({key:{status:"valid",value:u},value:f._parse(new et(s,y,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let f=[];for(let u of l){let y=await u.key,h=await u.value;f.push({key:y,value:h,alwaysSet:u.alwaysSet})}return f}).then(f=>Ee.mergeObjectSync(n,f)):Ee.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return R.errToObj,new we({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,n)=>{var s,i,o,a;let l=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,n).message)!==null&&o!==void 0?o:n.defaultError;return t.code==="unrecognized_keys"?{message:(a=R.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new we({...this._def,unknownKeys:"strip"})}passthrough(){return new we({...this._def,unknownKeys:"passthrough"})}extend(e){return new we({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new we({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:V.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new we({...this._def,catchall:e})}pick(e){let t={};return ne.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])}),new we({...this._def,shape:()=>t})}omit(e){let t={};return ne.objectKeys(this.shape).forEach(n=>{e[n]||(t[n]=this.shape[n])}),new we({...this._def,shape:()=>t})}deepPartial(){return Br(this)}partial(e){let t={};return ne.objectKeys(this.shape).forEach(n=>{let s=this.shape[n];e&&!e[n]?t[n]=s:t[n]=s.optional()}),new we({...this._def,shape:()=>t})}required(e){let t={};return ne.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])t[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Xe;)i=i._def.innerType;t[n]=i}}),new we({...this._def,shape:()=>t})}keyof(){return ou(ne.objectKeys(this.shape))}};we.create=(r,e)=>new we({shape:()=>r,unknownKeys:"strip",catchall:at.create(),typeName:V.ZodObject,...J(e)});we.strictCreate=(r,e)=>new we({shape:()=>r,unknownKeys:"strict",catchall:at.create(),typeName:V.ZodObject,...J(e)});we.lazycreate=(r,e)=>new we({shape:r,unknownKeys:"strip",catchall:at.create(),typeName:V.ZodObject,...J(e)});var tr=class extends H{_parse(e){let{ctx:t}=this._processInputParams(e),n=this._def.options;function s(i){for(let a of i)if(a.result.status==="valid")return a.result;for(let a of i)if(a.result.status==="dirty")return t.common.issues.push(...a.ctx.common.issues),a.result;let o=i.map(a=>new xe(a.ctx.common.issues));return E(t,{code:x.invalid_union,unionErrors:o}),K}if(t.common.async)return Promise.all(n.map(async i=>{let o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let i,o=[];for(let l of n){let f={...t,common:{...t.common,issues:[]},parent:null},u=l._parseSync({data:t.data,path:t.path,parent:f});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:f}),f.common.issues.length&&o.push(f.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;let a=o.map(l=>new xe(l));return E(t,{code:x.invalid_union,unionErrors:a}),K}}get options(){return this._def.options}};tr.create=(r,e)=>new tr({options:r,typeName:V.ZodUnion,...J(e)});var Nt=r=>r instanceof sr?Nt(r.schema):r instanceof We?Nt(r.innerType()):r instanceof ir?[r.value]:r instanceof bt?r.options:r instanceof or?ne.objectValues(r.enum):r instanceof ar?Nt(r._def.innerType):r instanceof Xt?[void 0]:r instanceof er?[null]:r instanceof Xe?[void 0,...Nt(r.unwrap())]:r instanceof wt?[null,...Nt(r.unwrap())]:r instanceof zn||r instanceof ur?Nt(r.unwrap()):r instanceof cr?Nt(r._def.innerType):[],Gr=class extends H{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==O.object)return E(t,{code:x.invalid_type,expected:O.object,received:t.parsedType}),K;let n=this.discriminator,s=t.data[n],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(E(t,{code:x.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),K)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){let s=new Map;for(let i of t){let o=Nt(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Gr({typeName:V.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...J(n)})}};function pa(r,e){let t=Ct(r),n=Ct(e);if(r===e)return{valid:!0,data:r};if(t===O.object&&n===O.object){let s=ne.objectKeys(e),i=ne.objectKeys(r).filter(a=>s.indexOf(a)!==-1),o={...r,...e};for(let a of i){let l=pa(r[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(t===O.array&&n===O.array){if(r.length!==e.length)return{valid:!1};let s=[];for(let i=0;i<r.length;i++){let o=r[i],a=e[i],l=pa(o,a);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return t===O.date&&n===O.date&&+r==+e?{valid:!0,data:r}:{valid:!1}}var rr=class extends H{_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(da(i)||da(o))return K;let a=pa(i.value,o.value);return a.valid?((ma(i)||ma(o))&&t.dirty(),{status:t.value,value:a.data}):(E(n,{code:x.invalid_intersection_types}),K)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}};rr.create=(r,e,t)=>new rr({left:r,right:e,typeName:V.ZodIntersection,...J(t)});var tt=class extends H{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==O.array)return E(n,{code:x.invalid_type,expected:O.array,received:n.parsedType}),K;if(n.data.length<this._def.items.length)return E(n,{code:x.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),K;!this._def.rest&&n.data.length>this._def.items.length&&(E(n,{code:x.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let i=[...n.data].map((o,a)=>{let l=this._def.items[a]||this._def.rest;return l?l._parse(new et(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>Ee.mergeArray(t,o)):Ee.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new tt({...this._def,rest:e})}};tt.create=(r,e)=>{if(!Array.isArray(r))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new tt({items:r,typeName:V.ZodTuple,rest:null,...J(e)})};var nr=class extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==O.object)return E(n,{code:x.invalid_type,expected:O.object,received:n.parsedType}),K;let s=[],i=this._def.keyType,o=this._def.valueType;for(let a in n.data)s.push({key:i._parse(new et(n,a,n.path,a)),value:o._parse(new et(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?Ee.mergeObjectAsync(t,s):Ee.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,n){return t instanceof H?new nr({keyType:e,valueType:t,typeName:V.ZodRecord,...J(n)}):new nr({keyType:Ze.create(),valueType:e,typeName:V.ZodRecord,...J(t)})}},Wr=class extends H{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==O.map)return E(n,{code:x.invalid_type,expected:O.map,received:n.parsedType}),K;let s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,l],f)=>({key:s._parse(new et(n,a,n.path,[f,"key"])),value:i._parse(new et(n,l,n.path,[f,"value"]))}));if(n.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let l of o){let f=await l.key,u=await l.value;if(f.status==="aborted"||u.status==="aborted")return K;(f.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(f.value,u.value)}return{status:t.value,value:a}})}else{let a=new Map;for(let l of o){let f=l.key,u=l.value;if(f.status==="aborted"||u.status==="aborted")return K;(f.status==="dirty"||u.status==="dirty")&&t.dirty(),a.set(f.value,u.value)}return{status:t.value,value:a}}}};Wr.create=(r,e,t)=>new Wr({valueType:e,keyType:r,typeName:V.ZodMap,...J(t)});var Et=class extends H{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==O.set)return E(n,{code:x.invalid_type,expected:O.set,received:n.parsedType}),K;let s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(E(n,{code:x.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(E(n,{code:x.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());let i=this._def.valueType;function o(l){let f=new Set;for(let u of l){if(u.status==="aborted")return K;u.status==="dirty"&&t.dirty(),f.add(u.value)}return{status:t.value,value:f}}let a=[...n.data.values()].map((l,f)=>i._parse(new et(n,l,n.path,f)));return n.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,t){return new Et({...this._def,minSize:{value:e,message:R.toString(t)}})}max(e,t){return new Et({...this._def,maxSize:{value:e,message:R.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}};Et.create=(r,e)=>new Et({valueType:r,minSize:null,maxSize:null,typeName:V.ZodSet,...J(e)});var Dt=class extends H{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==O.function)return E(t,{code:x.invalid_type,expected:O.function,received:t.parsedType}),K;function n(a,l){return Hi({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ji(),Vr].filter(f=>!!f),issueData:{code:x.invalid_arguments,argumentsError:l}})}function s(a,l){return Hi({data:a,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Ji(),Vr].filter(f=>!!f),issueData:{code:x.invalid_return_type,returnTypeError:l}})}let i={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof zt){let a=this;return qe(async function(...l){let f=new xe([]),u=await a._def.args.parseAsync(l,i).catch(v=>{throw f.addIssue(n(l,v)),f}),y=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(y,i).catch(v=>{throw f.addIssue(s(y,v)),f})})}else{let a=this;return qe(function(...l){let f=a._def.args.safeParse(l,i);if(!f.success)throw new xe([n(l,f.error)]);let u=Reflect.apply(o,this,f.data),y=a._def.returns.safeParse(u,i);if(!y.success)throw new xe([s(u,y.error)]);return y.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Dt({...this._def,args:tt.create(e).rest(At.create())})}returns(e){return new Dt({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new Dt({args:e||tt.create([]).rest(At.create()),returns:t||At.create(),typeName:V.ZodFunction,...J(n)})}},sr=class extends H{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}};sr.create=(r,e)=>new sr({getter:r,typeName:V.ZodLazy,...J(e)});var ir=class extends H{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return E(t,{received:t.data,code:x.invalid_literal,expected:this._def.value}),K}return{status:"valid",value:e.data}}get value(){return this._def.value}};ir.create=(r,e)=>new ir({value:r,typeName:V.ZodLiteral,...J(e)});function ou(r,e){return new bt({values:r,typeName:V.ZodEnum,...J(e)})}var bt=class extends H{constructor(){super(...arguments),jn.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let t=this._getOrReturnCtx(e),n=this._def.values;return E(t,{expected:ne.joinValues(n),received:t.parsedType,code:x.invalid_type}),K}if(Yi(this,jn,"f")||ru(this,jn,new Set(this._def.values),"f"),!Yi(this,jn,"f").has(e.data)){let t=this._getOrReturnCtx(e),n=this._def.values;return E(t,{received:t.data,code:x.invalid_enum_value,options:n}),K}return qe(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return bt.create(e,{...this._def,...t})}exclude(e,t=this._def){return bt.create(this.options.filter(n=>!e.includes(n)),{...this._def,...t})}};jn=new WeakMap;bt.create=ou;var or=class extends H{constructor(){super(...arguments),Dn.set(this,void 0)}_parse(e){let t=ne.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==O.string&&n.parsedType!==O.number){let s=ne.objectValues(t);return E(n,{expected:ne.joinValues(s),received:n.parsedType,code:x.invalid_type}),K}if(Yi(this,Dn,"f")||ru(this,Dn,new Set(ne.getValidEnumValues(this._def.values)),"f"),!Yi(this,Dn,"f").has(e.data)){let s=ne.objectValues(t);return E(n,{received:n.data,code:x.invalid_enum_value,options:s}),K}return qe(e.data)}get enum(){return this._def.values}};Dn=new WeakMap;or.create=(r,e)=>new or({values:r,typeName:V.ZodNativeEnum,...J(e)});var zt=class extends H{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==O.promise&&t.common.async===!1)return E(t,{code:x.invalid_type,expected:O.promise,received:t.parsedType}),K;let n=t.parsedType===O.promise?t.data:Promise.resolve(t.data);return qe(n.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}};zt.create=(r,e)=>new zt({type:r,typeName:V.ZodPromise,...J(e)});var We=class extends H{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===V.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{E(n,o),o.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){let o=s.transform(n.data,i);if(n.common.async)return Promise.resolve(o).then(async a=>{if(t.value==="aborted")return K;let l=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return l.status==="aborted"?K:l.status==="dirty"||t.value==="dirty"?Ur(l.value):l});{if(t.value==="aborted")return K;let a=this._def.schema._parseSync({data:o,path:n.path,parent:n});return a.status==="aborted"?K:a.status==="dirty"||t.value==="dirty"?Ur(a.value):a}}if(s.type==="refinement"){let o=a=>{let l=s.refinement(a,i);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){let a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?K:(a.status==="dirty"&&t.dirty(),o(a.value),{status:t.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?K:(a.status==="dirty"&&t.dirty(),o(a.value).then(()=>({status:t.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){let o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!Ht(o))return o;let a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>Ht(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:t.value,value:a})):o);ne.assertNever(s)}};We.create=(r,e,t)=>new We({schema:r,typeName:V.ZodEffects,effect:e,...J(t)});We.createWithPreprocess=(r,e,t)=>new We({schema:e,effect:{type:"preprocess",transform:r},typeName:V.ZodEffects,...J(t)});var Xe=class extends H{_parse(e){return this._getType(e)===O.undefined?qe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Xe.create=(r,e)=>new Xe({innerType:r,typeName:V.ZodOptional,...J(e)});var wt=class extends H{_parse(e){return this._getType(e)===O.null?qe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};wt.create=(r,e)=>new wt({innerType:r,typeName:V.ZodNullable,...J(e)});var ar=class extends H{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return t.parsedType===O.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}};ar.create=(r,e)=>new ar({innerType:r,typeName:V.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...J(e)});var cr=class extends H{_parse(e){let{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return Rn(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new xe(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new xe(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}};cr.create=(r,e)=>new cr({innerType:r,typeName:V.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...J(e)});var Jr=class extends H{_parse(e){if(this._getType(e)!==O.nan){let n=this._getOrReturnCtx(e);return E(n,{code:x.invalid_type,expected:O.nan,received:n.parsedType}),K}return{status:"valid",value:e.data}}};Jr.create=r=>new Jr({typeName:V.ZodNaN,...J(r)});var Fg=Symbol("zod_brand"),zn=class extends H{_parse(e){let{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}},lr=class extends H{_parse(e){let{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{let i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?K:i.status==="dirty"?(t.dirty(),Ur(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{let s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?K:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,t){return new lr({in:e,out:t,typeName:V.ZodPipeline})}},ur=class extends H{_parse(e){let t=this._def.innerType._parse(e),n=s=>(Ht(s)&&(s.value=Object.freeze(s.value)),s);return Rn(t)?t.then(s=>n(s)):n(t)}unwrap(){return this._def.innerType}};ur.create=(r,e)=>new ur({innerType:r,typeName:V.ZodReadonly,...J(e)});function Xl(r,e){let t=typeof r=="function"?r(e):typeof r=="string"?{message:r}:r;return typeof t=="string"?{message:t}:t}function au(r,e={},t){return r?Rt.create().superRefine((n,s)=>{var i,o;let a=r(n);if(a instanceof Promise)return a.then(l=>{var f,u;if(!l){let y=Xl(e,n),h=(u=(f=y.fatal)!==null&&f!==void 0?f:t)!==null&&u!==void 0?u:!0;s.addIssue({code:"custom",...y,fatal:h})}});if(!a){let l=Xl(e,n),f=(o=(i=l.fatal)!==null&&i!==void 0?i:t)!==null&&o!==void 0?o:!0;s.addIssue({code:"custom",...l,fatal:f})}}):Rt.create()}var Qg={object:we.lazycreate},V;(function(r){r.ZodString="ZodString",r.ZodNumber="ZodNumber",r.ZodNaN="ZodNaN",r.ZodBigInt="ZodBigInt",r.ZodBoolean="ZodBoolean",r.ZodDate="ZodDate",r.ZodSymbol="ZodSymbol",r.ZodUndefined="ZodUndefined",r.ZodNull="ZodNull",r.ZodAny="ZodAny",r.ZodUnknown="ZodUnknown",r.ZodNever="ZodNever",r.ZodVoid="ZodVoid",r.ZodArray="ZodArray",r.ZodObject="ZodObject",r.ZodUnion="ZodUnion",r.ZodDiscriminatedUnion="ZodDiscriminatedUnion",r.ZodIntersection="ZodIntersection",r.ZodTuple="ZodTuple",r.ZodRecord="ZodRecord",r.ZodMap="ZodMap",r.ZodSet="ZodSet",r.ZodFunction="ZodFunction",r.ZodLazy="ZodLazy",r.ZodLiteral="ZodLiteral",r.ZodEnum="ZodEnum",r.ZodEffects="ZodEffects",r.ZodNativeEnum="ZodNativeEnum",r.ZodOptional="ZodOptional",r.ZodNullable="ZodNullable",r.ZodDefault="ZodDefault",r.ZodCatch="ZodCatch",r.ZodPromise="ZodPromise",r.ZodBranded="ZodBranded",r.ZodPipeline="ZodPipeline",r.ZodReadonly="ZodReadonly"})(V||(V={}));var qg=(r,e={message:`Input not instance of ${r.name}`})=>au(t=>t instanceof r,e),cu=Ze.create,lu=gt.create,Bg=Jr.create,Ug=yt.create,uu=Yt.create,Vg=Pt.create,Kg=Kr.create,Zg=Xt.create,Gg=er.create,Wg=Rt.create,Jg=At.create,Hg=at.create,Yg=Zr.create,Xg=Ge.create,ey=we.create,ty=we.strictCreate,ry=tr.create,ny=Gr.create,sy=rr.create,iy=tt.create,oy=nr.create,ay=Wr.create,cy=Et.create,ly=Dt.create,uy=sr.create,fy=ir.create,dy=bt.create,my=or.create,py=zt.create,eu=We.create,hy=Xe.create,gy=wt.create,yy=We.createWithPreprocess,by=lr.create,wy=()=>cu().optional(),vy=()=>lu().optional(),_y=()=>uu().optional(),Sy={string:r=>Ze.create({...r,coerce:!0}),number:r=>gt.create({...r,coerce:!0}),boolean:r=>Yt.create({...r,coerce:!0}),bigint:r=>yt.create({...r,coerce:!0}),date:r=>Pt.create({...r,coerce:!0})},Ty=K,ct=Object.freeze({__proto__:null,defaultErrorMap:Vr,setErrorMap:yg,getErrorMap:Ji,makeIssue:Hi,EMPTY_PATH:bg,addIssueToContext:E,ParseStatus:Ee,INVALID:K,DIRTY:Ur,OK:qe,isAborted:da,isDirty:ma,isValid:Ht,isAsync:Rn,get util(){return ne},get objectUtil(){return fa},ZodParsedType:O,getParsedType:Ct,ZodType:H,datetimeRegex:iu,ZodString:Ze,ZodNumber:gt,ZodBigInt:yt,ZodBoolean:Yt,ZodDate:Pt,ZodSymbol:Kr,ZodUndefined:Xt,ZodNull:er,ZodAny:Rt,ZodUnknown:At,ZodNever:at,ZodVoid:Zr,ZodArray:Ge,ZodObject:we,ZodUnion:tr,ZodDiscriminatedUnion:Gr,ZodIntersection:rr,ZodTuple:tt,ZodRecord:nr,ZodMap:Wr,ZodSet:Et,ZodFunction:Dt,ZodLazy:sr,ZodLiteral:ir,ZodEnum:bt,ZodNativeEnum:or,ZodPromise:zt,ZodEffects:We,ZodTransformer:We,ZodOptional:Xe,ZodNullable:wt,ZodDefault:ar,ZodCatch:cr,ZodNaN:Jr,BRAND:Fg,ZodBranded:zn,ZodPipeline:lr,ZodReadonly:ur,custom:au,Schema:H,ZodSchema:H,late:Qg,get ZodFirstPartyTypeKind(){return V},coerce:Sy,any:Wg,array:Xg,bigint:Ug,boolean:uu,date:Vg,discriminatedUnion:ny,effect:eu,enum:dy,function:ly,instanceof:qg,intersection:sy,lazy:uy,literal:fy,map:ay,nan:Bg,nativeEnum:my,never:Hg,null:Gg,nullable:gy,number:lu,object:ey,oboolean:_y,onumber:vy,optional:hy,ostring:wy,pipeline:by,preprocess:yy,promise:py,record:oy,set:cy,strictObject:ty,string:cu,symbol:Kg,transformer:eu,tuple:iy,undefined:Zg,union:ry,unknown:Jg,void:Yg,NEVER:Ty,ZodIssueCode:x,quotelessJson:gg,ZodError:xe});var fu=ct.object({title:ct.string(),sellerId:ct.string().uuid(),purchaseType:ct.enum(["BUY","RENT"]).optional(),price:ct.number()}),du=ct.object({searchTitle:ct.string().optional(),searchMatchMode:ct.enum(["FUZZY","STRICT"]).optional().default("STRICT"),condition:ct.enum(["NEW","GREAT","FAIR","POOR"]).optional(),proximityMiles:ct.enum(["lt_25","mt_25"]).default("lt_25")});var hu=Je(Xi(),1);var gu=async(r,e)=>{try{let t=JSON.parse(r.body??"{}"),n=fu.parse(t),s=Ye.map(n,"ListingInputDto","Listing"),i=await e.create(s),o=Ye.map(i,"Listing","ListingOutputDto");return{statusCode:201,body:JSON.stringify(o)}}catch(t){throw t instanceof xe?new hu.BadRequestError(t.message,{context:t.errors}):t}};var yu=Je(Xi(),1);var bu=async(r,e)=>{try{let t=r.queryStringParameters??"{}";console.log(t);let n=du.parse(t);console.log(n);let s=Ye.map(n,"ListingApiQueryUnstructured","ListingApiQuery");console.log(s);let o=(await e.getAllByQuery(s)).map(a=>Ye.map(a,"Listing","ListingOutputDto"));return{statusCode:201,body:JSON.stringify(o)}}catch(t){throw t instanceof xe?new yu.BadRequestError(t.message,{context:t.errors}):t}};var wu=Je(Xi(),1);var vu=async(r,e)=>{try{return console.log(r.pathParameters),{statusCode:200,body:JSON.stringify({message:"did i find it ?"})}}catch(t){throw t instanceof xe?new wu.BadRequestError(t.message,{context:t.errors}):t}};function _u(){let r=yr(process.env.DATABASE_URL,{prepare:!1}),e=qi({client:r,casing:"snake_case"});return{service:new Wi(e,Ye),routes:[{method:"POST",path:"/listings",handler:gu},{method:"GET",path:"/listings",handler:bu},{method:"GET",path:"/listings/{id}",handler:vu}]}}var ga=(r,e,t)=>{let n=t.split("/").filter(Boolean);for(let s of r){if(s.method!==e)continue;let i=s.path.split("/").filter(Boolean);if(i.length!==n.length)continue;let o={};if(i.every((l,f)=>{if(l.startsWith("{")&&l.endsWith("}")){let u=l.slice(1,-1);return o[u]=n[f],!0}return l===n[f]}))return{route:s,params:o}}return null};var{routes:$y,service:Iy}=_u(),My=async r=>{console.log("Incoming request:",r.httpMethod,r.path,r.pathParameters);let e=ga($y,r.httpMethod,r.path);if(!ga)return{statusCode:404,body:JSON.stringify({error:"Route not found"})};try{return r.pathParameters=e.params,await e.route.handler(r,Iy)}catch(t){return console.error("Error handling request:",t),{statusCode:t.statusCode??500,body:t?.errors?JSON.stringify(t.errors):"Internal Server Error"}}};0&&(module.exports={lambdaHandler});
//# sourceMappingURL=app.js.map
